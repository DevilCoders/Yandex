service: antiadblock
title: Build Argus Logs Agregate task
ci:
  release-title-source: flow
  secret: sec-01evxgabdwyeb183v8p4exxsry
  runtime:
    sandbox:
      owner: ANTIADBLOCK
      priority:
        class: SERVICE
        subclass: LOW
      notifications:
        - statuses: [TIMEOUT, FAILURE, EXCEPTION]
          transport: email
          recipients:
            - antiadb@yandex-team.ru
  actions:
    build-action:
      flow: build_antiadblock_argus_logs_agregate_task
      triggers:
        - on: commit
          filters:
            - discovery: dir
              abs-paths:
                [
                  "antiadblock/argus/tasks/logs_agregate_task/**",
                  "antiadblock/tasks/tools/**",
                  "antiadblock/argus/bin/utils/**",
                  "antiadblock/libs/elastic_search_client/**",
                ]

  flows:
    build_antiadblock_argus_logs_agregate_task:
      title: Antiadblock Build Argus Logs Agregate task binary
      jobs:
        build:
          title: Build Argus Logs Agregate task binary with ya make
          task: common/arcadia/ya_make
          input:
            result_rt: ARGUS_LOGS_AGREGATE_TASK_BIN
            result_rd: antiadblock logs_agregate_task binary
            result_ttl: inf
            kill_timeout: 3600
            result_single_file: true
            targets: antiadblock/argus/tasks/logs_agregate_task
            arts: antiadblock/argus/tasks/logs_agregate_task/logs_agregate_task
