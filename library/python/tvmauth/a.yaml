service: passport_infra
title: tvmauth (python)


arcanum:
  review:
     auto_assign: true

     groups:
        - name: backend-developers
          roles: developer

     rules:
        - reviewers:
            name: backend-developers
            ship: 2
            assign: 2

  auto_merge:
    requirements:
      - system: pciexpress
        type: PCI-DSS integrity


ci:
  release-title-source: flow
  autocheck:
    fast-targets:
      - library/python/tvmauth
      - passport
    strong: true

  runtime:
    sandbox-owner: PASSPORT
  secret: sec-01ekz37bg804cbcsqeftv8v8ec

  releases:
    tvmauth-python-release:
      title: tvmauth-python
      flow: tvmauth-python-release-flow
      stages:
        - id: build
          title: Build
      branches:
        pattern: releases/passport/tvmauth-python-${version}
        auto-create: true
      filters:
        - discovery: dir
          abs-paths:
            - library/cpp/tvmauth/**
            - library/python/tvmauth/**

  flows:
    tvmauth-python-release-flow:
      jobs:
        build_pypi:
          title: Сборка пакетов
          task: projects/passport/build_tvm_auth_pypi
          stage: build
          input:
            path: library/python/tvmauth
            target_platform: all
            target_python: all
            vault_access_key_record: 'sec-01d0yhgfw07xxjzsggm4xcqwe0[AccessKey]'
            vault_secret_key_record: 'sec-01d0yhgfw07xxjzsggm4xcqwe0[SecretKey]'
