# // Информация о тексте, сохраняемая в xmap
Struct {
    Name: "TXMapTextInfo"
    Size: 12

    CodeGenOptions {
        ShortName: "XMapTextInfo"
        NeedMask: true
        NeedVisitor: true
        NeedConstructor: false
    }

    Field { Name: "WordsIdfSum" Width: 16 Type: "sf16" } # сумма весов слов в тексте ссылке
    Field { Name: "TwoWordsIdfSum" Width: 16 Type: "sf16" } # сумма весов двусловий в тексте ссылки
    # dword border
    Field { Name: "PornoWordsIdfSum" Width: 16 Type: "sf16" } # сумма весов порно-слов, входящих в текст ссылки
    Field { Name: "WordCount" Width: 7 } # 7 = XMapWordBits + 1
                                         # Количество слов в тексте ссылки
    Field { Name: "AliveProbability" Width: 8 } # BUKI-1130: probability of user traffic on this link
    Field { Name: "IsDirectLink" Width: 1 }  # BUKI-1249, direct link.
    # dword border
    Field { Name: "IsExtRedirLink" Width: 1 } # BUKI-1249, link throuh redirect.
    Field { Name: "Reserved1" Width: 18 }
    Field { Name: "PackedGroupSize" Width: 8 } # упакованный в 8 бит размер группы ссылок
    Field { Name: "Reserved2" Width: 5 }
    # dword border
}

# Информация о ссылке, сохраняемая в xmap
Struct {
    Name: "TXMapLinkInfo"
    Size: 24

    CodeGenOptions {
        ShortName: "XMapLinkInfo"
        NeedMask: true
        NeedVisitor: true
        NeedConstructor: false
    }

    Field { Name: "EntryType" Width: 1 } # Должно быть первым полем, тип источника ссылки (ET_LINK)
    Field { Name: "OwnerFromId" Width: 31 } # id владельца, с которого исходит ссылка
    # dword border
    Field { Name: "Date" Width: 16 } # Дата появления ссылки
    Field { Name: "IsInternal" Width: 1 } # Является ли ссылка внутренней (источник и цель ссылки принадлежат одному владельцу)
    Field { Name: "OrderNumberWithThisText" Width: 15 } # 15 = XMapLinkBits
                                                        # Порядковый номер (порядок по RelativeWeight) ссылки с этим текстом в группе (c нуля)
    # dword border
    Field { Name: "OwnerFromTIC" Width: 20 } # ТИЦ владельца, с которого исходит ссылка
    Field { Name: "OwnersMatchedCategoryCount" Width: 8 } # 8 = OwnersMatchedCategoryBits
                                                          # Количество совпадающих категорий источника и цели ссылки
    Field { Name: "HasGoodlink" Width: 1 } # Если ли среди группы ссылок, которую представляет данная хорошие ссылки (если нет, то группа - спам)
    Field { Name: "TextSale" Width: 3 } # SEO: Link text sale-ness
    # dword border
    Field { Name: "OwnerGeo" Width: 16 } # Геокатегория источника ссылки ui16(-1), если геокатегория не определена.
    Field { Name: "SegmentType" Width: 3 } # the type of segment for the link
    Field { Name: "SeoPrice" Width: 4 } # SEO: Estimated link price
    Field { Name: "SrcLang" Width: 7 } # the language of the link source
    Field { Name: "SrcSeoDoc" Width: 2 } # SEO: Link source document SEO flags
    # dword border
    Field { Name: "BanFlags" Width: 18 }
    Field { Name: "IsPorno" Width: 1 }
    Field { Name: "SeoMark" Width: 2 } # SEO: Link SEO flags
    Field { Name: "SeoTrash" Width: 2 } # SEO: Link SEO-trashness
    Field { Name: "ThemeState" Width: 1 } # SEO: Was link text theme just defined or sharply defined
    Field { Name: "ThemeId" Width: 7 } # SEO: Link text theme (or 'undefined theme')
    Field { Name: "IsFakeLink" Width: 1 } # SEO: synthetic link, not from html-source, SEARCHSPAM-7677.
    # dword border
    Field { Name: "IsAdult" Width: 1 }
    Field { Name: "IsRefFromMP" Width: 1 } # ARC-1035: source is main page
    Field { Name: "SourceRank" Width: 16 } # ROBOT-1416: rank of link source
    Field { Name: "NationalDomainId" Width: 8 } # BUKI-1107: NationalDomainId of source.
    Field { Name: "IsInterhost" Width: 1 } # BUKI-1249, has: source host is equal to destination host.
    Field { Name: "NewCommercialWeight" Width: 2 } # commerciality of the link
    Field { Name: "NewCommercialLength" Width: 2 } # number of commercial words in the link
    Field { Name: "DocFoldingLevel" Width: 1 } # SEO: Document folding level (affecte the price)
    # dword border
}
