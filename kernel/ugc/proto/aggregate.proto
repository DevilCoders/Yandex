syntax="proto3";

package NUgc.NSchema;

import "kernel/ugc/proto/common/ugc_type.proto";

import "google/protobuf/timestamp.proto";
import "google/protobuf/wrappers.proto";

message TFeedbackIndexItem {
    string Id = 1; // arbitrary string identifier (ontoid, site, offer etc)
    TUgcType.EType UgcType = 2;
    google.protobuf.Timestamp Timestamp = 3;

    google.protobuf.BoolValue Hidden = 4; // review is hidden for public display for any reason
    google.protobuf.BoolValue HasReview = 5;
    google.protobuf.BoolValue HasRating = 6;
    google.protobuf.BoolValue HaveUsed = 7;
    google.protobuf.BoolValue ReviewSkipped = 8;
    google.protobuf.BoolValue ShadowHidden = 9; // hidden for pk (without antifraud)
    google.protobuf.BoolValue PublicHidden = 10; // hidden in pk by user itself
    google.protobuf.BoolValue PublicRating = 11;
    google.protobuf.BoolValue NotInterested = 12;
    google.protobuf.UInt32Value PhotosCount = 13;
    google.protobuf.UInt32Value AcceptedPhotosCount = 14;
}

message TSbsIndexItem {
    string Id = 1;
    TUgcType.EType UgcType = 2;
    google.protobuf.BoolValue Skipped = 3;
}

message TFeedbackIndex {
    repeated TFeedbackIndexItem Items = 1;
}

// per-user aggregates calculated via feeder
// Next 8
message TAggregate {
    map<string, int32> OntoRatingCountByOType = 1;
    map<string, int32> OntoReviewCountByOType = 2;
    map<string, int32> OntoNotInterestedCountByOType = 3;
    map<string, TFeedbackIndex> OntoFeedbackIndex = 5;
}

// per-user aggregate part
message TAggregateItem {
    string ItemOrder = 1; // Order of index part
    repeated TFeedbackIndexItem FeedbackIndex = 2;
}

// per-user sbs aggregate part
message TSbsAggregateItem {
    string ItemOrder = 1; // Order of index part
    repeated TSbsIndexItem SbsIndex = 2;
}
