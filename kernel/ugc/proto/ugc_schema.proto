syntax = "proto3";

package NUgc.NSchema;

import "kernel/ugc/proto/achievement.proto";
import "kernel/ugc/proto/device_profile.proto";
import "kernel/ugc/proto/device_profile_internal.proto";
import "kernel/ugc/proto/direct/direct_service.proto";
import "kernel/ugc/proto/data_erasure_requests.proto";
import "kernel/ugc/proto/liked_news.proto";
import "kernel/ugc/proto/org/org_business_comment.proto";
import "kernel/ugc/proto/reactions.proto";
import "kernel/ugc/proto/sitemap_chunk.proto";
import "kernel/ugc/proto/subscription.proto";
import "kernel/ugc/proto/user_profile.proto";
import "kernel/ugc/proto/user_profile_internal.proto";
import "kernel/ugc/proto/visitor_profile.proto";
import "kernel/ugc/proto/visitor_profile_internal.proto";

import "kernel/ugc/schema/proto/schema.proto";

// Next field: 44
message TRoot {
    // Per-user tables directly accessible via /my.
    // Logged-in users. Key: passport id.
    repeated TUserProfile Users = 1 [(storage) = "ugc"];
    // Non-logged-in users from mobile devices. Key: installation UUID.
    repeated TDeviceProfile Devices = 11 [(storage) = "ugc"];
    // Non-logged-in users without installation tracking (desktop). Key: yuid, soon migrating to icookie.
    repeated TVisitorProfile Visitors = 2 [(storage) = "ugc"];

    // Per-user tables without direct access.
    // Logged-in users. Key: passport id.
    repeated TUserProfileInternal UsersInternal = 12 [(storage) = "ugc"];
    // Non-logged-in users from mobile devices. Key: installation UUID.
    repeated TDeviceProfileInternal DevicesInternal = 13 [(storage) = "ugc"];
    // Non-logged-in users without installation tracking (desktop). Key: yuid, soon migrating to icookie.
    repeated TVisitorProfileInternal VisitorsInternal = 14 [(storage) = "ugc"];

    repeated TAchievement Achievements = 3 [(storage) = "ugc"];
    repeated TLikedNews News = 7 [(storage) = "ugc"];
    repeated NDirectUgc.TDirectService DirectService = 8 [(storage) = "ugc"];

    // For yandex.tld/ugcpub/sitemap handles. Active users' PK IDs split by 4 char prefixes into chunks
    repeated TSitemapChunk SitemapChunks = 10 [(storage) = "ugc"];

    repeated TReactionAggregate WomanReactions = 15 [(storage) = "ugc"];
    repeated TReactionAggregate SportReactions = 16 [(storage) = "ugc"];
    repeated TReactionAggregate VideoReactions = 17 [(storage) = "ugc"];
    repeated TReactionAggregate OrgReviewLikes = 18 [(storage) = "ugc"];
    repeated TReactionAggregate OntoReviewLikes = 19 [(storage) = "ugc"];
    repeated TReactionAggregate SpravPostReactions = 20 [(storage) = "ugc"];
    repeated TReactionAggregate TalkArticleReactions = 21 [(storage) = "ugc"];
    repeated TReactionAggregate VhSubsReactions = 22 [(storage) = "ugc"];
    repeated TReactionAggregate SiteReviewLikes = 23 [(storage) = "ugc"];
    repeated TReactionAggregate VhSkipReactions = 24 [(storage) = "ugc"];
    repeated TReactionAggregate SpravImageReactions = 26 [(storage) = "ugc"];
    repeated TReactionAggregate UrlrecReactions = 27 [(storage) = "ugc"];
    repeated TReactionAggregate WeatherFactReactions = 29 [(storage) = "ugc"];
    repeated TReactionAggregate HealthArticleReactions = 30 [(storage) = "ugc"];
    repeated TReactionAggregate TurboPageReactions = 33 [(storage) = "ugc"];
    repeated TReactionAggregate EntityReactions = 34 [(storage) = "ugc"];
    repeated TReactionAggregate DistrictReactions = 35 [(storage) = "ugc"];
    repeated TReactionAggregate VkusReactions = 37 [(storage) = "ugc"];
    repeated TReactionAggregate MiniAppReviewLikes = 38 [(storage) = "ugc"];
    repeated TReactionAggregate OfferReviewLikes = 39 [(storage) = "ugc"];
    repeated TReactionAggregate DoctorsReviewLikes = 41 [(storage) = "ugc"];
    repeated TReactionAggregate EducationReviewLikes = 42 [(storage) = "ugc"];

    repeated TSubscriptionAggregate ObjectSubscriptions = 25 [(storage) = "ugc"];
    repeated TSubscriptionAggregate OrgSubscriptions = 36 [(storage) = "ugc"];
    repeated TSubscriptionAggregate UserSubscriptions = 28 [(storage) = "ugc"];
    repeated TSubscriptionAggregate NewReleasesSubscriptions = 31 [(storage) = "ugc"];
    repeated TSubscriptionAggregate CommunitiesSubscriptions = 32 [(storage) = "ugc"];

    // states of GDPR compliant data erasure requests. Key: passport id
    repeated TDataErasureRequests DataErasureRequests = 40 [(storage) = "ugc"];

    repeated NOrgs.TBusinessAnswer BusinessAnswers = 43 [(storage) = "ugc", (topic) = "ugc"];

    option (schema) = {
        Table: {
            Name: "users"
            Field: "Users"
            Key: "PassportUID"
        }

        Table: {
            Name: "devices"
            Field: "Devices"
            Key: "DeviceID"
        }

        Table: {
            Name: "visitors"
            Field: "Visitors"
            Key: "YandexUID"
        }

        Table: {
            Name: "users-int"
            Field: "UsersInternal"
            Key: "PassportUID"
        }

        Table: {
            Name: "devices-int"
            Field: "DevicesInternal"
            Key: "DeviceID"
        }

        Table: {
            Name: "visitors-int"
            Field: "VisitorsInternal"
            Key: "YandexUID"
        }

        Table: {
            Name: "achievements"
            Field: "Achievements"
            Key: "Id"
        }

        Table: {
            Name: "news"
            Field: "News"
            Key: "StoryId"
        }

        Table: {
            Name: "direct-service"
            Field: "DirectService"
            Key: "ContractorId"
        }

        Table: {
            Name: "sitemap-chunks"
            Field: "SitemapChunks"
            Key: "ChunkId"
        }

        Table: {
            Name: "woman-reactions"
            Field: "WomanReactions"
            Key: "Id"
        }

        Table: {
            Name: "sport-reactions"
            Field: "SportReactions"
            Key: "Id"
        }

        Table: {
            Name: "video-reactions"
            Field: "VideoReactions"
            Key: "Id"
        }

        Table: {
            Name: "org-review-likes"
            Field: "OrgReviewLikes"
            Key: "Id"
        }

        Table: {
            Name: "onto-review-likes"
            Field: "OntoReviewLikes"
            Key: "Id"
        }

        Table: {
            Name: "sprav-post-reactions"
            Field: "SpravPostReactions"
            Key: "Id"
        }

        Table: {
            Name: "talk-article-reactions"
            Field: "TalkArticleReactions"
            Key: "Id"
        }

        Table: {
            Name: "vh-subs-reactions"
            Field: "VhSubsReactions"
            Key: "Id"
        }

        Table: {
            Name: "site-review-likes"
            Field: "SiteReviewLikes"
            Key: "Id"
        }

        Table: {
            Name: "miniapp-review-likes"
            Field: "MiniAppReviewLikes"
            Key: "Id"
        }

        Table: {
            Name: "offer-review-likes"
            Field: "OfferReviewLikes"
            Key: "Id"
        }

        Table: {
            Name: "doctors-review-likes"
            Field: "DoctorsReviewLikes"
            Key: "Id"
        }

        Table: {
            Name: "education-review-likes"
            Field: "EducationReviewLikes"
            Key: "Id"
        }

        Table: {
            Name: "vh-skip-reactions"
            Field: "VhSkipReactions"
            Key: "Id"
        }

        Table: {
            Name: "object-subscriptions"
            Field: "ObjectSubscriptions"
            Key: "Id"
        }

        Table: {
            Name: "org-subscriptions"
            Field: "OrgSubscriptions"
            Key: "Id"
        }

        Table: {
            Name: "sprav-image-reactions"
            Field: "SpravImageReactions"
            Key: "Id"
        }

        Table: {
            Name: "urlrec-reactions"
            Field: "UrlrecReactions"
            Key: "Id"
        }

        Table: {
            Name: "weather-fact-reactions"
            Field: "WeatherFactReactions"
            Key: "Id"
        }

        Table: {
            Name: "health-article-reactions"
            Field: "HealthArticleReactions"
            Key: "Id"
        }

        Table: {
            Name: "turbo-page-reactions"
            Field: "TurboPageReactions"
            Key: "Id"
        }

        Table: {
            Name: "entity-reactions"
            Field: "EntityReactions"
            Key: "Id"
        }

        Table: {
            Name: "district-reactions"
            Field: "DistrictReactions"
            Key: "Id"
        }

        Table: {
            Name: "vkus-reactions"
            Field: "VkusReactions"
            Key: "Id"
        }

        Table: {
            Name: "user-subscriptions"
            Field: "UserSubscriptions"
            Key: "Id"
        }

        Table: {
            Name: "new-releases-subscriptions"
            Field: "NewReleasesSubscriptions"
            Key: "Id"
        }

        Table: {
            Name: "communities-subscriptions"
            Field: "CommunitiesSubscriptions"
            Key: "Id"
        }

        Table: {
            Name: "data-erasure-requests"
            Field: "DataErasureRequests"
            Key: "PassportUID"
        }

        Table: {
            Name: "business-answers"
            Field: "BusinessAnswers"
            Key: "ReviewId"
        }
    };
}
