service: ci
title: Woodcutter
ci:
  secret: sec-01e6y4xcg1ejd8p0w0xahm4amv
  triggers:
    - on: pr
      flow: sawmill-not-staged
      filters:
        - st-queues: CI
          author-services: [ci, testenv]
        - sub-paths: ['**.java', 'ya.make']
    - on: commit
      flow: sawmill-not-staged

  flows:
    sawmill-not-staged:
      title: Woodcutter
      jobs:

        picklock:
          title: Взломщик
          description: Отрывает секретницу, пока все на работе
          task: ci/picklock
          input:
            yavFilter:
              keys:
                song.00.are.you.ready.kids
                song.01.i.cant.hear.you
                song.02.who.lives.in.a.pineapple.under.the.sea
                song.03.absorbant.and.yellow.and.porous.is.he
                song.04.if.nautical.nonsense.be.something.you.wish
                song.05.then.drop.on.the.deck.and.flop.like.a.fish

        woodcutter:
          title: Дровосек
          description: Рубит деревья на бревна
          task: demo/woodflow/woodcutter

        sawmill-1:
          title: Лесопилка производительная
          description: Пилит бревна на доски
          task: demo/woodflow/sawmill
          input:
            document:
              title: Лесопилка производительная
              boardsPerTimber: 4
          needs: woodcutter

        sawmill-2:
          title: Лесопилка обычная
          description: Пилит бревна на доски
          task: demo/woodflow/sawmill
          input:
            document:
              title: Лесопилка обычная
              boardsPerTimber: 3
          needs: woodcutter

        furniture-factory:
          title: Мебельная фабрика
          description: Из досок собирает мебель
          task: demo/woodflow/sawmill
          needs:
            - sawmill-1
            - sawmill-2
            - picklock
