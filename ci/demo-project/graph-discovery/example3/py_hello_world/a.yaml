# comment
service: cidemo
title: "Yandex CI Demo Projects [graph discovery]"

ci:
  secret: sec-01e8agdtdcs61v6emr05h5q1ek
  runtime:
    sandbox-owner: CI

  releases:
    demo-sawmill-release-graph-discovery:
      title: "Graph discovery demo (example3: CI_GROUP in ya.make)"
      description: |
        Проект `py_hello_world` хочет триггерить CI-процессы при изменении в `cpp_project1`
        - Файл [py_project1/a.yaml](/arcadia/ci/demo-project/graph-discovery/example3/py_hello_world/a.yaml)
        - Создана директория `py_hello_world/watches_cpp_project1` с [ya.make](/arcadia/ci/demo-project/graph-discovery/example3/py_hello_world/watches_cpp_project1/ya.make) файлом с макросом `CI_GROUP` внутри
        - Изменение кода в `cpp_project1` стриггерит `py_hello_world/watches_cpp_project1/a.yaml` и все a.yaml'ы выше при условии, что graph-discovery включен
        - Отличие от `example2` в том, что поддиректория `watches_cpp_project1` создана внутри `py_hello_world` (`py_hello_world` - это `PY3_PROGRAM`)

        Стоит понимать, что если внутри `cpp_project1` меняется файл, не участвующий в системе сборки (например, README.md, который просто лежит), то CI-процессы не будут запущены, так как graph-discovery получает информацию от системы сборки.

        Код: [demo-project/graph-discovery/example3](/arcadia/ci/demo-project/graph-discovery/example3)
      flow: sawmill
      filters:
        - discovery: graph
      tags: [ demo, sawmill ]

  flows:
    sawmill:
      title: Flow with dummy job
      jobs:
        dummy:
          title: dummy
          task: dummy
