[tox]
envlist = isort,yapf,flake8,bandit,pylint

[testenv:deploy_df]
basepython = python3.6
commands = dbaas_bootstrap -c private/bootstrap-df.conf
deps = -rrequirements.txt

[testenv:deploy_preprod]
basepython = python3.6
commands = dbaas_bootstrap -c private/bootstrap-preprod.conf
deps = -rrequirements.txt

[testenv:deploy_prod]
basepython = python3.6
commands = dbaas_bootstrap -c private/bootstrap-prod.conf
deps = -rrequirements.txt

[testenv:isort]
basepython=python3.6
commands = isort --recursive --check-only --ignore-whitespace --diff dbaas_bootstrap
deps = -rrequirements.txt
       isort

[testenv:yapf]
basepython = python3.6
commands = yapf -rpd dbaas_bootstrap
deps = -rrequirements.txt
       yapf==0.22.0

[testenv:flake8]
basepython = python3.6
; ignoring the checks:
;   E126 (continuation line over-indented for hanging indent),
;   E131 (continuation line unaligned for hanging indent) as indentation is responsibility of yapf
;   F401 (module imported but unused) in favor of corresponding pylint check
commands = flake8 --select E,F,W,C,S --ignore=E126,E131,F401 dbaas_bootstrap
deps = -rrequirements.txt
       flake8
       flake8-string-format
       flake8-isort
       flake8-commas
       flake8-quotes
       flake8-print
       flake8-pep3101
       pep8
       flake8-snippets

[testenv:pylint]
basepython = python3.6
commands = pylint dbaas_bootstrap
deps = -rrequirements.txt
       pylint

[testenv:bandit]
basepython = python3.6
; ignoring the checks:
;   B101  assert_used
;   B601  paramiko_calls
;   B608  hardcoded_sql_expressions
commands = bandit -r -s B101,B601,B608 dbaas_bootstrap
deps = -rrequirements.txt
       bandit

[flake8]
; explicit inheritance from object is discouraged in Python 3
snippets=class.*\(object\)
