common_checks:
  host: '{{ host }}'
  notifications: "{{ notifications }}"
  namespace: "{{ namespace }}"
  aggregator: more_than_limit_is_problem
  aggregator_kwargs:
    mode: normal
    warn_limit: 1
    crit_limit: 10
    nodata_mode: skip
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

unreach_checks:
  host: '{{ host }}'
  notifications: "{{ notifications }}"
  namespace: "{{ namespace }}"
  aggregator: more_than_limit_is_problem
  aggregator_kwargs:
    mode: normal
    warn_limit: 1
    crit_limit: 10
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

meta_checks:
  host: '{{ host }}'
  notifications: "{{ notifications }}"
  namespace: "{{ namespace }}"
  aggregator: more_than_limit_is_problem
  aggregator_kwargs:
    mode: normal
    warn_limit: 1
    crit_limit: 10
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

unispace_checks:
  host: '{{ host }}'
  aggregator: logic_or
  namespace: "{{ namespace }}"
  aggregator_kwargs:
    mode: WARN
    nodata_mode: skip
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

ch_checks:
  host: '{{ host }}'
  notifications: "{{ notifications_worktime }}"
  namespace: "{{ namespace }}"
  aggregator: more_than_limit_is_problem
  aggregator_kwargs:
    mode: normal
    warn_limit: 1
    crit_limit: 10
    nodata_mode: skip
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

ch_ping_check:
  host: '{{ host }}'
  notifications: "{{ notifications_worktime }}"
  namespace: "{{ namespace }}"
  aggregator: more_than_limit_is_problem
  aggregator_kwargs:
    mode: percent
    warn_limit: 1
    crit_limit: 10
    nodata_mode: skip
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

ch_replication_check:
  host: '{{ host }}'
  notifications: "{{ notifications_worktime }}"
  namespace: "{{ namespace }}"
  aggregator: more_than_limit_is_problem
  aggregator_kwargs:
    mode: normal
    warn_limit: 1
    crit_limit: 10
    nodata_mode: skip
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

ch_ro_check:
  host: '{{ host }}'
  notifications: "{{ notifications_worktime }}"
  namespace: "{{ namespace }}"
  aggregator: more_than_limit_is_problem
  aggregator_kwargs:
    mode: normal
    warn_limit: 1
    crit_limit: 10
    nodata_mode: skip
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

ch_tls_check:
  host: '{{ host }}'
  notifications: "{{ notifications_worktime }}"
  namespace: "{{ namespace }}"
  aggregator: more_than_limit_is_problem
  aggregator_kwargs:
    mode: normal
    warn_limit: 0
    crit_limit: 1
    nodata_mode: skip
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

ch_s3_check:
  host: '{{ host }}'
  notifications: "{{ notifications_worktime }}"
  namespace: "{{ namespace }}"
  aggregator: more_than_limit_is_problem
  aggregator_kwargs:
    mode: normal
    warn_limit: 0
    crit_limit: 1
    nodata_mode: skip
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

unreach_act:
  aggregator_kwargs:
    unreach_mode: force_ok
    unreach_service:
      - check: :UNREACHABLE

unreach_pass:
  aggregator_kwargs:
    unreach_mode: force_ok
    unreach_service:
      - check: :META
      - check: :UNREACHABLE

ch_unreach_pass:
  aggregator_kwargs:
    unreach_mode: force_ok
    unreach_service:
      - check: :ch-ping
      - check: :META
      - check: :UNREACHABLE

ch_unreach_or_unispace_pass:
  aggregator_kwargs:
    unreach_mode: force_ok
    unreach_service:
      - check: :unispace
      - check: :ch-ping
      - check: :META
      - check: :UNREACHABLE
