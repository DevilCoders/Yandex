common_checks:
  host: '{{ host }}'
  notifications: "{{ notifications }}"
  aggregator: more_than_limit_is_problem
  namespace: "{{ namespace }}"
  aggregator_kwargs:
    crit_limit: 10
    mode: normal
    warn_limit: 1
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

unreach_checks:
  host: '{{ host }}'
  notifications: "{{ notifications }}"
  namespace: "{{ namespace }}"
  aggregator: logic_or
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

meta_checks:
  host: '{{ host }}'
  notifications: "{{ notifications }}"
  aggregator: timed_more_than_limit_is_problem
  namespace: "{{ namespace }}"
  aggregator_kwargs:
    limits:
      - day_start: 1
        day_end: 5
        time_start: 11
        time_end: 19
        warn: 0
        crit: 0
      - day_start: 1
        day_end: 5
        time_start: 20
        time_end: 10
        warn: 0
        crit: 10%
      - day_start: 6
        day_end: 7
        time_start: 0
        time_end: 23
        warn: 0
        crit: 10%
  children:
    type: CGROUP
    name: '{{ cgroup }}'

unispace_checks:
  host: '{{ host }}'
  notifications: "{{ notifications }}"
  aggregator: logic_or
  namespace: "{{ namespace }}"
  aggregator_kwargs:
    mode: WARN
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

golem_only:
  notifications: []

sms_only:
  notifications: "{{ notifications_sms }}"

unreach_act:
  aggregator_kwargs:
    unreach_mode: force_ok
    unreach_service:
      - check: :UNREACHABLE

unreach_pass:
  aggregator_kwargs:
    unreach_mode: force_ok
    unreach_service:
      - check: :META
      - check: :UNREACHABLE

redis_common_checks:
  host: '{{ host }}'
  notifications: "{{ notifications }}"
  aggregator: logic_or
  namespace: "{{ namespace }}"
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

redis_common_limit_checks:
  host: '{{ host }}'
  notifications: "{{ notifications }}"
  aggregator: timed_more_than_limit_is_problem
  namespace: "{{ namespace }}"
  tags: "{{ default_tags | default([]) }}"
  aggregator_kwargs:
    limits:
      - day_start: 1
        day_end: 7
        time_start: 0
        time_end: 23
        warn: 1
        crit: 5
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'

redis_unreach_pass:
  aggregator_kwargs:
    unreach_mode: force_ok
    unreach_service:
      - check: :redis-alive
      - check: :META
      - check: :UNREACHABLE

redis_workhours_checks:
  host: '{{ host }}'
  notifications: "{{ notifications }}"
  aggregator: timed_more_than_limit_is_problem
  namespace: "{{ namespace }}"
  aggregator_kwargs:
    limits:
      - day_start: 1
        day_end: 5
        time_start: 10
        time_end: 19
        warn: 0
        crit: 10
      - day_start: 1
        day_end: 5
        time_start: 20
        time_end: 9
        warn: 0
        crit: 100%
      - day_start: 6
        day_end: 7
        time_start: 0
        time_end: 23
        warn: 0
        crit: 100%
  __force__: True
  children:
    type: CGROUP
    name: '{{ cgroup }}'
