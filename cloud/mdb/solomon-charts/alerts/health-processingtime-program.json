let times = {cluster='<< health_cluster_name >>', service='<< health_service_id >>', project='<< project_id >>', dc='by_node', name='mdb_health_process_aggregate_health_dur_*_ammv'};

let aggregate_period = 10;
let avg_times = map(asap(times), x -> avg(x));

let is_yellow = max(avg_times) > aggregate_period / 3;
let is_red = max(avg_times) > aggregate_period / 2;

alarm_if(is_red);
warn_if(is_yellow);
