{% from "components/postgres/pg.jinja" import pg with context %}
[main]
log_level = DEBUG
repack_path = {{ pg.bin_path }}/pg_repack
bloat_perc_min = {{ salt['pillar.get']('data:index_repack:perc_min', 40) }}
bloat_bytes_min = {{ salt['pillar.get']('data:index_repack:bytes_min', 1000000000) }}
{% if salt['grains.get']('virtual', 'physical') == 'lxc' or salt['pillar.get']('data:index_repack:use_porto', False) %}
use_porto = yes
postgres_comm = {{ pg.postgres_comm }}
cpu_limit = {{ salt['pillar.get']('data:index_repack:cpu_limit', '1c') }}
io_limit = {{ salt['pillar.get']('data:index_repack:io_limit', '83886080') }}
{% else %}
use_porto = no
{% endif %}
wait-timeout = {{ salt['pillar.get']('data:index_repack:wait-timeout', 10) }}
{% set except_obj_list = salt['pillar.get']('data:index_repack:except_obj_list', none) %}
{% if except_obj_list %}
except_obj_list = {{ except_obj_list }}
{% endif %}
reserv_perc = {{ salt['pillar.get']('data:index_repack:reserv_perc', 6) }}
