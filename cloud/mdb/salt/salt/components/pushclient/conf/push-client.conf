{% set topic = 'dbaas-ext-log' if salt['pillar.get']('data:dbaas:vtype') == 'compute' else 'dbaas-int-log' %}
files:
- log_type: {{topic}}
  name: /var/log/auth.log
  pipe: /etc/pushclient/authlog_parser.py -c {{ salt['pillar.get']('data:dbaas:cluster_id', salt['grains.get']('id').split('.')[0][:-3]) }} -o syslog_auth
{% if accumulator | default(False) %}
{%   if 'push-client-files' in accumulator %}
{%     for line in accumulator['push-client-files'] %}
{{ line }}
{%     endfor %}
{%   endif %}
{% endif %}

ident: dbaas
logger:
  level: 6
  mode: file
  file: '/var/log/statbox/pushclient.log'
  timeformat: '%d.%m.%Y-%H.%M.%S'
network:
  data-port: 9000
  master-addr: logbroker.yandex.net
  master-port: 8999
  proto: rt
  transport: ipv6
watcher:
  state: /var/lib/push-client
