{% set pushclient_configs = ['/etc/pushclient/push-client.conf'] %}
{% if accumulator | default(False) %}
{%   if 'pushclient-default-config' in accumulator %}
{%     for line in accumulator['pushclient-default-config'] %}
{%       do pushclient_configs.append(line) %}
{%     endfor %}
{%   endif %}
{% endif %}
[pushclient]
execution_interval=60
execution_timeout=30
command=/usr/local/yandex/monitoring/pushclient.py -l "{{ pushclient_configs | join(' ') }}"
type=common
{% if salt['pillar.get']('data:dbaas:vtype') == 'compute' and salt['pillar.get']('data:dbaas:cluster_id') %}
send_for_host={{ salt.dbaas.managed_hostname() }}
{% endif %}
