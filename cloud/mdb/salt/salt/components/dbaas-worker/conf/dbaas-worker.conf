{%
set config = {
        "main": {
            "log_level": "INFO",
            "max_tasks": 10,
            "poll_interval": 1,
            "ca_path": "/opt/yandex/CA.pem",
            "metadb_dsn": "user=dbaas_worker port=6432 dbname=dbaas_metadb password=%s sslmode=verify-full" % salt['pillar.get']('data:config:pgusers:dbaas_worker:password', ''),
        },
        "dbm": {
            "managing_project_id": "0:1589",
            "project_id": "0:1589",
            "project": "pgaas",
            "url": ""
        },
        "s3": {
            "endpoint_url": 'https://s3.mds.yandex.net'
        },
        "compute": {
        },
        "vpc": {
        },
        "ssh": {
        },
        "dns": {
        },
        "yc_dns": {
        },
        "slayer_dns": {
        },
        "cert_api": {
            "url": "https://crt-api.yandex-team.ru",
            "ca_name": 'InternalCA',
            "cert_type": 'mdb',
        },
        "user_compute": {
        },
        "internal_api": {
            "url": "localhost",
            "ca_path": "/dev/null",
            "access_id": "dummy",
            "access_secret": "dummy"
        },
        "resource_manager": {
            "url": "localhost",
            "ca_path": "/dev/null"
        },
        "juggler": {
            "downtime_hours": 1,
            "url": "http://juggler-api.search.yandex.net:8998"
        },
        "deploy": {
        },
        "solomon": {
            "project": "internal-mdb",
            "service": "internal-mdb_dbaas",
            "service_provider_id": "managed-postgresql",
            "url": "https://solomon.yandex-team.ru",
            "ca_path": "/opt/yandex/CA.pem",
            "service_label": "mdb",
        },
        "conductor": {
            "url": "https://c.yandex-team.ru",
        },
        "postgresql": {
        },
        "clickhouse": {
        },
        "mongod": {
        },
        "mongos": {
        },
        "mongocfg": {
        },
        "mongoinfra": {
        },
        "zookeeper": {
        },
        "mysql": {
        },
        "sqlserver": {
        },
        "windows_witness": {
        },
        "redis": {
        },
        "kafka": {
        },
        "elasticsearch_data": {
        },
        "elasticsearch_master": {
        },
        "opensearch_data": {
        },
        "opensearch_master": {
        },
        "hadoop": {
        },
        "greenplum_master": {
        },
        "greenplum_segment": {
        },
        'dataproc_manager': {
            'url': '',
            'cert_file': '',
            'server_name': '',
            'sleep_time': 5,
            'grpc_timeout' : 30,
        },
        'instance_group_service': {
            'url': '',
            'grpc_timeout' : 30,
        },
        'managed_kubernetes_service': {
            'url': '',
            'grpc_timeout' : 30,
        },
        'managed_postgresql_service': {
            'url': '',
            'grpc_timeout' : 30,
        },
        'loadbalancer_service': {
            'url': '',
            'grpc_timeout' : 30,
        },
        'lockbox_service': {
            'url': '',
            'grpc_timeout' : 30,
        },
        'mlock': {
        },
        'iam_token_service': {
        },
        'iam_access_service': {
        },
        'iam_service': {
        },
        'iam_jwt': {
        },
        'cloud_storage': {
        },
        'environment_name': salt['dbaas.pillar']('data:dbaas:vtype'),
        'per_cluster_service_accounts': {
        },
   }
%}
{% for section, options in salt['pillar.get']('data:dbaas_worker:config', {}).items() %}
{%     for option, value in options.items() %}
{%         do config[section].update({option: value}) %}
{%     endfor %}
{% endfor %}
{{ config|json(indent=4) }}
