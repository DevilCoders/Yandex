logger:
  level: 6
  mode: file
  file: '/var/log/statbox/pushclient-grpc.log'
  timeformat: '%d.%m.%Y-%H.%M.%S'
  # Disable push-client own log shipment
  remote: 0
  telemetry_interval: -1

network:
  proto: pq
  master-addr: {{ salt.pillar.get('data:logship:logbroker_host', 'logbroker.yandex.net.') }}
{% if salt.pillar.get('data:logship:use_cloud_logbroker') %}
  master-port: {{ salt.pillar.get('data:logship:logbroker_port') }}
  database: {{ salt.pillar.get('data:logship:database') }}
  iam: 1
  iam-key-file: /etc/pushclient/grpc_logs.secret
  iam-endpoint: {{ salt.pillar.get('data:logship:iam_endpoint') }}
  ssl:
    enabled: 1
{% elif salt.pillar.get('data:logship:tvm') %}
  tvm-client-id: {{ salt.pillar.get('data:logship:tvm:client_id') }}
  tvm-server-id: {{ salt.pillar.get('data:logship:tvm:server_id') }}
  tvm-secret-file: /etc/pushclient/grpc_logs.secret
{% else %}
  oauth-secret-file: /etc/pushclient/grpc_logs.secret
  ssl:
    enabled: 1
{% endif %}

watcher:
  state: /var/lib/push-client-grpc

files:
#include "/etc/pushclient/conf.d/topics-security-grpc.conf"
#include "/etc/pushclient/conf.d/topics-logs-grpc.conf"
{% if salt.pillar.get('data:dbaas:cluster_type') in ['postgresql_cluster', 'mysql_cluster'] %}
#include "/etc/pushclient/conf.d/topics-perf-diag-grpc.conf"
{% endif %}
