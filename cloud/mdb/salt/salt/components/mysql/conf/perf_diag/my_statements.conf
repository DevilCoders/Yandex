{% if salt['pillar.get']('data:dbaas:flavor:cpu_limit') %}
    {% set cpu = salt['pillar.get']('data:dbaas:flavor:cpu_limit')|int %}
{% else %}
    {% set cpu = 4 %}
{% endif %}
{% if cpu > 2 %}
    {% set default_interval = 60 %}
{% else %}
    {% set default_interval = 600 %}
{% endif %}
{% set interval = salt['pillar.get']('data:perf_diag:my_statements_sample_period', default_interval)|int %}
{
    "args": {
        "config": {
            "statements_log_file": "/var/log/dbaas-my-perf-reporter/my-statements.log",
            "service_log_file": "/var/log/dbaas-my-perf-reporter/service_statements.log",
            "rotate_size": 10485760,
            "backup_count": 1,
            "cluster_id": "{{ salt['pillar.get']('data:dbaas:cluster_id') }}"
        }
    },
    "id": "my_statements",
    "misfire_grace_time": {{ interval }},
    "module": "my_statements",
    "schedule": {
        "seconds": {{ interval }},
        "trigger": "interval"
    },
    "timeout": {{ interval+55 }}
}
