[load_monitor]
plugin = common
module = load_monitor
interval = 15
checks = cpu, io
data_directory = /var/lib/mysql

{% if salt.pillar.get('data:dbaas:vtype') == 'compute' %}
cpu_check_iowait = true
{% else %}
cpu_check_iowait = false
{% endif %}
cpu_check_children = false

systemd_service = mysql

# cpu_limit = 0 -> get it from /etc/dbaas.conf
cpu_max_use_1 = 99.0
{% if salt.pillar.get('data:dbaas:flavor:cpu_guarantee') > 2 %}
cpu_max_use_15 = 95.0
cpu_max_use_60 = 95.0
{% else %}
cpu_max_use_15 = 80.0
cpu_max_use_60 = 80.0
{% endif %}

# io_bytes_limit = 0 -> get it from /etc/dbaas.conf
io_max_use_15 = 99
io_max_use_30 = 97
io_max_use_60 = 95

yasm_ttl = 300
yasm_suffix = tmmx
