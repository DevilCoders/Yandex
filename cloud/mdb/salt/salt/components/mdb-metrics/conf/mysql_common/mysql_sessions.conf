[mysql_sessions]
plugin = mysql
module = mysql_query
interval = 5

# use UNIX_TIMESTAMP to avoid mysql arithmetic error
query = SELECT CONCAT('session_', REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(LOWER(SUBSTRING_INDEX(EVENT_NAME, '/', -1)), ' ', '_'), '-', '_'), ')', ''), '(', ''), ';', '')) AS session_stage, COUNT(*) FROM performance_schema.events_stages_current WHERE EVENT_NAME NOT LIKE '%Master has sent all binlog to slave%' GROUP BY session_stage

yasm_suffix = vmmv,tmmx
yasm_tags_cmd = /usr/local/mysql_getter.py
