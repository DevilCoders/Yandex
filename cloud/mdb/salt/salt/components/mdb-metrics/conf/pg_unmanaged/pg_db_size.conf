[pg_db_size]
plugin = postgres
module = pg_query
interval = 60

query = select datname, pg_catalog.pg_database_size(datname) from pg_database where datname not in ('postgres', 'template0', 'template1');
databases = postgres
prefix_columns = datname

yasm_ttl = 120
yasm_suffix = vmmv,tmmx

[pg_total_dbs_size]
plugin = postgres
module = pg_query
interval = 60
{% if not salt.dbaas.is_compute() %}
query = select sum(pg_catalog.pg_database_size(oid)) as pg_database_size, sum(pg_catalog.pg_database_size(oid)) as pg_total_databases_size from pg_database;
{% else %}
query = select sum(pg_catalog.pg_database_size(oid)) as pg_total_databases_size from pg_database;
{% endif %}
databases = postgres

yasm_ttl = 120
yasm_suffix = vmmv,tmmx
