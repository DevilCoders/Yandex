{% if salt.pillar.get('data:ship_logs', False) %}

{% set cluster_id = salt.pillar.get('data:dbaas:cluster_id', 'unknown') %}
{% set topic = salt.pillar.get('data:logship:topics:kafka_logs') %}

- topic: {{ topic }}
  name: /var/log/kafka/server.log
  pipe: /etc/pushclient/kafka_log_parser.py -o kafka_server -t UTC -c {{ cluster_id }} 2>> /var/log/statbox/kafka_parser.log

- topic: {{ topic }}
  name: /var/log/kafka/controller.log
  pipe: /etc/pushclient/kafka_log_parser.py -o kafka_controller -t UTC -c {{ cluster_id }} 2>> /var/log/statbox/kafka_parser.log

{% if salt.pillar.get('data:kafka:connect_enabled', False) %}
- topic: {{ topic }}
  name: /var/log/kafka/connect.log
  pipe: /etc/pushclient/kafka_log_parser.py -o kafka_connect -t UTC -c {{ cluster_id }} 2>> /var/log/statbox/kafka_parser.log
{% endif %}

{% endif %}
