[pg_replication_alive]
execution_interval=60
execution_timeout=55
start_random_sleep=45
{% if salt['pillar.get']('data:dbaas:cluster_id') %}
command=/usr/local/yandex/monitoring/pg_replication_alive_dbaas.py -d {{ salt['pillar.get']('data:monrun:pg_replication_alive:dead_slot_allowed_time', '3600') }}
{% else %}
command=/usr/local/yandex/monitoring/pg_replication_alive.py -w {{ salt['pillar.get']('data:monrun:pg_replication_alive:warn', '1') }} -c {{ salt['pillar.get']('data:monrun:pg_replication_alive:crit', '0') }} -d {{ salt['pillar.get']('data:monrun:pg_replication_alive:dead_slot_allowed_time', '3600') }}
{% endif %}
type=postgres
{% if salt['pillar.get']('data:dbaas:vtype') == 'compute' and salt['pillar.get']('data:dbaas:cluster_id') %}
send_for_host={{ salt.dbaas.managed_hostname() }}
{% endif %}
