[tls]
execution_interval=3600
execution_timeout=290
start_random_sleep=270
{% if salt.mdb_redis.tls_enabled() %}
{% set port = salt.mdb_redis.get_redis_tls_port() %}
command=/usr/local/yandex/monitoring/tls.py {{ salt.grains.get('id') }} --pairs {{ salt.pillar.get('data:monrun:tls:pairs', port | string + ':' + salt.mdb_redis.get_cert()) }} -w {{ salt.pillar.get('data:monrun:tls:warn', '30') }} -c {{ salt.pillar.get('data:monrun:tls:crit', '14') }}
{% else %}
command=/bin/echo '0;OK'
{% endif %}
type=redis
{% if salt.dbaas.is_compute() and salt.dbaas.is_dataplane() %}
send_for_host={{ salt.dbaas.managed_hostname() }}
{% endif %}
