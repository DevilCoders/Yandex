{% set config = salt.grains.filter_by({
'Debian': {
    'warn': 6,
    'crit': 60,
    'watch_seconds': 600,
    'exclude': '',
    'logfile': '/var/log/clickhouse-server/clickhouse-server.err.log',
  }
}, merge=salt.pillar.get('data:monrun:ch_log_errors')) %}
[ch_log_errors]
execution_interval=120
execution_timeout=110
start_random_sleep=90
command=/usr/bin/ch-monitoring log-errors -w '{{ config.warn }}' -c '{{ config.crit }}' -n '{{ config.watch_seconds }}' -e '{{ config.exclude }}' -f '{{ config.logfile  }}'
type=clickhouse
{% if salt.pillar.get('data:dbaas:vtype') == 'compute' and salt.pillar.get('data:dbaas:cluster_id') %}
send_for_host={{ salt.dbaas.managed_hostname() }}
{% endif %}
