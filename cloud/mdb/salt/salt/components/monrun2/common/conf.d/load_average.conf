[load_average]
execution_interval=60
execution_timeout=55
start_random_sleep=45
# Set warning limit to {{ salt['pillar.get']('data:monrun:load_average:warn', '50') }} and critical limit to {{ salt['pillar.get']('data:monrun:load_average:crit', '100') }}, use absolute values

{% if not salt.dbaas.is_compute() and salt['grains.get']('virtual', '') != 'physical' %}
command=/bin/echo '0;OK'
{% else %}
command=/usr/local/yandex/monitoring/load_average.sh -w {{ salt['pillar.get']('data:monrun:load_average:warn', '100') }} -c {{ salt['pillar.get']('data:monrun:load_average:crit', '1000') }} -a
{% endif %}
type=common
{% if salt['pillar.get']('data:dbaas:vtype') == 'compute' and salt['pillar.get']('data:dbaas:cluster_id') %}
send_for_host={{ salt.dbaas.managed_hostname() }}
{% endif %}
