{% from "components/redis/server/map.jinja" import redis with context %}
# redis-server configure options

# ULIMIT: Call ulimit -n with this argument prior to invoking Redis itself.
# This may be required for high-concurrency environments. Redis itself cannot
# alter its limits as it is not being run as root. (default: 65536)
#
ULIMIT=65536

# Salt defaults
EXTRA_CMD_PARAMS=

{% if salt.mdb_redis.is_major_human_6_plus(redis.version.major_human) %}
{%     if redis.tls.enabled %}
EXTRA_CMD_PARAMS+="--tls-port {{ redis.tls.port }} --tls-replication yes "
{%         if redis.config.get('cluster-enabled') == 'yes' %}
EXTRA_CMD_PARAMS+="--tls-cluster yes "
{%         endif %}
{%     else %}
EXTRA_CMD_PARAMS+="--tls-port 0 --tls-replication no "
{%         if redis.config.get('cluster-enabled') == 'yes' %}
EXTRA_CMD_PARAMS+="--tls-cluster no "
{%         endif %}
{%     endif %}
{% endif %}
