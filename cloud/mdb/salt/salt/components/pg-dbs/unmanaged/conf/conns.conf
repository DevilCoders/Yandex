{% from "components/postgres/pg.jinja" import pg with context %}
[conns]
type = query
interval = 5
query = select count(*) filter (where state = 'idle') as conn_idle, count(*) filter (where state = 'idle in transaction (aborted)') as conn_aborted, count(*) filter (where state = 'idle in transaction') as conn_idle_in_transaction, count(*) filter (where state = 'active') as conn_active, count(*) filter (where state = 'active' and wait_event is not null) as conn_waiting from pg_stat_activity where datname = current_database() and usename <> 'postgres'
databases = {{ ' '.join(databases) }}
