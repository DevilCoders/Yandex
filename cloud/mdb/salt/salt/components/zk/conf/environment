{% set zk = salt.slsutil.renderer('salt://components/zk/defaults.py?saltenv=' ~ saltenv) %}
NAME=zookeeper
ZOOCFGDIR=/etc/$NAME/conf

CLASSPATH="$ZOOCFGDIR:/usr/share/java/jline.jar:/usr/share/java/log4j-1.2.jar:/usr/share/java/xercesImpl.jar:/usr/share/java/xmlParserAPIs.jar:/usr/share/java/netty.jar:/usr/share/java/slf4j-api.jar:/usr/share/java/slf4j-log4j12.jar:/usr/share/java/zookeeper.jar"

# Handle upstream default paths
if [ -e /usr/lib/zookeeper/lib/ ]; then
    CLASSPATH="${ZOOCFGDIR}"
    for file in /usr/lib/zookeeper/lib/*.jar; do
        CLASSPATH="${CLASSPATH}:${file}"
    done
fi

EXEC_OVERRIDES="-Dzookeeper.forceSync={{zk.config.forceSync}} -Djava.security.properties={{ zk.config_prefix }}/java.security"

ZOOCFG="$ZOOCFGDIR/zoo.cfg"
ZOO_LOG_DIR=/var/log/$NAME
USER=$NAME
GROUP=$NAME
PIDDIR=/var/run/$NAME
PIDFILE=$PIDDIR/$NAME.pid
SCRIPTNAME=/etc/init.d/$NAME
JAVA={{zk.java_bin}}
ZOOMAIN="org.apache.zookeeper.server.quorum.QuorumPeerMain"
ZOO_LOG4J_PROP="INFO,FILE"
JMXLOCALONLY=false
JAVA_OPTS="{{zk.jvm_flags}} ${EXEC_OVERRIDES}"
