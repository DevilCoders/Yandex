name: ${name}
description: "${description}"
service_account_id: ${service_account_id}
scale_policy:
  fixed_scale:
    size: ${instance_group_size}
deploy_policy:
    max_creating: ${max_creating}
    max_deleting: ${max_deleting}
    max_unavailable: ${max_unavailable}
    max_expansion: ${max_expansion}
    startup_duration: ${startup_duration}s
allocation_policy:
  zones:
      %{~ for zone in zones ~}
      - zone_id: ${zone}
      %{~ endfor ~}
platform_l7_load_balancer_spec:
  preferred_ip_version: IPV6
  target_group_spec:
    name: ${target_group_name}
    description: "${target_group_description}"
${health_checks_spec}
instance_template:
  %{ if instance_name != "" }name: ${instance_name}%{ else }%{ endif }
  %{ if instance_hostname != "" }hostname: ${instance_hostname}%{ else }%{ endif }
  platform_id: ${platform_id}
  service_account_id: ${service_account_id}
  ${labels}
  resources_spec:
    memory: ${memory_per_instance}g
    cores: ${cores_per_instance}
    gpus: ${gpus_per_instance}
  boot_disk_spec:
    mode: READ_WRITE
    disk_spec:
      image_id: ${image_id}
      type_id: ${disk_type}
      size: ${disk_per_instance}g
  secondary_disk_specs:
    ${secondary_disk_specs}
  scheduling_policy:
    ${scheduling_policy}
  network_interface_specs:
    - subnet_ids:
      %{~ for subnet in subnets ~}
      - ${subnet}
      %{~ endfor ~}
      primary_v4_address_spec: {}
      primary_v6_address_spec: {}
  ${metadata}