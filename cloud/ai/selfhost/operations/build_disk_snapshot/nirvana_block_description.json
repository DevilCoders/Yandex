{
    "meta": {
        "name": "BuildDiskSnapshot",
        "versionNumber": "1.0",
        "description": "",
        "deterministic": true,
        "processorCode": "job",
        "processorOperationCode": "run",
        "owner": "petrmali"
    },
    "permissions": [
        {
            "action": "modify",
            "roles": [
                {
                    "role": "nirvana.operation.cloudml"
                }
            ]
        }
    ],
    "resources": [
        {
            "name": "build_disk_snapshot",
            "@type": "DumpedOperationYaMakeResource",
            "artifact": "build_disk_snapshot",
            "target": "cloud/ai/selfhost/operations/build_disk_snapshot"
        }
    ],
    "inputs": [
        {
            "name": "package",
            "description": "",
            "dataTypes": [
                "binary"
            ],
            "lowerBound": 1,
            "upperBound": 1,
            "processingHints": ["unpack"]
        }
    ],
    "outputs": [
        {
            "name": "image",
            "dataType": "binary"
        }
    ],
    "parameters": [
        {
            "parameter": "job-command",
            "type": "string",
            "required": true,
            "defaultValue": "./build_disk_snapshot [#if param[\"image-size\"]??]--size=${param[\"image-size\"]}[/#if] --data-path '${input[\"package\"].unpacked}' --output-file '${output[\"image\"]}'",
            "cacheInsensitive": false
        },
        {
            "parameter": "job-layer",
            "description": "",
            "type": "multiple_strings",
            "required": false,
            "label": "job-layer",
            "tooltip": "",
            "cacheInsensitive": false
        },
        {
            "parameter": "job-layer-yt-path",
            "description": "",
            "type": "multiple_strings",
            "required": false,
            "label": "job-layer-yt-path",
            "tooltip": "",
            "cacheInsensitive": false
        },
        {
            "parameter": "name",
            "type": "string",
            "required": true,
            "defaultValue": "snapshot",
            "cacheInsensitive": false
        },
        {
            "parameter": "max-ram",
            "description": "Job's maximum memory usage, in megabytes",
            "type": "integer",
            "required": true,
            "defaultValue": 2000,
            "label": "Max. RAM, Mb:",
            "cacheInsensitive": true
        },
        {
            "parameter": "cpu-guarantee",
            "type": "integer",
            "required": true,
            "defaultValue": 100,
            "cacheInsensitive": false
        },
        {
            "parameter": "max-disk",
            "type": "integer",
            "required": false,
            "defaultValue": 102400,
            "label": "Max. Disk, Mb:",
            "cacheInsensitive": false
        },
        {
            "parameter": "image-size",
            "type": "string",
            "required": false,
            "label": "Image size",
            "cacheInsensitive": false
        }
    ]
}
