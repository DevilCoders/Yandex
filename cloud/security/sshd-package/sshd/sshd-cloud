Port 22
ListenAddress ::
Protocol 2
HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_dsa_key
HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key
UsePrivilegeSeparation yes
KeyRegenerationInterval 3600
ServerKeyBits 1024
SyslogFacility AUTH
LoginGraceTime 120
StrictModes yes
RSAAuthentication yes
PubkeyAuthentication yes
IgnoreRhosts yes
RhostsRSAAuthentication no
HostbasedAuthentication no
PermitEmptyPasswords no
ChallengeResponseAuthentication no
PrintMotd no
PrintLastLog yes
TCPKeepAlive yes
AcceptEnv YANDEX_*
AcceptEnv LANG LC_*
UsePAM yes
LogLevel VERBOSE
PasswordAuthentication no
PermitRootLogin without-password
UseDNS no
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com
KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521

Match User breakglass
  TrustedUserCAKeys /etc/sshca
  AuthorizedKeysFile none
  AllowUsers breakglass@2a02:6b8::/29 # Yandex Nets
  AllowUsers breakglass@2a0d:d6c0::/29 # Cloud Prefix
  AuthorizedKeysCommand /bin/true # turn off oslogin for this user
  AuthorizedKeysCommandUser nobody

Match User root
  TrustedUserCAKeys /etc/sshca
  AllowUsers root@2a02:6b8::/29 # Yandex Nets
  AllowUsers root@2a0d:d6c0::/29 # Cloud Prefix
  AuthorizedKeysCommand /bin/true # turn off oslogin for this user
  AuthorizedKeysCommandUser nobody
  # allow certain users use root for login:
  AuthorizedPrincipalsFile /etc/ssh/root.users.allow
  # AuthorizedKeysFile none  # allow only CA key for this user

Match User *,!breakglass,!root
  # Uncomment the next line when oslogin-based ssh is fully deployed. The line is commented to enable compatibility mode.
  # AuthorizedKeysFile none
  # Bastion hosts whitelist
  AllowUsers *@2a02:6b8:bf00:109:526b:4bff:fedb:73e9
  AllowUsers *@2A02:6B8:BF00:2005:526B:4BFF:FEDB:7A41
  AllowUsers *@2A02:6B8:BF00:10F:526B:4BFF:FEDB:7BD1
  AllowUsers *@2A02:6B8:BF00:110B:526B:4BFF:FEDB:6DE9
  # Bastion hosts projectids
  AllowUsers *@2a02:6b8:c0e:500:0:f847::/96
  AllowUsers *@2a02:6b8:c02:900:0:f847::/96
  AllowUsers *@2a02:6b8:c03:500:0:f847::/96
  # Bootstap hosts
  AllowUsers *@2a02:6b8:bf00:108:526b:4bff:fedb:7c41
  AllowUsers *@2a02:6b8:bf00:10a:526b:4bff:fedb:7a29
  AllowUsers *@2a02:6b8:bf00:1117:9cbe:6ff:fe45:bdea
  AllowUsers *@2a02:6b8:bf00:220c:9cbe:6ff:febf:8dbf
  # YDB emergency / build hosts
  AllowUsers *@2a02:6b8:bf00:10a:526b:4bff:fedb:7a29
