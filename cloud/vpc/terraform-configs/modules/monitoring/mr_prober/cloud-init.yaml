#cloud-config
datasource:
  Ec2:
    strict_id: false

runcmd:
  # Set the hostname
  - hostname ${hostname}

write_files:
  - path: /etc/default/mr_prober
    content: |
      STAND_NAME=${stand_name}
      HOST=[::]
      PORT=80
      ADDITIONAL_PORT=81
      DEBUG=False
      LOG_LEVEL=DEBUG
      S3_ENDPOINT=${s3_endpoint}
      S3_PREFIX=${stand_name}/
      HOSTNAME=${hostname}
      API_WORKERS_PER_CORE=2
      URLLIB3_USE_ONLY_IPV6_IF_AVAILABLE=True

      # For yc-mr-prober-meeseeks tool running on creator instance
      GRPC_IAM_API_ENDPOINT=${grpc_iam_api_endpoint}
      GRPC_COMPUTE_API_ENDPOINT=${grpc_compute_api_endpoint}
      MR_PROBER_API_ENDPOINT=https://${api_domain}
      MEESEEKS_COMPUTE_NODE_PREFIXES_CLI_PARAM=${meeseeks_compute_node_prefixes_cli_param}
