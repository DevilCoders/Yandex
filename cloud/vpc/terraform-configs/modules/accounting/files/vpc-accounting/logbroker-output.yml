channels:
  - name: logbroker_output
    channel:
      output:
        plugin: logbroker
        config:
          # https://logbroker.yandex-team.ru/docs/concepts/clusters_and_installations#installations_list
          endpoint: ${logbroker_endpoint}
          database: ${logbroker_database}
          topic: !expr "{output_topic}"
          codec: gzip
          compression_quality: 6
          iam:
            cloud_meta: {}

          use_ssl: {}

routes:
  - input:
      plugin: grpc
      config:
        uri: unix:///etc/yandex/unified_agent/accounting
        grpc_memory_quota: 100mb
        max_receive_message_size: 11mb
        grpc_error_log_priority: ERROR
    channel:
      channel_ref:
        name: logbroker_output
