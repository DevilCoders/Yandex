{
  "__comment":"universal build recipie for quemu builder, with minimal customization - userdata and winrm",
  "variables": { "name": "" },
  "builders": [
    {
      "name": "{{user `name`}}-dc",
      "output_directory": "{{build_name}}/output",

      "iso_url": "{{build_name}}/{{build_name}}.iso",
      "iso_checksum": "file:{{build_name}}/{{build_name}}.iso.sha1",

      "floppy_dirs": [
        "scripts/*",
        "autounattend_dc/*",
        "{{build_name}}/drivers/*"
      ],

      "cpus": 2,
      "memory": 4096,
      "type": "qemu",
      "qemuargs": [
               [ "-parallel", "none" ],
               [ "-m", "4096M" ],
               [ "-smp", "cpus=2" ]
      ],
      "machine_type": "q35",
      "use_default_display": true,
      "disk_size": 51200,
      "disk_compression": true,
      "communicator": "none",
      "shutdown_timeout": "120m"
    },
    {
      "name": "{{user `name`}}-std",
      "output_directory": "{{build_name}}/output",

      "iso_url": "{{build_name}}/{{build_name}}.iso",
      "iso_checksum": "file:{{build_name}}/{{build_name}}.iso.sha1",

      "floppy_dirs": [
        "scripts/*",
        "autounattend_std/*",
        "{{build_name}}/drivers/*"
      ],

      "cpus": 2,
      "memory": 4096,
      "type": "qemu",
      "qemuargs": [
               [ "-parallel", "none" ],
               [ "-m", "4096M" ],
               [ "-smp", "cpus=2" ]
      ],
      "machine_type": "q35",
      "use_default_display": true,
      "disk_size": 51200,
      "disk_compression": true,
      "communicator": "none",
      "shutdown_timeout": "120m"
    },
  ],
  "post-processors": [
    {
      "type": "manifest",
      "output": "{{build_name}}-{{isotime \"060102-1504\"}}.json",
      "strip_path": true
    }
  ]
}