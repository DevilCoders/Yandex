definitions:
  - &alert_juggler_description "(doc: https://nda.ya.ru/t/diJesaob5FntWp)"

alerts:
  - id: "prod_snapshot_ydb_cpu_usage"
    name: "[PROD] Snapshot YDB CPU usage"
    description: *alert_juggler_description
    window_secs: 300
    clusters:
      - prod
    channels:
      - id: juggler
        notify_about_statuses:
          - ALARM
    annotations:
      tags: "yc-prod-snapshot-solomon"
      host: "solomon-alert-cloud_prod_snapshot"
      service: "solomon_alert_snapshot_ydb"
      juggler_description: *alert_juggler_description
      graph_link: "https://solomon.yandex-team.ru/?project=kikimr&cluster=yandexcloud_prod_global&service=utils&l.database=/global/snapshot&l.host=cluster&l.sensor=ElapsedMicrosec&l.slot=*&l.execpool=User&graph=auto&downsamplingAggr=max&b=31d&e="
    threshold:
      selectors: "{project='kikimr', cluster='yandexcloud_prod_global', service='utils', database='/global/snapshot', host='cluster', sensor='ElapsedMicrosec', slot='cluster', execpool='User'}"
      predicate_rules:
        - aggregation: "AT_LEAST_ONE"
          comparison: "GT"
          threshold: 150
          target_status: "ALARM"
