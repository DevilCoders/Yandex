definitions:
  - defaults: &defaults
      name: "dsproxy"
      port: 8769
      path: "/counters/counters=dsproxynode/spack"
      add_ts_args: false
      interval: 15
      grid_sec: 0
      protocol: "PULL_PROTOCOL_UNSPECIFIED"
      sensors_ttl_days: 1
services:
  - id: "nbs_dsproxy"
    <<: *defaults
    clusters:
      - prod
    sensor_conf:
      aggr_rules:
      - cond:
        - host=*
        target:
        - host=cluster
      - cond:
        - host=vla*
        target:
        - host=cluster-vla
      - cond:
        - host=myt*
        target:
        - host=cluster-myt
      - cond:
        - host=sas*
        target:
        - host=cluster-sas
      - cond:
        - host=man*
        target:
        - host=cluster-man
      - cond:
        - host=nbs-control*
        target:
        - host=nbs-control
      - cond:
        - database=*
        target:
        - database=total
      - cond:
        - host=*
        - sizeClass=*
        target:
        - host=cluster
        - sizeClass=total

  - id: "nbs_dsproxy"
    <<: *defaults
    clusters:
      - israel
    sensor_conf:
      aggr_rules:
      - cond:
        - host=*
        target:
        - host=cluster
      - cond:
        - host=il1-a*
        target:
        - host=cluster-il1-a
      - cond:
        - host=nbs-control*
        target:
        - host=nbs-control
      - cond:
        - database=*
        target:
        - database=total
      - cond:
        - host=*
        - sizeClass=*
        target:
        - host=cluster
        - sizeClass=total
