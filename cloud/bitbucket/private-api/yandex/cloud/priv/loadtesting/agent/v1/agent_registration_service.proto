syntax = "proto3";

package yandex.cloud.priv.loadtesting.agent.v1;

import "yandex/cloud/api/operation.proto";
import "yandex/cloud/priv/operation/operation.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/loadtesting/agent/v1;agent";


service AgentRegistrationService {

  rpc Register (RegisterRequest) returns (RegisterResponse);
  rpc ExternalAgentRegister (ExternalAgentRegisterRequest) returns (operation.Operation) {
    option (yandex.cloud.api.operation) = {
      metadata: "ExternalAgentRegisterMetadata"
      response: "AgentInstance"
    };
  };
}

message RegisterRequest {
  string compute_instance_id = 1;
}

message RegisterResponse {
  string agent_instance_id = 1;
}

message ExternalAgentRegisterRequest {
  string folder_id = 1;
  string compute_instance_id = 2;
  string name = 3;
  string agent_version = 4;
}

message ExternalAgentRegisterMetadata {
  string agent_instance_id = 1;
}
