# Update:
#  $ ycp --profile=prod platform alb load-balancer update -r alb-lb.yaml
#

# Fields used for creation:
#folder_id: "b1gaqi8r2cbb368gp68v"
#internal: true

load_balancer_id: ds7t0cpihlmue4jt52s9

# diff -y  <(ycp --profile=prod platform alb load-balancer get ds7t0cpihlmue4jt52s9) <(ycp --profile=prod platform alb load-balancer update -r alb-lb.yaml)
dry_run: true
update_mask:
  paths:
  - labels
  - listener_specs

name: "container-registry"
description: "CR"
labels:
  internal-instance-name: container-registry-l7-prod
  internal-solomon-cluster: cloud_prod_container_registry
  internal-conductor-group: l7-container-registry
  internal-enable-remote-als: yyy
  internal-disable-local-als: yyy
listener_specs:
- name: frontend-tls
  endpoint_specs:
  - ports: [443]
    address_specs:
    - external_ipv4_address_spec: {}
    - external_ipv6_address_spec: {}
  tls:
    default_handler:
      http_handler:
        http_router_id: ds7qrnun88isppkv635g
        is_edge: true
        http2_options:
          initial_stream_window_size: 1048576
          initial_connection_window_size: 1048576
          max_concurrent_streams: 100
      certificate_ids: ["fpquiu61ts6ccer2bu1b"]
      tls_options:
        tls_min_version: TLS_V1_2
    tcp_options:
      connection_buffer_limit_bytes: 32768 # 32 KiB

allocation_policy:
  locations:
  - { zone_id: ru-central1-a, subnet_id: e9bi9drqb7rddf4od5jk }
  - { zone_id: ru-central1-b, subnet_id: e2lo6auqjjfru2tfnorm }
  - { zone_id: ru-central1-c, subnet_id: b0c3id3uje06qohkgmlg }
