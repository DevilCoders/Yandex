# Update:
#
#  $ ycp --profile=prod load-balancer network-load-balancer update b7r6v5c7f8hlmfneh7d3 -r l3-nlb-spec-v6.yaml
#

# Fields used for creation (also remove "address"):
# id: b7r6v5c7f8hlmfneh7d3
# folder_id: b1gvgqhc57450av0d77p # common
# region_id: ru-central1
# type: EXTERNAL

update_mask: {paths: [attached_target_groups]} # Extra safety.

name: dpl01-router-lb-v6
description: "LB for dpl01-router (IPv6)"
labels: {}
listener_specs:
- name: "tls-v6"
  port: 443
  target_port: 2443
  protocol: TCP
  external_address_spec:
    address: '2a0d:d6c1:0:1c::27b'
    ip_version: IPV6
    yandex_only: false # dpl01-router is exposed to Internet
- name: "plaintext-v6"
  port: 80
  target_port: 2080
  protocol: TCP
  external_address_spec:
    address: '2a0d:d6c1:0:1c::27b'
    ip_version: IPV6
    yandex_only: false # dpl01-router is exposed to Internet
attached_target_groups:
- target_group_id: b7riljrtjeajic9p8fae # dpl01-router-targetgroup
  health_checks:
  - name: "envoy-ping"
    timeout: 1s
    interval: 2s
    unhealthy_threshold: 2
    healthy_threshold: 2
    http_options:
      port: 30080
      path: /ready/no_drain
