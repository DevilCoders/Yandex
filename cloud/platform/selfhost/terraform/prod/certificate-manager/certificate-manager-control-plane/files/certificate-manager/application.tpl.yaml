grpcServer:
  maxConcurrentRequests: 100
  port: ${private_api_port}
  reflectionEnabled: true
  certificatePemFile: /run/ycm/certificate.pem

authClient:
  host: as.private-api.cloud.yandex.net
  port: 4286
  timeout: PT2S
  maxRetries: 5
  fake: false

accessCheck:
  providersFolderId: yc.certificate-manager.providers

metrics:
  pullPort: 4302

yandexMonitoringMetrics:
  refreshPeriod: PT15S
  pullPort: 4303

security:
  systemKmsKeyId: abjgce11gi027hk1u0lb

kmsClient:
  host: kms-cpl.private-api.ycp.cloud.yandex.net
  port: 443
  tls: true
  maxRetries: 3
  timeout: PT2S

kmsCryptoClient:
  hosts: [kms.yandex]
  port: 8443
  tls: true
  maxRetries: 3
  timeout: PT2S

iamConfig:
  host: iam.private-api.cloud.yandex.net
  port: 4283
  tls: true
  maxRetries: 7
  timeout: PT10S

resourceManager:
  host: rm.private-api.cloud.yandex.net
  port: 4284
  maxRetries: 7
  timeout: PT10S

apiAdapter:
  host: api-adapter.private-api.ycp.cloud.yandex.net
  port: 443
  maxRetries: 7
  timeout: PT10S

accessBindingClient:
  host: iam.private-api.cloud.yandex.net
  port: 4283
  maxRetries: 7
  timeout: PT5S
  tls: true

repository:
  kikimr:
    host: certificate-manager-dn-${zone}1.svc.cloud.yandex.net
    discoveryEndpoint: ydb-certificate-manager.cloud.yandex.net:2136
    port: 2136
    tablespace: /global/certificate-manager/
    database: /global/certificate-manager
    useSSL: true
  maxResultSetSize: 10000

quota:
  defaultMaxCertificatesPerCloud: 20
  defaultMaxDomainsPerCloud: 10

cluster:
  clusterId: fpq

acme:
  providers:
    LETS_ENCRYPT: lets-encrypt-prod
  accountKeySize: 2048
  email: ycm-letsencrypt-announcements@yandex-team.ru
  reportNotificationInterval: PT24H

solomonPusher:
  host: solomon.cloud.yandex-team.ru
  project: certificate-manager
  cluster: prod
  service: core
  oauthTokenFile: /run/ycm/solomon-token

renew:
  period: PT10M
  batch: 10
  renewBeforeExpirationPeriod: P30D
  renewAfterExpirationPeriod: P14D

healthCheckServer:
  port: ${private_api_healthcheck_port}
  path: /ping

dns:
  hosts:
    - 2001:4860:4860::8888  #Google
    # Temporarily disabled until https://st.yandex-team.ru/CLOUD-88929 is resolved
    # - 2620:119:35::35       #OpenDNS
    - 2606:4700:4700::1111  #Cloudflare
    - 2a02:6b8::feed:0ff    #Yandex
  maxRetries: 5
  systemZone:
    zoneId: dns9l4bp3u3nlcumssaj
    fqdn: cm.yandexcloud.net.
    ttl: 300
  enableCnameAndTxtConflictDetection: false

cleanup:
  period: PT1M
  batch: 100
  cleanupAfter: P2D
  cleanupAccountDomainUsagesAfter: P300D

orderJob:
  minDelay: PT1M
  maxDelay: PT6H
  maxAge: P14D
  cautiousAccountReusePeriod: P90D
  challengeSuccessLimit: 5
  reuseAccountsForFolders:
    - b1g9khpkbocd3gk5tlv7

notification:
  clientConfig:
    host: notify.cloud.yandex.net
    port: 443
    maxRetries: 0
    timeout: PT1M
    tls: true
  period: PT1H
  notifyBeforeExpirationDays:
    - 21
    - 7
    - 3

scheduledDispatcher:
  interval: P500D
  period: PT1M
  limit: 100

dnsClient:
  host: dns.private-api.ycp.cloud.yandex.net
  port: 443
  tls: true
  maxRetries: 7
  timeout: PT5S

search:
  taskProcessorPoolName: default
  batchSize: 100
  logbroker:
    discoveryEndpoint: lb.etn03iai600jur7pipla.ydb.mdb.yandexcloud.net
    database: /global/b1gvcqr959dbmi1jltep/etn03iai600jur7pipla
    useSSL: true
    topic: /yc.search/search-access

challengeStopList:
  httpDomains: [video-ru.wispence.com]
  dnsDomains: []

trustedRoots:
  files:
    - /etc/certificate-manager/GPNInternalRootCA.crt
    - /etc/certificate-manager/TechparkCA.crt

crtApi:
  minDelay: PT1M
  timeout: PT15S
  # The requests will be retried after minDelay, do not set this too high.
  numRetries: 2
  providers:
    INTERNAL_CERTUM:
      # The ending slashes ARE important.
      endpoint: https://crt-api.yandex-team.ru/api/certificate/
      oauthTokenFile: /run/ycm/crt-api-token
      defaultType: host
      caName: CertumProductionCA
      # https://abc.yandex-team.ru/services/yckms
      abcService: 4260
      warnAfter: P2D
    INTERNAL_CA:
      # The ending slashes ARE important.
      endpoint: https://crt.cloud.yandex.net/api/certificate
      oauthTokenFile: /run/ycm/cloud-crt-api-token
      types:
        .gpn.yandexcloud.net: gpn_ca
        .yac.techpark.local: gpn_int_ca
      defaultType: ca
      # https://abc.yandex-team.ru/services/yckms
      abcService: 4260
      warnAfter: PT1H
