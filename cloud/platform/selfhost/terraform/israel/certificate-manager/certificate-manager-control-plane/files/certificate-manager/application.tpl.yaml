grpcServer:
  maxConcurrentRequests: 100
  port: ${api_port}
  reflectionEnabled: true
  certificatePemFile: /run/certificate-manager/certificate.pem

authClient:
  host: as.private-api.yandexcloud.co.il
  port: 14286
  maxRetries: 11
  timeout: PT2S

accessCheck:
  providersFolderId: yc.certificate-manager.providers

security:
  systemKmsKeyId: ${system_kms_key_id}

kmsClient:
  host: cpl.kms.private-api.yandexcloud.co.il
  port: 8443
  tls: true
  maxRetries: 3
  timeout: PT2S

kmsCryptoClient:
  hosts: [dpl.kms.private-api.yandexcloud.co.il]
  port: 8443
  tls: true
  maxRetries: 3
  timeout: PT2S

# TODO: Remove from certificate-manager config.
iamConfig:
  host: unused
  port: 0
  tls: true
  maxRetries: 0
  timeout: PT0S

resourceManager:
  host: rm.private-api.yandexcloud.co.il
  port: 14284
  maxRetries: 3
  timeout: PT10S

# TODO: Remove from certificate-manager config.
apiAdapter:
  host: iam.private-api.yandexcloud.co.il
  port: 14283
  tls: true
  maxRetries: 3
  timeout: PT5S

accessBindingClient:
  host: iam.private-api.yandexcloud.co.il
  port: 14283
  tls: true
  maxRetries: 3
  timeout: PT5S

metrics:
  pullPort: 4302

yandexMonitoringMetrics:
  refreshPeriod: PT15S
  pullPort: 4303

repository:
  kikimr:
    host: ""
    discoveryEndpoint: u-lb.certificate-manager-israel.ydb.yandexcloud.co.il:2135
    database: /israel_global/certificate-manager
    tablespace: /israel_global/certificate-manager/main/
    useSSL: true
    sessionCreationTimeout: PT15S

quota:
  defaultMaxCertificatesPerCloud: 20
  defaultMaxDomainsPerCloud: 10

cluster:
  clusterId: ${id_prefix}

acme:
  providers:
    LETS_ENCRYPT: lets-encrypt-israel
  accountKeySize: 2048
  email: ycm-letsencrypt-announcements@yandex-team.ru
  reportNotificationInterval: PT24H

solomonPusher:
  host: solomon.yandexcloud.co.il
  project: yc.certificate-manager.service-cloud
  cluster: cloud_israel_ycm_cluster
  service: service
  useSystemAccount: true

renew:
  period: PT10M
  batch: 10
  renewBeforeExpirationPeriod: P30D
  renewAfterExpirationPeriod: P14D

# TODO: Looks pretty useless, remove from certificate-manager
healthCheckServer:
  port: 9444
  path: /ping

#dns:
#  hosts:
#    - localhost
#  maxRetries: 0
#  systemZone:
#    zoneId: unused
#    fqdn: unused
#    ttl: 0

dns:
#  hosts:
#    - 2001:4860:4860::8888  #Google
#    # Temporarily disabled until https://st.yandex-team.ru/CLOUD-88929 is resolved
#    # - 2620:119:35::35       #OpenDNS
#    - 2606:4700:4700::1111  #Cloudflare
#    - 2a02:6b8::feed:0ff    #Yandex
  hosts:
    - 8.8.8.8  #Google
    # Temporarily disabled until https://st.yandex-team.ru/CLOUD-88929 is resolved
    # - 2620:119:35::35       #OpenDNS
    - 1.1.1.1  #Cloudflare
    - 77.88.8.8  #Yandex
  maxRetries: 5
  systemZone:
    zoneId: "yc.cm.cm"
    fqdn: cm.yandexcloud.co.il.
    ttl: 300

cleanup:
  period: PT1M
  batch: 100
  cleanupAfter: P2D
  cleanupAccountDomainUsagesAfter: P300D

orderJob:
  minDelay: PT1M
  maxDelay: PT6H
  maxAge: P14D
  cautiousAccountReusePeriod: P90D
  challengeSuccessLimit: 5
  reuseAccountsForFolders: []
#    - b1g9khpkbocd3gk5tlv7  #TODO create account for israel?

notification:
  clientConfig:
    host: notify.yandexcloud.co.il
    port: 443
    maxRetries: 0
    timeout: PT1M
    tls: true
  period: PT1H
  notifyBeforeExpirationDays:
    - 21
    - 7
    - 3

scheduledDispatcher:
  interval: P500D
  period: PT1M
  limit: 100

dnsClient:
  host: dns.private-api.yandexcloud.co.il
  port: 19444
  tls: true
  maxRetries: 7
  timeout: PT5S

#search:
#  taskProcessorPoolName: default
#  batchSize: 100
#  logbroker:
#    discoveryEndpoint: unused
#    database: unused
#    useSSL: true
#    topic: unused

challengeStopList:
  httpDomains: []
  dnsDomains: []

trustedRoots:
  files: []

crtApi:
  minDelay: PT1M
  timeout: PT15S
  # The requests will be retried after minDelay, do not set this too high.
  numRetries: 2
  providers:
    INTERNAL_CA:
      # The ending slashes ARE important.
      endpoint: https://crt.infra.yandexcloud.co.il/api/certificate
      oauthTokenFile: /run/certificate-manager/cloud-crt-api-token
      defaultType: ca
      # https://abc.yandex-team.ru/services/yckms
      abcService: 4260
      warnAfter: PT1H
