# Update:
#  $ ycp --profile=gpn platform alb load-balancer update -r alb-lb.yaml
#

# Fields used for creation:
#folder_id: "bn3v8a9sj6u8ih3a088r"
#internal: true

load_balancer_id: fkecf45f0kp6p4e7id2a

#update_mask:
#  paths: [labels, allocation_policy]

labels:
  internal-instance-name: cpl
  internal-conductor-group: l7-cpl

allocation_policy:
  locations:
  - { zone_id: ru-gpn-spb99, subnet_id: e57mq3uf1nimamcnoahu }

#solomon_cluster_name: cloud_gpn_cpl

name: "cpl"
description: "Private API"
listener_specs:
- name: frontend-tls
  endpoint_specs:
  - ports: [443]
    address_specs:
     - external_ipv6_address_spec:
        yandex_only: true
  tls:
    default_handler:
      http_handler:
        http_router_id: fke835fqmh5jeputd8dh
        is_edge: false
      certificate_ids: ["cert-cpl"]
    sni_handlers:
    - name: monitoring-charts
      server_names: ["monitoring-charts.ycp.gpn.yandexcloud.net"]
      handler:
        http_handler:
          http_router_id: fkeqqmlh9u4j87dule20 
          is_edge: false
        certificate_ids: ["cert-cpl"]
    - name: dns
      server_names: ["dns.private-api.ycp.gpn.yandexcloud.net"]
      handler:
        http_handler:
          http_router_id: fkehu8cv8cd4moi80a8q
          is_edge: false
        certificate_ids: ["cert-cpl"]
