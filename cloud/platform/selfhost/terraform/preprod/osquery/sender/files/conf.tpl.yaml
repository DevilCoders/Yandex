tls: true
key: /run/osquery-sender/certificate.key
cert: /run/osquery-sender/certificate.crt
debug: false
hostname_keys:
  - hostname
  - hostIdentifier
hosts:
  osquery.cloud-preprod.yandex.net:
    insecure_enroll: true

clickhouse:
  debug: true
  hosts: ${clickhouse_hosts}
  connection_params:
    database: yc-osquery
    username: yc-osquery
    secure: true
    read_timeout: 20
    write_timeout: 180
  password_file: /run/osquery-sender/clickhouse-password
  event_names:
    - .*
  max_memory: ${ch_sender_batch_memory}
  drop_after_days: 5

s3:
  debug: true
  access_key_id: ${s3_access_key_id}
  secret_access_key_file: /run/osquery-sender/s3-secret-access-key
  endpoint: ${s3_endpoint}
  region: ru-central1
  bucket: yc-osquery-events
  compression: lz4
  max_memory: ${s3_sender_batch_memory}
  merge_daily: true
  delete_merged_after_days: 7
