uid: ycp-jaeger-lb-plugin
title: Jaeger LB Plugin
variables:
  ui:
    cluster:
      values:
        - preprod
        - prod
queryDefaults:
  labels: project=jaeger, service=jaeger_service
links:
  - title: "Main"
    url: https://grafana.yandex-team.ru/d/ycp-jaeger-ydb
  - title: "LB Reader"
    url: https://grafana.yandex-team.ru/d/ycp-jaeger-lb-reader
  - title: "YDB Plugin"
    url: https://grafana.yandex-team.ru/d/ycp-jaeger-ydb-plugin
  - title: "Errors"
    url: https://grafana.yandex-team.ru/d/ycp-jaeger-errors
  - title: "Drops"
    url: https://grafana.yandex-team.ru/d/ycp-jaeger-drops
rows:
  - title: Collector Service
    graphDefaults:
      datasource: Solomon Cloud
      width: 12
      height: 6
    queryDefaults:
      labels: cluster=jaeger_collector_${cluster}, host=jaeger-collector-lb-${cluster}-*
    panels:
      - type: graph
        templates:
          name: rps
          sumLines:
            - host
        display:
          sort: decreasing
          stack: true
          empty: false
          fill: 0
          nulls: zero
        title: Received span/s ($cluster)
        queries:
          - params:
              labels: name=jaeger_collector_spans_received_total, format=*, svc=*, debug=false
        yAxes:
          - label: span/s
      - type: graph
        templates:
          name: rps
          sumLines:
            - host
        display:
          sort: decreasing
          stack: true
          empty: false
          fill: 0
          nulls: zero
        title: Written span/s ($cluster)
        queries:
          - params:
              labels: name=jaeger_lb_writer_written_total
        yAxes:
          - label: span/s
      - type: graph
        title: Queue length ($cluster)
        queries:
          - params:
              labels: name=jaeger_collector_queue_length
            select:
              group_by_labels:
                - sum
                - host
              diff: []
              drop_below:
                - 0
      - type: graph
        templates:
          name: rps
          sumLines:
            - host
        display:
          sort: decreasing
          stack: true
          empty: false
          fill: 0
          nulls: zero
        title: Dropped span/s ($cluster)
        queries:
          - params:
              labels: name=jaeger_collector_spans_dropped_total
        yAxes:
          - label: span/s
      - type: graph
        templates:
          name: rps
          sumLines:
            - host
        display:
          sort: decreasing
          stack: true
          empty: false
          fill: 0
          nulls: zero
        title: Write errors ($cluster)
        queries:
          - params:
              labels: name=jaeger_lb_writer_errors_total
        yAxes:
          - label: span/s
      - type: graph
        templates:
          name: rps
          sumLines:
            - host
        display:
          sort: decreasing
          stack: true
          empty: false
          fill: 0
          nulls: zero
        title: Persqueue issues ($cluster)
        queries:
          - params:
              labels: name=jaeger_lb_writer_persqueue_issues_total
        yAxes:
          - label: issues/s
      - type: graph
        templates:
          name: rps
          sumLines:
            - host
        display:
          sort: decreasing
          stack: true
          empty: false
          fill: 0
          nulls: zero
        title: Push failures ($cluster)
        queries:
          - params:
              labels: name=jaeger_lb_writer_push_failed_total
        yAxes:
          - label: failures/s
  - title: Latencies
    graphDefaults:
      datasource: Solomon Cloud
      width: 12
      height: 6
    queryDefaults:
      labels: cluster=jaeger_collector_${cluster}, host=jaeger-collector-lb-${cluster}-*
    panels:
      - type: graph
        templates:
          name: percentile
          groupLines: true
          format: solomon
        title: LB collector save latency ($cluster)
        queries:
          - params:
              labels: name=jaeger_collector_save_latency
      - type: graph
        templates:
          name: percentile
          groupLines: true
          format: solomon
        title: LB collector in-queue latency ($cluster)
        queries:
          - params:
              labels: name=jaeger_collector_in_queue_latency
