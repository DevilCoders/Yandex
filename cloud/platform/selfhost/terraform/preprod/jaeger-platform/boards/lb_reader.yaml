uid: ycp-jaeger-lb-reader
title: Jaeger LB Reader
variables:
  ui:
    cluster:
      values:
        - preprod
        - prod
queryDefaults:
  labels: project=jaeger, service=jaeger_service
links:
  - title: "Main"
    url: https://grafana.yandex-team.ru/d/ycp-jaeger-ydb
  - title: "LB Plugin"
    url: https://grafana.yandex-team.ru/d/ycp-jaeger-lb-plugin
  - title: "YDB Plugin"
    url: https://grafana.yandex-team.ru/d/ycp-jaeger-ydb-plugin
  - title: "Errors"
    url: https://grafana.yandex-team.ru/d/ycp-jaeger-errors
  - title: "Drops"
    url: https://grafana.yandex-team.ru/d/ycp-jaeger-drops
rows:
  - title: Collector Service
    graphDefaults:
      datasource: Solomon Cloud
      width: 12
      height: 6
    queryDefaults:
      labels: cluster=jaeger_collector_${cluster}, host=jaeger-lb-reader-${cluster}-*|jaeger-lb-reader-ydb-${cluster}-*|jaeger-lb-reader-global-${cluster}-*|jaeger-lb-reader-global2-${cluster}-*|jaeger-lb-reader-ydb2-${cluster}-*
    panels:
      - type: graph
        templates:
          name: rps
          sumLines:
            - host
        display:
          sort: decreasing
          stack: true
          empty: false
          fill: 0
          nulls: zero
        title: Posted span/s ($cluster)
        queries:
          - params:
              labels: name=jaeger_reader_posted_total
        yAxes:
          - label: span/s
      - type: graph
        templates:
          name: rps
          sumLines:
            - host
        display:
          sort: decreasing
          stack: true
          empty: false
          fill: 0
          nulls: zero
        title: Errors ($cluster)
        queries:
          - params:
              labels: name=jaeger_reader_errors_total
        yAxes:
          - label: errors/s
      - type: graph
        templates:
          name: rps
          sumLines:
            - host
        display:
          sort: decreasing
          stack: true
          empty: false
          fill: 0
          nulls: zero
        title: Received span/s ($cluster)
        queries:
          - params:
              labels: name=jaeger_collector_spans_received_total, format=*, svc=*, debug=false
        yAxes:
          - label: span/s
      - type: graph
        title: Queue length ($cluster)
        queries:
          - params:
              labels: name=jaeger_collector_queue_length
            select:
              group_by_labels:
                - sum
                - host
              diff: []
              drop_below:
                - 0
        display:
          sort: decreasing
          stack: true
          empty: false
          fill: 0
          nulls: zero
      - type: graph
        templates:
          name: rps
          sumLines:
            - host
        display:
          sort: decreasing
          stack: true
          empty: false
          fill: 0
          nulls: zero
        title: Dropped span/s ($cluster)
        queries:
          - params:
              labels: name=jaeger_collector_spans_dropped_total
        yAxes:
          - label: span/s
  - title: Latencies
    graphDefaults:
      datasource: Solomon Cloud
      width: 12
      height: 6
    queryDefaults:
      labels: cluster=jaeger_collector_${cluster}, host=jaeger-lb-reader-${cluster}-*|jaeger-lb-reader-ydb-${cluster}-*|jaeger-lb-reader-global-${cluster}-*|jaeger-lb-reader-global2-${cluster}-*|jaeger-lb-reader-ydb2-${cluster}-*
    panels:
      - type: graph
        templates:
          name: percentile
          groupLines: true
          format: solomon
        title: YDB collector save latency ($cluster)
        queries:
          - params:
              labels: name=jaeger_collector_save_latency
        display:
          fill: 0
          nulls: zero
      - type: graph
        templates:
          name: percentile
          groupLines: true
          format: solomon
        title: YDB collector in-queue latency ($cluster)
        queries:
          - params:
              labels: name=jaeger_collector_in_queue_latency
        display:
          fill: 0
          nulls: zero
      - type: graph
        templates:
          name: percentile
          groupLines: true
          format: solomon
        title: YDB traces latency ($cluster)
        queries:
          - params:
              labels: name=jaeger_ydb_writer_traces_latency_ok
        display:
          fill: 0
          nulls: zero
      - type: graph
        templates:
          name: percentile
          groupLines: true
          format: solomon
        title: YDB tag index latency ($cluster)
        queries:
          - params:
              labels: name=jaeger_ydb_writer_tag_index_latency_ok
        display:
          fill: 0
          nulls: zero
      - type: graph
        templates:
          name: percentile
          groupLines: true
          format: solomon
        title: YDB service name latency ($cluster)
        queries:
          - params:
              labels: name=jaeger_ydb_writer_service_name_index_latency_ok
        display:
          fill: 0
          nulls: zero
      - type: graph
        templates:
          name: percentile
          groupLines: true
          format: solomon
        title: YDB service operation index latency ($cluster)
        queries:
          - params:
              labels: name=jaeger_ydb_writer_service_operation_index_latency_ok
        display:
          fill: 0
          nulls: zero
      - type: graph
        templates:
          name: percentile
          groupLines: true
          format: solomon
        title: YDB duration index latency ($cluster)
        queries:
          - params:
              labels: name=jaeger_ydb_writer_duration_index_latency_ok
        display:
          fill: 0
          nulls: zero
      - type: graph
        templates:
          name: rps
        display:
          sort: decreasing
          stack: false
          fill: 0
          nulls: zero
        title: YDB Records ($cluster)
        queries:
          - params:
              labels: name=jaeger_ydb_writer_traces_records_ok_total|jaeger_ydb_writer_tag_index_records_ok_total|jaeger_ydb_writer_service_name_index_records_ok_total|jaeger_ydb_writer_service_operation_index_records_ok_total|jaeger_ydb_writer_duration_index_records_ok_total
