apiVersion: v1
kind: Pod
metadata:
  clusterName: events
  name: events
spec:
  containers:
    - name: events
      image: registry.yandex.net/cloud/cloud-go/iot/events-broker:{{ events_application_version }}
      env:
        - name: IOT_EVENTS_PRODUCTION
          value: "true"
        - name: IOT_EVENTS_FROM_CONNECTION_ADDRESS
          value: "lbkx.logbroker.yandex.net"
        - name: IOT_EVENTS_FROM_CONSUMER_CLIENTID
          value: "/yc-iot/events-prod"
        - name: IOT_EVENTS_FROM_CONSUMER_TOPICS
          value: "/yc-iot/prod"
        - name: IOT_EVENTS_FROM_CONSUMER_TOPICS_PERM
          value: "/yc-iot/prod-permanent"
        - name: IOT_EVENTS_TO_CONNECTION_TOPICS
          value: "lbkx.logbroker.yandex.net"
        - name: IOT_EVENTS_TO_TOPIC
          value: "/yc-iot/prodevents"
        - name: IOT_EVENTS_TVM_AUTH_TOKEN
          value: "158b6649b39e83ed08cb14b8530f0339"
        - name: IOT_EVENTS_METRICS_SUBSYSTEM
          value: "cloud_events_prod"
        - name: IOT_EVENTS_SELFPING_REGISTRY_ID
          value: "arevhahjp4ho3up30oao"
        - name: IOT_EVENTS_SELFPING_TOPICPREFIX
          value: "$registries/arevhahjp4ho3up30oao/events"
      volumeMounts:
        - mountPath: /etc/yc-iot
          name: iot-all-conf
          readOnly: true
        - mountPath: /var/log/yc-iot/events
          name: events-logs
  hostNetwork: true
  volumes:
    - name: iot-all-conf
      hostPath:
        path: /etc/yc-iot
    - name: events-logs
      hostPath:
        path: /var/log/yc-iot/events
        type: DirectoryOrCreate
