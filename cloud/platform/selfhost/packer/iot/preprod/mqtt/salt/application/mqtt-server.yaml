immutable: true
port: 8883
server_crt: "/etc/yc-iot/mqtt/ssl/certs/server.crt"
server_key: "/etc/yc-iot/mqtt/ssl/private/server.key"
tvm:
  daemon_port: 18080
grpc:
  port: 443
  cert_file: "/etc/yc-iot/mqtt/ssl/certs/iot-data.crt"
  key_file: "/etc/yc-iot/mqtt/ssl/private/iot-data.key"

logbroker:
  connection:
    choose_proxy_timeout: 5s
    max_recv_msg_size: 50MB
    max_send_msg_size: 50MB
  consumer:
    balance_partition_right_now: true
    clientside_locks_allowed: true
    commit_interval: 0
    max_time_lag: 0
    read_only_local: true
    commits_disabled: false
    max_read_size: 40MB
  producer:
    max_producers: 5
    max_batch_size: 128KB

logbroker_perm:
  connection:
    choose_proxy_timeout: 5s
    max_recv_msg_size: 50MB
    max_send_msg_size: 50MB
  consumer:
    balance_partition_right_now: true
    clientside_locks_allowed: true
    commit_interval: 0
    max_time_lag: 0
    read_only_local: true
    commits_disabled: false
    max_read_size: 40MB
  producer:
    max_producers: 5
    max_batch_size: 128KB

logbroker_monitoring:
  connection:
    choose_proxy_timeout: 5s
    max_recv_msg_size: 50MB
    max_send_msg_size: 50MB
  consumer:
    balance_partition_right_now: true
    clientside_locks_allowed: true
    commit_interval: 0
    max_time_lag: 0
    read_only_local: true
    commits_disabled: false
    max_read_size: 40MB
  producer:
    max_producers: 5
    max_batch_size: 128KB

shard:
  commands_msg_buffer_size: 128
  topic_msg_buffer_size: 10
shard_upstream:
  consumers_count: 1
  buffer_size: 100
  history_time_window: 10m
remote_sub:
  discovery:
    client:
      max_retries: 4
      timeout: 20s
      retry_timeout: 5s
    group_id: amc5macq7gn5reto5g4d
    status_override: { CHECKING_HEALTH: up }
    instance_port: 443
  client:
    client_msg_buff_size: 100
    partitions_count: 20
    cmd_queue_capacity: 1000
    discovery_period: 20s
    grpc:
      tls: true
      max_retries: 5
      timeout: 5s
      retry_timeout: 1s

metrics:
  namespace: mqtt
  listen-addr: 127.0.0.1:12580
selfcheck:
  checking_interval: 5s
  max_fail_time: 20s
  healing_interval: 20s
http_selfcheck:
  ports: [8081, 8082]
billing:
  send_period: 15m
  logbroker:
    connection:
      choose_proxy_timeout: 5s
      max_recv_msg_size: 50MB
authorizer:
  max_retries: 5
  timeout: 5s
  retry_timeout: 0.5s
cloud_logger:
  buff_size: 100
  config:
    filename:                "/var/log/yc-iot/mqtt/cloud-logs.log"
    maxsize:                 1024
    maxage:                  1
    maxbackups:              2
    localtime:               false
    compress:                false
self_ping:
  check_period: 1m
  ping_timeout: 20s
  sub_cert: /etc/yc-iot/mqtt/ssl/certs/ping_sub_cert.pem
  pub_cert: /etc/yc-iot/mqtt/ssl/certs/ping_pub_cert.pem
self_ping_perm:
  check_period: 1m
  ping_timeout: 20s
  sub_cert: /etc/yc-iot/mqtt/ssl/certs/ping_sub_cert.pem
  pub_cert: /etc/yc-iot/mqtt/ssl/certs/ping_pub_cert.pem
logging:
  file_path: "/var/log/yc-iot/mqtt/access.log"
  level: debug
  compress: true
  max_age_days: 14
  max_log_size: 100MB

enable_permanent_feature: true

database_config:
  directory: permanent
  source_name: source
  endpoint: ydb-iot-dpl.cloud-preprod.yandex.net:2136
  log_level: Error
  driver_database: /pre-prod_global/iot-dpl
  driver_request_timeout: 30s
  driver_discovery_interval: -1
  dialer_timeout: 10s
  dialer_keep_alive: 5s
  auth_enabled: true
  use_tls: true

ydb_lock:
  owner_name: "" # overridden from metadata
scheduler:
  lock_keepalive: 5s
  acquire_timeout: 5s
perm_resend_task:
  resend_after_delay: 10s
  launch_period: 20s

enable_monitoring_feature: true

