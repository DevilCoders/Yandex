apiVersion: v1
kind: Pod
metadata:
  clusterName: events
  name: events
spec:
  containers:
    - name: events
      image: registry.yandex.net/cloud/cloud-go/iot/events-broker:{{ events_application_version }}
      env:
        - name: IOT_EVENTS_PRODUCTION
          value: "false"
        - name: IOT_EVENTS_FROM_CONNECTION_ADDRESS
          value: "vla.logbroker.yandex.net"
        - name: IOT_EVENTS_FROM_CONSUMER_CLIENTID
          value: "/yc-iot/events-preprod"
        - name: IOT_EVENTS_FROM_CONSUMER_TOPICS
          value: "/yc-iot/preprod"
        - name: IOT_EVENTS_FROM_CONSUMER_TOPICS_PERM
          value: "/yc-iot/preprod-permanent"
        - name: IOT_EVENTS_TO_CONNECTION_TOPICS
          value: "logbroker.yandex.net"
        - name: IOT_EVENTS_TO_TOPIC
          value: "/yc-iot/preprodevents"
        - name: IOT_EVENTS_TVM_AUTH_TOKEN
          value: "764a5f28530362a00af4d459ea670e2a"
        - name: IOT_EVENTS_METRICS_SUBSYSTEM
          value: "cloud_events_preprod"
        - name: IOT_EVENTS_SELFPING_REGISTRY_ID
          value: "b91fao245q2khrkfgr8s"
        - name: IOT_EVENTS_SELFPING_TOPICPREFIX
          value: "$registries/b91fao245q2khrkfgr8s/events"
      volumeMounts:
        - mountPath: /etc/yc-iot
          name: iot-all-conf
          readOnly: true
        - mountPath: /var/log/yc-iot/events
          name: events-logs
  hostNetwork: true
  volumes:
    - name: iot-all-conf
      hostPath:
        path: /etc/yc-iot
    - name: events-logs
      hostPath:
        path: /var/log/yc-iot/events
        type: DirectoryOrCreate
