apiVersion: v1
kind: Pod
metadata:
  clusterName: filestore-server
  name: filestore-server
spec:
  terminationGracePeriodSeconds: 70
  containers:
    - name: filestore-server
      image: "{{app_image}}:{{app_version}}"
      command: ["/bin/bash", "-c", "source /Berkanavt/nfs-server/cfg/nfs_server.cfg && /usr/bin/filestore-server ${nfs_arg}"]
      env:
        - name: APPLICATION_YAML
          value: /etc/filestore-server/app.yaml
      volumeMounts:
        - name: service-configs
          mountPath: /Berkanavt/nfs-server/cfg
          readOnly: true
        - name: service-secrets
          mountPath: /Berkanavt/nfs-server/secrets
          readOnly: true
        - name: service-logs
          mountPath: /Berkanavt/nfs-server/logs
          readOnly: false
        - name: systemd-log
          mountPath: /dev/log
          readOnly: false
  hostNetwork: true
  hostPID: true
  volumes:
    - name: service-configs
      hostPath:
        path: /etc/filestore-server/
        type: DirectoryOrCreate
    - name: service-secrets
      hostPath:
        path: /var/run/filestore-server/
        type: DirectoryOrCreate
    - name: service-logs
      hostPath:
        path: /var/log/filestore-server/
        type: DirectoryOrCreate
    - name: systemd-log
      hostPath:
        type: Socket
        path: /dev/log
