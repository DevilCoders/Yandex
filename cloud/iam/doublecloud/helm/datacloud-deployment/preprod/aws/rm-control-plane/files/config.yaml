cluster:
  clusterId: ecv

healthCheck:
  port: 9983
  path: /ping
  shutdownDelay: 20

metrics:
  pullPort: 6060

grpcServer:
  certificatePemFile: '/etc/yc/rm-control-plane/certs/server.pem'
  maxConcurrentRequests: 256
  reflectionEnabled: true
  port: 4284
  permitKeepAliveWithoutCalls: true
  permitKeepAliveTime: PT10S
  maxConnectionAge: PT3H

kikimr:
  database: /pre-prod_aws-frankfurt/iam
  tablespace: /pre-prod_aws-frankfurt/iam/
  discoveryEndpoint: iam.aws-frankfurt-preprod.ydb.yadc.tech:2135
  useSSL: true
  useTrustStore: true
  sessionCreationTimeout: PT5S
  auth:
    type: JWT
    jwt:
      endpoint: https://iam.api.cloud.yandex.net/iam/v1/tokens
      keyId: yc.iam.rmControlPlane
      serviceAccountId: yc.iam.rmControlPlane
      privateKeyPath: '/etc/yc/rm-control-plane/secrets/ydb-sa-private.key'
      ttl: PT5M

repository:
  bootstrapMode: DO_NOTHING
  retryCount: 33 # XXX: Return an adequate value after https://st.yandex-team.ru/CLOUD-46108
  isolationLevel: SERIALIZABLE_READ_WRITE

# < 128 bytes per item
folderRegistryCache:
  expire: P1D
  maxSize: 131072 # < 16M
  isolationLevel: ONLINE_CONSISTENT_READ_ONLY
  reload:
    interval: PT5S
    batchSize: 1000
    shardBatchSize: 1000

# < 128 bytes per item
cloudRegistryCache:
  expire: P1D
  maxSize: 131072 # < 16M
  isolationLevel: ONLINE_CONSISTENT_READ_ONLY
  reload:
    interval: PT5S
    batchSize: 1000
    shardBatchSize: 1000

systemAccountService:
  jwt:
    serviceAccountId: yc.iam.rmControlPlane
    keyId: yc.iam.rmControlPlane
    privateKeyPath: '/etc/yc/rm-control-plane/secrets/yc.iam.rmControlPlane.key'
    endpoint: https://iam.api.cloud.yandex.net/iam/v1/tokens
    ttl: PT10M

taskProcessor:
  dispatcher:
    taskPollInterval: PT5s
    dispatchingDelay: PT3s
  shutdown:
    waitDuration: PT10s
    interruptDuration: PT10s
  keepAliveInterval: PT60s
  pools:
    - name: default
      nThreads: 4

batchProcessing:
  entitiesPerTransaction: 999

authClient:
  host: as.private-api.eu-central-1.aws.preprod.iam.internal.yadc.tech
  port: 4286
  tls: True
  timeout: PT2S
  maxRetries: 7

iamClient:
  host: iam.private-api.eu-central-1.aws.preprod.iam.internal.yadc.tech
  port: 4283
  tls: True
  timeout: PT5S
  maxRetries: 5

resourceReaperClient:
  host: reaper.private-api.eu-central-1.aws.preprod.iam.internal.yadc.tech
  port: 7376
  tls: True
  timeout: PT5S
  maxRetries: 5
organizationManagerClient:
  host: org.private-api.eu-central-1.aws.preprod.iam.internal.yadc.tech
  port: 4290
  tls: True
  timeout: PT5S
  maxRetries: 5
billingClient:
  host: localhost
  port: 443
  tls: true
  timeout: PT10S
  maxRetries: 5

tokenServiceClient:
  host: ts.private-api.eu-central-1.aws.preprod.iam.internal.yadc.tech
  port: 4282
  tls: True
  timeout: PT5S
  maxRetries: 5

defaultRemoteOperationRetry:
  maxWaitForSuccessfulResponse: PT1H

resourceManager:
  ownerRoleId: resource-manager.clouds.owner
  createNewCloudActive: False
  cloudFolderAsProjectMode: True
  deletion:
    defaultDeletionDelay: P1D
    notifyDeletionProcess: False
  # organization functionality feature flags
  listOrganizationCloudsOnly: True
  skipOwnershipForOrganizationClouds: True
  # only for migration to restrictions
  autoRestrictionAssignment: False

resourceReaper:
  serviceAccountId: yc.iam.reaper
  role: internal.resourcereaper

compute:
  availabilityZones: [test-zone-a]

quota:
  cloudsCountLimit: 100

# Whitelisted resources, protected from deletion
cloudWhitelist:
  cloudIdsPattern: ^yc\.(?!e2e)(?!resource-manager\.limbo$).+
  cloudIds:
    - eden                      # eden (initial cloud)
    - yc.resource-manager.limbo # limbo (cloud for deleted folders)
