{
  "id": "${SERVICE_NAME}-denied-${CLUSTER_NAME}",
  "projectId": "${PROJECT_ID}",
  "name": "${SERVICE_NAME} denied requests ${CLUSTER_NAME}",
  "groupByLabels": [
    "host"
  ],
  "type": {
      "expression": {
          "program": "let deniesCount = max(diff({'project'='${PROJECT_ID}', 'cluster'='${CLUSTER_NAME}', 'service'='${SERVICE_NAME}', host='myt*|sas*|vla*|spb*', 'sensor'='denied'}));",
          "checkExpression": "deniesCount > 0"
      }
  },
  "annotations": {
    "description": "Status not equal to OK means token agent not initialized on host.",
    "host": "{{labels.host}}",
    "service": "${SERVICE_NAME}",
    "url": "https://${SOLOMON_ENDPOINT}/admin/projects/${PROJECT_ID}/alerts/${SERVICE_NAME}-denied-${CLUSTER_NAME}"
  },
  "windowSecs": 300,
  "delaySecs": 600,
  "channels": ${CHANNELS}
}
