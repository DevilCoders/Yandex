folderId: 569316
uid: yc-vs-entity-statistics
refresh: 3m
title: Vulnerability Scanner Usage

tags: [ 'ycp', 'ycp-vs' ]

graphDefaults:
  datasource: Solomon Cloud
  width: 8
  height: 8

panels:
  - type: graph
    title: 'Scans per OS'
    queries:
      - params: { labels: 'project=yc.vulnerability-scanner.cloud, cluster=yc.vs.metrics, host=cluster, service=controller-ma, namespace="*"' }
        groupByTime: { sum: '1m' }
        select: { group_by_labels: [ 'sum', "namespace" ], diff: [ ], drop_below: '0', alias: '{{namespace}}' }
  - type: graph
    title: 'Analysis per OS'
    queries:
      - params: { labels: 'project=yc.vulnerability-scanner.cloud, cluster=yc.vs.metrics, host=cluster, service=analyzer-ma, namespace="*"' }
        groupByTime: { max: '1m' }
        select: { group_by_labels: [ 'sum', "namespace" ], diff: [ ], drop_below: '0', alias: '{{namespace}}' }
  - type: graph
    title: 'Scans started from UI'
    queries:
      - params: { labels: 'project=yc.cr.cloud, cluster=yc.cr.metrics, host=cluster, service=manager-ma, name=grpc_requests, meter_type=count, method="containerregistry.v1.console.ScannerService/Scan"' }
        groupByTime: { max: '1m' }
        select: { diff: [ ], drop_below: '0', alias: '# of clicks' }
