id: 146049
uid: rChDCz6iz
refresh: 10m
title: Instance Groups usage basics

tags: [ 'ycp', 'ycp-ig' ]

variables:
  ui:
    cluster: { values: [prod, preprod] }
    aggregation: { values: [1m, 5m, 10m, 15m, 30m, 1h, 24h] }
    user_type: { values: [EXTERNAL, INTERNAL], multi: true, hidden: true }

graphDefaults:
  datasource: Solomon Cloud
  width: 8
  height: 8

queryDefaults: { labels: 'project=instance-group, cluster=${cluster}, service=backend, host=cluster' }

rows:
  - title: '$user_type usage'
    uiRepeat: user_type
    panels:
      - type: graph
        title: IG Live Groups Count
        display: { decimals: 0, stack: true, nulls: connected }
        yAxes: [{ decimals: 0, min: 0 }]
        params: { width: 12 }
        queries:
          - params: { labels: 'name="ig_live_count", user_type=$user_type' }
            select: { alias: 'ig count ({{user_type}})' }

      - type: graph
        title: IG Live Managed Instances Count
        display: { decimals: 0, stack: true, empty: false, nulls: connected }
        yAxes: [{ decimals: 0, min: 0 }]
        params: { width: 12 }
        queries:
          - params: { labels: 'name="ig_total_instances_count", user_type=$user_type, status=*' }
            select: { alias: '{{status}}' }
  #          - params: { labels: 'name="ig_total_instances_count", user_type=$user_type' }
      #            select: { alias: 'old' }

      - type: graph
        title: IG Autoscale Group Count
        display: { decimals: 0, stack: true, nulls: connected }
        yAxes: [{ decimals: 0, min: 0 }]
        params: { width: 12 }
        queries:
          - params: { labels: 'name="autoscale_group_count", user_type=$user_type' }
            select: { alias: 'ig count ({{user_type}})' }

  - title: Operations
    panels:
      - type: graph
        title: IG Create Operations Count
        display: { decimals: 0, lineModes: bars, legend: false }
        yAxes: [{ decimals: 0, min: 0 }]
        queries:
          - params: { labels: 'name="ig_create_operations"' }
            groupByTime: { max: '${aggregation}' }
            select: { diff: [], drop_below: '0', alias: 'op count' }

      - type: graph
        title: IG Update Operations Count
        display: { decimals: 0, lineModes: bars, legend: false }
        yAxes: [{ decimals: 0, min: 0 }]
        queries:
          - params: { labels: 'name="ig_update_operations"' }
            groupByTime: { max: '${aggregation}' }
            select: { diff: [], drop_below: '0', alias: 'op count' }

      - type: graph
        title: IG Delete Operations Count
        display: { decimals: 0, lineModes: bars, legend: false }
        yAxes: [{ decimals: 0, min: 0 }]
        queries:
          - params: { labels: 'name="ig_delete_operations"' }
            groupByTime: { max: '${aggregation}' }
            select: { diff: [], drop_below: '0', alias: 'op count' }
