id: 476806
uid: iam-duty-deploy
title: IAM Duty Deploy
folderId: 412692
refresh: 1m

tags: [ 'iam', 'iam-duty-deploy' ]
links:
  !include shared/links.yaml duty-deploy

graphDefaults: { datasource: '${ds}', width: 7, height: 6 }
queryDefaults:
  labels: 'project=yc.iam.service-cloud, service=${service:pipe}, cluster=${service}-${cluster}, host=${host:pipe}, app=${appFilter}, method=*'
  dropNan: true

variables:
  ui:
    !include shared/services.yaml
      multi: true
    appFilter:
      values: [ '*_server', '*', '*_client', 'kikimr_client', 'auth_client' ]
    !include shared/datasources.yaml
  uiQuery:
    cluster:
      inheritLabels: false
      labels: 'project=yc.iam.service-cloud, cluster=*-*, host=@all_hosts'
      regex: '.*-(prod-internal|prod|preprod|israel|testing)'
    host:
      labels: 'service=*, cluster=*-${cluster}, host=@all_hosts, app=*|-'
      multi: true
  replacement:
    !include shared/replacements.yaml
    !include shared/errors.yaml

rows:
  - title: '${service} GRPC Metrics'
    panels:
      !include shared/grpc_panels.yaml
    uiRepeat: service

  - title: 'Identity HTTP Metrics'
    queryDefaults: { labels: 'service=identity, cluster=identity-${cluster}, metric=api_request_count_rate, app=-, method=*' }
    panels:
      !include shared/identity/identity_row.yaml
