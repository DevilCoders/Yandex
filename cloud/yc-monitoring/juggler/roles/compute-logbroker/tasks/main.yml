---
- name: 'juggler_check : compute-logbroker-logs'
  tags: ["compute-logbroker"]
  juggler_check: ''
  vars:
    telegram_chat_id: ComputeAPIDuty
    check_tags: ['yc-compute', 'yc-compute-node-team']
  args: "{{ silent_check | hash_merge(default_timed_limits_nodata_ok, item) }}"
  with_items:
    - service: topic-compute-journald
      children:
        - { type: HOST, host: "yc_compute_logbroker_{{ env }}", service: topic-journald-messages-read }
        - { type: HOST, host: "yc_compute_logbroker_{{ env }}", service: topic-journald-messages-written }
        - { type: HOST, host: "yc_compute_logbroker_{{ env }}", service: topic-journald-partition-max-write-quota-used }
        - { type: HOST, host: "yc_compute_logbroker_{{ env }}", service: topic-journald-partition-write-quota-wait }
        - { type: HOST, host: "yc_compute_logbroker_{{ env }}", service: topic-journald-read-time-lag }
        - { type: HOST, host: "yc_compute_logbroker_{{ env }}", service: topic-journald-time-since-last-read }
        - { type: HOST, host: "yc_compute_logbroker_{{ env }}", service: topic-journald-topic-write-quota-wait }
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/compute-api/logbroker/main
            type: wiki
