# NOTE(k-zaitsev): when moving from "silent" remember that this check is behind kikimr lock
- name: 'juggler_check: e2e-cross-az'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, e2e_behind_lock) }}"
  with_items:
    - service: e2e-cross-az
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/e2e/e2e-cross-az
            type: wiki

- name: 'juggler_check: e2e-static-routes-new'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, e2e_behind_lock) }}"
  with_items:
    - service: e2e-static-routes-new
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/e2e/e2e-static-routes-new
            type: wiki
      ttl: 1800
      refresh_time: 120

- name: 'juggler_check: e2e-static-routes-perm'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  with_items:
    - service: e2e-static-routes-perm
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/e2e/e2e-static-routes-perm
            type: wiki

- name: 'juggler_check: e2e-security-groups-new'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, e2e_behind_lock) }}"
  with_items:
    - service: e2e-security-groups-new
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/e2e/e2e-security-groups-new
            type: wiki
      ttl: 3000
      refresh_time: 120

- name: 'juggler_check: e2e-security-groups-perm'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  with_items:
    - service: e2e-security-groups-perm
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/e2e/e2e-security-groups-perm
            type: wiki

- name: 'juggler_check: e2e-security-groups-crossaz'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, e2e_behind_lock) }}"
  with_items:
    - service: e2e-security-groups-crossaz
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/e2e/e2e-security-groups-crossaz
            type: wiki
      ttl: 3000
      refresh_time: 120

- name: 'juggler_check: oct-virtual-networks-count'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  with_items:
    - service: oct-virtual-networks-count
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/oct-virtual-networks-count
            type: wiki

- name: 'juggler_check: oct-threads-count'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  with_items:
    - service: oct-threads-count
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/oct-threads-count
            type: wiki

- name: 'juggler_check: oct-cassandra-read-latency'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  with_items:
    - service: oct-cassandra-read-latency
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/oct-cassandra-read-latency
            type: wiki

- name: 'juggler_check : contrail-dns-missing-files-autorecovery'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  with_items:
    - service: contrail-dns-missing-files-autorecovery
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/contrail-dns-missing-files-autorecovery
            type: wiki
      ttl: 1800
      refresh_time: 30
  when: env not in ["prod", "preprod", "testing"]  # contrail-dns and contrail-named are disabled there in favor of new DNS service

- name: 'juggler_check: contrail-rabbitmq-sync'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  with_items:
    - service: contrail-rabbitmq-sync
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/contrail-rabbitmq-sync
            type: wiki

- name: 'juggler_check: vpc-solomon-quotas-oct-head'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  with_items:
    - service: vpc-solomon-quotas-oct-head
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/shared/solomon-quotas
            type: wiki
      refresh_time: 60
      ttl: 180
      children:
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_sys-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_e2e-timing-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_juggler-events-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_oct_cassandra-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_oct_confdb_objects-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_oct_head_cgroup_metrics-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_oct_named_metrics-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_oct_named_reconfig-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_contrail_api-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_oct_rabbitmq-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_oct_control-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_oct_oct_control_routes-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_vpc-control_vpc-control-solomon-quotas
          type: HOST
        - host: "vpc-infra-{{ env }}"
          service: yandexcloud_cloud_{{ env }}_vpc-control_sys-solomon-quotas
          type: HOST

- name: 'juggler_check : contrail-api-errors'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits_nodata_ok) }}"
  with_items:
    - service: contrail-api-errors
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/contrail-api-errors
            type: wiki

- name: 'juggler_check : contrail-api-response-{size,time}'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  with_items:
    - service: contrail-api-response-size
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/contrail-api-response-size
            type: wiki
    - service: contrail-api-response-time
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/contrail-api-response-time
            type: wiki

- name: 'juggler_check : *-cpu, *-memory'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  tags: ["vpc-cpu-memory"]
  with_items:
    - service: cassandra-cpu
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-cpu
            type: wiki
    - service: contrail-api-cpu
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-cpu
            type: wiki
    - service: contrail-discovery-cpu
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-cpu
            type: wiki
    - service: contrail-schema-cpu
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-cpu
            type: wiki
    - service: ifmap-cpu
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-cpu
            type: wiki
    - service: rabbitmq-server-cpu
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-cpu
            type: wiki
    - service: zookeeper-cpu
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-cpu
            type: wiki
    - service: cassandra-memory
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-memory
            type: wiki
    - service: contrail-api-memory
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-memory
            type: wiki
    - service: contrail-discovery-memory
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-memory
            type: wiki
    - service: contrail-schema-memory
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-memory
            type: wiki
    - service: ifmap-memory
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-memory
            type: wiki
    - service: rabbitmq-server-memory
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-memory
            type: wiki
    - service: zookeeper-memory
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-memory
            type: wiki

- name: 'juggler_check : *-cpu, *-memory for contrail-web-ui'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  tags: ["vpc-cpu-memory"]
  with_items:
    - service: contrail-webui-jobserver-cpu
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-cpu
            type: wiki
    - service: contrail-webui-webserver-cpu
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-cpu
            type: wiki
    - service: contrail-webui-jobserver-memory
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-memory
            type: wiki
    - service: contrail-webui-webserver-memory
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/service-memory
            type: wiki

- name: 'juggler_check: e2e-network-isolation'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, default_timed_limits) }}"
  tags: ["e2e-network-isolation"]
  with_items:
    - service: e2e-network-isolation
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/e2e/e2e-network-isolation
            type: wiki
      ttl: 1800
      refresh_time: 120

- name: 'juggler_check : e2e-tests-network-smtp'
  juggler_check: ''
  args: "{{ silent_check | hash_merge(item, e2e_behind_lock) }}"
  with_items:
    - service: e2e-tests-network-smtp
      meta:
        urls:
          - title: "[?] Инструкция по алерту"
            url: https://docs.yandex-team.ru/yc-monitoring/overlay/e2e/e2e-tests-network-smtp
            type: wiki
      ttl: 900
      refresh_time: 300
