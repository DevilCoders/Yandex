{% import "vars.yaml" as vars with context %}

menu: "[KMS] Alerts"
menu_type: admin
api_path: /alerts/
tags: ["kms"]

entities:
  kms_api_errors:
    template: kms_api_errors.j2
    project_id: "{{ vars.project_id }}"
    exclude:
      env: [main]
  kms_data_alive_instances:
    template: kms_alive_instances.j2
    project_id: "{{ vars.project_id }}"
    exclude:
      env: [main]
    context:
      instances: 3
      service_name: "DATA"
      host_regex: "cluster-data-all"
  kms_control_alive_instances:
    template: kms_alive_instances.j2
    project_id: "{{ vars.project_id }}"
    exclude:
      env: [main]
    context:
      instances: 3
      service_name: "CONTROL"
      host_regex: "cluster-control-all"
  kms_data_cache_age:
    template: kms_data_cache_age.j2
    project_id: "{{ vars.project_id }}"
    exclude:
      env: [ main ]
    context:
      age_limit: "4000"
      host_regex: "kms-data-*|dpl-*"
  kms_special_keys_age:
    template: kms_special_keys_age.j2
    project_id: "{{ vars.project_id }}"
    exclude:
      env: [ main ]
    context:
      age_limit: "4000"
      host_regex: "kms-*|dpl-*|cpl-*"
  kms_low_disk_space:
    template: kms_low_disk_space.j2
    project_id: "{{ vars.project_id }}"
    exclude:
      env: [ main ]
    context:
      memory_limit: "5e9"
      host_regex: "kms-*|dpl-*|cpl-*"
      mount_point: "/etc/hosts"
  kms_sla_internal_09:
    template: kms_sla_internal.j2
    project_id: "{{ vars.project_id }}"
    exclude:
      env: [ main ]
    context:
      sla_limit: "0.9"
      host_regex: "kms-data-*|dpl-*"
  kms_sla_internal_09995:
    template: kms_sla_internal.j2
    project_id: "{{ vars.project_id }}"
    exclude:
      env: [ main ]
    context:
      sla_limit: "0.9995"
      host_regex: "kms-data-*|dpl-*"
  kms_failed_tasks:
    template: kms_failed_tasks.j2
    project_id: "{{ vars.project_id }}"
    exclude:
      env: [ main ]
