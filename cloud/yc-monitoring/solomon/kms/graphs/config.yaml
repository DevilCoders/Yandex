{% import "vars.yaml" as vars with context %}

menu: "[KMS] Graphs"
menu_type: preview
api_path: /graphs/
tags: ["kms"]
entities:
  grpc_api_requests_rps:
    project_id: "{{vars.project_id}}"
    id: "kms_grpc_api_requests_rps"
    template: grpc_api_requests_rps.j2
    context:
      name: "KMS grpc api requests rps"
  grpc_api_duration:
    project_id: "{{vars.project_id}}"
    id: "kms_grpc_api_duration"
    template: grpc_api_duration.j2
    context:
      name: "KMS grpc api duration"
  grpc_api_statuses_4xx:
    project_id: "{{vars.project_id}}"
    id: "kms_grpc_api_statuses_4xx"
    template: grpc_api_statuses_4xx.j2
    context:
      name: "KMS grpc api statuses 4xx"
  grpc_api_statuses_5xx:
    project_id: "{{vars.project_id}}"
    id: "kms_grpc_api_statuses_5xx"
    template: grpc_api_statuses_5xx.j2
    context:
      name: "KMS grpc api statuses 5xx"
  grpc_api_statuses_errors:
    project_id: "{{vars.project_id}}"
    id: "grpc_api_statuses_errors"
    template: grpc_api_statuses_errors.j2
    context:
      name: "KMS grpc api statuses errors"
  private_envoy_l7_rps:
    project_id: "{{vars.project_id}}"
    id: "private_envoy_l7_rps"
    template: private_l7_rps.j2
    context:
      name: "KMS Private L7 rps"
  private_envoy_l7_errors:
    project_id: "{{vars.project_id}}"
    id: "private_envoy_l7_errors"
    template: private_l7_errors.j2
    context:
      name: "KMS Private L7 errors"
  private_envoy_l7_upstream_errors:
    project_id: "{{vars.project_id}}"
    id: "private_envoy_l7_upstream_errors"
    template: private_l7_upstream_errors.j2
    context:
      name: "KMS Private L7 upstream errors"
  private_envoy_l7_duration:
    project_id: "{{vars.project_id}}"
    id: "private_envoy_l7_duration"
    template: l7_duration.j2
    context:
      name: "KMS Private L7 duration"
      service: "private_envoy"
  private_envoy_l7_hc_failures:
    project_id: "{{vars.project_id}}"
    id: "private_envoy_l7_hc_failures"
    template: private_l7_hc_failures.j2
    context:
      name: "KMS Private L7 Failed Healthcheck"
  public_envoy_l7_rps:
    project_id: "{{vars.project_id}}"
    id: "public_envoy_l7_rps"
    template: public_l7_rps.j2
    context:
      name: "KMS Public L7 rps"
  public_envoy_l7_errors:
    project_id: "{{vars.project_id}}"
    id: "public_envoy_l7_errors"
    template: public_l7_errors.j2
    context:
      name: "KMS Public L7 errors"
  public_envoy_l7_duration:
    project_id: "{{vars.project_id}}"
    id: "public_envoy_l7_duration"
    template: l7_duration.j2
    context:
      name: "KMS Public L7 duration"
      service: "public_envoy"
  special_keys_refresh_fails:
    project_id: "{{vars.project_id}}"
    id: "special_keys_refresh_fails"
    template: sum_group_by_max.j2
    context:
      name: "Special Keys Refresh Fails"
      sensor: "specialKeysRefreshFail"
      title: "fails"
  special_keys_refresh_seconds:
    project_id: "{{vars.project_id}}"
    id: "special_keys_refresh_seconds"
    template: max_group_by_max.j2
    context:
      name: "Special Keys Refresh Time"
      sensor: "specialKeysRefreshSeconds"
      title: "refresh_seconds"
  special_keys_seconds_since_last_refresh:
    project_id: "{{vars.project_id}}"
    id: "special_keys_seconds_since_last_refresh"
    template: max_group_by_max.j2
    context:
      name: "Time Since Last Special Keys Refresh"
      sensor: "specialKeysSecondsSinceLastRefresh"
      title: "elapsed_seconds"
  encryption_validate_failed:
    project_id: "{{vars.project_id}}"
    id: "encryption_validate_failed"
    template: group_by_max.j2
    context:
      name: "Encryption Validation Failed"
      sensor: "encryptionValidateFailed"
      title: "[[host]]"
  decrypt_plaintext_size:
    project_id: "{{vars.project_id}}"
    id: "decrypt_plaintext_size"
    template: group_by_avg.j2
    context:
      name: "Decrypt Plaintext Size"
      sensor: "decryptPlaintextSize"
      title: "[[bin]]-[[cipher]]"
  encrypt_plaintext_size:
    project_id: "{{vars.project_id}}"
    id: "encrypt_plaintext_size"
    template: group_by_avg.j2
    context:
      name: "Encrypt Plaintext Size"
      sensor: "encryptPlaintextSize"
      title: "[[bin]]-[[cipher]]"
  instance_healthy:
    project_id: "{{vars.project_id}}"
    id: "instance_healthy"
    template: group_by_avg.j2
    context:
      name: "Instances"
      sensor: "instanceHealthy"
      title: "[[host]]"
      stack: "true"
  jvm_memory:
    project_id: "{{vars.project_id}}"
    id: "jvm_memory"
    template: jvm_memory.j2
    context:
      name: "JVM Memory"
  jvm_memory_sum:
    project_id: "{{vars.project_id}}"
    id: "jvm_memory_sum"
    template: jvm_memory_sum.j2
    context:
      name: "Sum JVM Memory"
  jvm_threads:
    project_id: "{{vars.project_id}}"
    id: "jvm_threads"
    template: jvm_threads.j2
    context:
      name: "JVM Threads"
  load_average:
    project_id: "{{vars.project_id}}"
    id: "load_average"
    template: load_average.j2
    context:
      name: "Load Average (1min)"
      title: "la"
      aggregation: "max"
  load_average_sum:
    project_id: "{{vars.project_id}}"
    id: "load_average_sum"
    template: load_average.j2
    context:
      name: "Sum Load Average (1min)"
      title: "la"
      aggregation: "sum"
  sum_cpu_time:
    project_id: "{{vars.project_id}}"
    id: "sum_cpu_time"
    template: sum_cpu_time.j2
    context:
      name: "Sum CPU Time"
  memory:
    project_id: "{{vars.project_id}}"
    id: "memory"
    template: memory.j2
    context:
      name: "Memory"
      aggregation: "max"
  memory_sum:
    project_id: "{{vars.project_id}}"
    id: "memory_sum"
    template: memory.j2
    context:
      name: "Sum Memory"
      aggregation: "sum"
  network_bytes:
    project_id: "{{vars.project_id}}"
    id: "network_bytes"
    template: network.j2
    context:
      name: "Network Bytes"
      path_suffix: "Bytes"
  network_packets:
    project_id: "{{vars.project_id}}"
    id: "network_packets"
    template: network.j2
    context:
      name: "Network Packets"
      path_suffix: "Packets"
  network_drop:
    project_id: "{{vars.project_id}}"
    id: "network_drop"
    template: network.j2
    context:
      name: "Network Drop"
      path_suffix: "Drop"
  network_errs:
    project_id: "{{vars.project_id}}"
    id: "network_errs"
    template: network.j2
    context:
      name: "Network Errs"
      path_suffix: "Errs"
  file_descriptors:
    project_id: "{{vars.project_id}}"
    id: "file_descriptors"
    template: max_group_by_max.j2
    context:
      name: "File Descriptors"
      sensor: "process_open_fds"
      title: "max FDs"
  free_space:
    project_id: "{{vars.project_id}}"
    id: "free_space"
    template: free_space.j2
    context:
      name: "Free Space"
  io_bytes:
    project_id: "{{vars.project_id}}"
    id: "io_bytes"
    template: io_disks.j2
    context:
      name: "IO Bytes"
      path_suffix: "Bytes"
      aggregation: "sum"
  io_ops:
    project_id: "{{vars.project_id}}"
    id: "io_ops"
    template: io_disks.j2
    context:
      name: "IO Ops"
      path_suffix: "s"
      aggregation: "sum"
  io_waits:
    project_id: "{{vars.project_id}}"
    id: "io_waits"
    template: io_disks.j2
    context:
      name: "IO Waits (msec)"
      path_suffix: "WaitMillisec"
      aggregation: "max"
  major_page_faults:
    project_id: "{{vars.project_id}}"
    id: "major_page_faults"
    template: major_page_faults.j2
    context:
      name: "Major Page Faults"
  key_rotate_job_errors:
    project_id: "{{vars.project_id}}"
    id: "key_rotate_job_errors"
    template: key_rotate_job_errors.j2
    context:
      name: "Key Rotate Job Errors"
