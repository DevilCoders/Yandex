{% import "vars.yaml" as vars with context %}

api_path: /services/

entities:

  # Старый сервис. Данные в него не загружаются с декабря 2021.
  # network_resources:
  #   template: ../../base/service.j2
  #   context:
  #     aggrRules:
  #      - { cond: "host=*", target: "host=cluster" }

  service:
    project_id: "{{vars.project_id}}"
    template: ../../base/service.j2
    context:
      solomon_agent_project_id: kms
      interval: 15
      ttl_days: 60
      aggrRules:
        - { cond: "host=*", target: "host=cluster" }
        - { cond: "host=kms-control*|cpl*", target: "host=cluster-control-all" }
        - { cond: "host=kms-data*|dpl*", target: "host=cluster-data-all" }
        - { cond: "host=root-kms*", target: "method=cluster-root-all" }
  sys:
    project_id: "{{vars.project_id}}"
    template: ../../base/service.j2
    context:
      solomon_agent_project_id: kms
      interval: 15
      ttl_days: 60
      aggrRules:
        - { cond: "host=*", target: "host=cluster" }
        - { cond: "host=kms-control*|cpl*", target: "host=cluster-control-all" }
        - { cond: "host=kms-data*|dpl*", target: "host=cluster-data-all" }
        - { cond: "host=root-kms*", target: "method=cluster-root-all" }
  private_envoy:
    project_id: "{{vars.project_id}}"
    template: ../../base/service.j2
    context:
      solomon_agent_project_id: kms
      interval: 15
      ttl_days: 60
      aggrRules:
        - { cond: "host=*", target: "host=cluster" }
        - { cond: "host=kms-control*|cpl*", target: "host=cluster-control-all" }
        - { cond: "host=kms-data*|dpl*", target: "host=cluster-data-all" }
  public_envoy:
    project_id: "{{vars.project_id}}"
    template: ../../base/service.j2
    context:
      solomon_agent_project_id: kms
      interval: 15
      ttl_days: 60
      aggrRules:
        - { cond: "host=*", target: "host=cluster" }
        - { cond: "host=kms-control*|cpl*", target: "host=cluster-control-all" }
        - { cond: "host=kms-data*|dpl*", target: "host=cluster-data-all" }
