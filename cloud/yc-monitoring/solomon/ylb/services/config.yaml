menu: "[YLB] Services"
menu_type: admin
api_path: /services/
tags: ["ylb"]
entities:
  billbro:
    template: ../../base/service.j2
    id: "ylb_{{ env }}_billbro"
    context:
      id_override: "ylb_{{ env }}_billbro"
      aggrRules:
        - {cond: "host=*", target: "host=cluster"}
        - cond: "host=*,cloud_id=*,folder_id=*,balancer_id=*,ip=*,name=vip_bytes"
          target: "host=cluster,cloud_id=all,folder_id=all,balancer_id=all,ip=all,name=vip_bytes"
        - cond: "host=*,cloud_id=*,folder_id=*,balancer_id=*,ip=*,name=vip_packets"
          target: "host=cluster,cloud_id=all,folder_id=all,balancer_id=all,ip=all,name=vip_packets"

  healthcheck_ctrl_proxy:
    template: ../../base/service.j2
    id: "ylb_{{ env }}_healthcheck_ctrl_proxy"
    context:
      id_override: "ylb_{{ env }}_healthcheck_ctrl_proxy"
      service: hc-ctrl-proxy
      interval: 15
      aggrRules:
        - {cond: "host=*", target: "host=cluster"}
        - {cond: "name=ydb_*,bin=*", target: "name=ydb_total_requests"}

  healthcheck_ctrl:
    template: ../../base/service.j2
    id: "ylb_{{ env }}_healthcheck_ctrl"
    context:
      id_override: "ylb_{{ env }}_healthcheck_ctrl"
      service: hc-ctrl
      interval: 15
      aggrRules:
        - {cond: "host=*", target: "host=cluster"}
        - {cond: "name=ydb_*,bin=*", target: "name=ydb_total_requests"}

  healthcheck_node:
    template: ../../base/service.j2
    id: "ylb_{{ env }}_healthcheck_node"
    context:
      id_override: "ylb_{{ env }}_healthcheck_node"
      service: hc-node
      interval: 15
      aggrRules:
        - {cond: "host=*", target: "host=cluster"}

  loadbalancer_ctrl:
    template: ../../base/service.j2
    id: "ylb_{{ env }}_loadbalancer_ctrl"
    context:
      id_override: "ylb_{{ env }}_loadbalancer_ctrl"
      service: lb-ctrl
      interval: 15
      aggrRules:
        - {cond: "host=*", target: "host=cluster"}
        - {cond: "name=ydb_*,bin=*", target: "name=ydb_total_requests"}

  loadbalancer_node:
    template: ../../base/service.j2
    id: "ylb_{{ env }}_loadbalancer_node"
    context:
      id_override: "ylb_{{ env }}_loadbalancer_node"
      interval: 15
      aggrRules:
        - {cond: "host=*", target: "host=cluster"}

  logsync:
    template: ../../base/service.j2
    id: "ylb_{{ env }}_logsync"
    context:
      id_override: "ylb_{{ env }}_logsync"
      interval: 15
      aggrRules:
        - {cond: "host=*", target: "host=cluster"}

  juggler-events:
    template: ../../base/service.j2
    id: "ylb_{{ env }}_juggler_events"
    context:
      id_override: "ylb_{{ env }}_juggler_events"
      interval: 15
      aggrRules:
        - {cond: "host=*", target: "host=cluster"}

  clickphite:
    template: ../../base/service.j2
    id: "ylb_{{ env }}_clickphite"
    context:
      push: True
      id_override: "ylb_{{ env }}_clickphite"
      aggrRules:
        - {cond: "host=*", target: "host=cluster"}

  sys:
    template: ../../base/service.j2
    id: "ylb_{{ env }}_sys"
    context:
      id_override: "ylb_{{ env }}_sys"
      aggrRules:
        - {cond: "host=*", target: "host=cluster"}
