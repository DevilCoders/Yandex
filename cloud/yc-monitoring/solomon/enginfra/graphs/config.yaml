{% from "local_lb/map.jinja" import locallb_graphs %}
menu: "[EngInfra] Graphs"
menu_type: preview
api_path: /graphs/
tags: ["enginfra"]
entities:
  # Sysinfo /proc based graphs
  xds-provider-system-mem:
    template: ../../common/graphs/system/mem.json.j2
    context: &graphs_defaults
      team: EngInfra
      prefix: xds-provider
  xds-provider-system-cpu:
    template: ../../common/graphs/system/cpu.json.j2
    context:
      <<: *graphs_defaults
  xds-provider-system-io:
    template: ../../common/graphs/system/io.json.j2
    context:
      <<: *graphs_defaults
  xds-provider-system-net:
    template: ../../common/graphs/system/net.json.j2
    context:
      <<: *graphs_defaults
  xds-provider-system-disk:
    template: ../../common/graphs/system/disk.json.j2
    context:
      <<: *graphs_defaults
  xds-provider-services-status:
    template: xds-provider/services.j2
    id: "enginfra-xds-provider-grpc-services-statuses"
    context:
      name: "Services per status on host "
      hide_no_data: "true"
      downsampling_func: "LAST"
  xds-provider-grpc-streams-count:
    template: xds-provider/grpc-streams-count.j2
    id: "enginfra-xds-provider-grpc-stream-count"
    context:
      name: "GRPC streams count "
      hide_no_data: "true"
      downsampling_func: "LAST"
  xds-provider-get-cluster-errors:
    template: xds-provider/get-cluster-errors.j2
    id: "enginfra-xds-provider-get-cluster-errs"
    context:
      name: "GetCluster errors "
      hide_no_data: "true"
      downsampling_func: "LAST"
  xds-provider-dns:
    template: xds-provider/dns.j2
    id: "enginfra-xds-provider-dns"
    context:
      name: "DNS requests "
      hide_no_data: "true"
      downsampling_func: "LAST"
  xds-provider-snapshot-events-timings:
    template: xds-provider/snapshot-events-timings.j2
    id: "enginfra-xds-provider-snapshot-events-timings"
    context:
      name: "XDS snapshot events"
      hide_no_data: "true"
      downsampling_func: "LAST"
  xds-provider-xds-requests-timings:
    template: xds-provider/xds-requests-timings.j2
    id: "enginfra-xds-provider-xds-requests-timings"
    context:
      name: "XDS requests timings "
      hide_no_data: "true"
      downsampling_func: "LAST"
  goapp-allocated:
    template: goapp_allocated.j2
    id: "enginfra-goapp-allocated"
    context:
      name: "Go Heap Allocated "
      hide_no_data: "true"
      downsampling_func: "LAST"
  goapp-memstats-in-use:
    template: goapp_memstats_in_use_bytes.j2
    id: "enginfra-goapp-memstats-in-use-bytes"
    context:
      name: "Go in use bytes"
      hide_no_data: "true"
      downsampling_func: "LAST"
  goapp-goroutines:
    template: goapp_goroutines.j2
    id: "enginfra-goapp-goroutines"
    context:
      name: "Goroutines"
      hide_no_data: "true"
      downsampling_func: "LAST"
  goapp-os-threads:
    template: goapp_os_threads.j2
    id: "enginfra-goapp-os-threads"
    context:
      name: "Go OS threads"
      hide_no_data: "true"
      downsampling_func: "LAST"
  goapp-open-fds:
    template: goapp_open_fds.j2
    id: "enginfra-goapp-open-fds"
    context:
      name: "Go open FDs"
      hide_no_data: "true"
      downsampling_func: "LAST"
{% for graph in locallb_graphs %}
  {{ graph['id'] }}:
    template: local_lb/{{ graph['template'] }}
    id: {{ graph['id'] }}
    context:
      name: {{ graph['name'] }}
      hide_no_data: "{{ graph.get('hide_no_data', True) }}"
      downsampling_func: "{{ graph.get('downsampling_func', LAST) }}"
{% endfor %}
