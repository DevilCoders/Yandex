{% import "vars.yaml" as vars with context %}

api_path: /services/

entities:

  # Старый сервис. Данные в него не загружаются с декабря 2021.
  # network_resources:
  #   template: ../../base/service.j2
  #   context:
  #     aggrRules:
  #      - { cond: "host=*", target: "host=cluster" }

  service:
    project_id: "{{vars.project_id}}"
    template: ../../base/service.j2
    context:
      solomon_agent_project_id: "{{vars.project_id}}"
      interval: 15
      ttl_days: 60
      aggrRules:
        - { cond: "host=*", target: "host=cluster" }
        - { cond: "host=cpl*", target: "host=cluster-cpl" }
        - { cond: "host=dpl*", target: "host=cluster-dpl" }
        - { cond: "host=validation*", target: "host=cluster-validation" }
  sys:
    project_id: "{{vars.project_id}}"
    template: ../../base/service.j2
    context:
      solomon_agent_project_id: "{{vars.project_id}}"
      interval: 15
      ttl_days: 60
      aggrRules:
        - { cond: "host=*", target: "host=cluster" }
        - { cond: "host=cpl*", target: "host=cluster-cpl" }
        - { cond: "host=dpl*", target: "host=cluster-dpl" }
        - { cond: "host=validation*", target: "host=cluster-validation" }
  private_envoy:
    project_id: "{{vars.project_id}}"
    template: ../../base/service.j2
    context:
      solomon_agent_project_id: "{{vars.project_id}}"
      interval: 15
      ttl_days: 60
      aggrRules:
        - { cond: "host=*", target: "host=cluster" }
        - { cond: "host=cpl*", target: "host=cluster-cpl" }
        - { cond: "host=dpl*", target: "host=cluster-dpl" }
  public_envoy:
    project_id: "{{vars.project_id}}"
    template: ../../base/service.j2
    context:
      solomon_agent_project_id: "{{vars.project_id}}"
      interval: 15
      ttl_days: 60
      aggrRules:
        - { cond: "host=*", target: "host=cluster" }
        - { cond: "host=cpl*", target: "host=cluster-cpl" }
        - { cond: "host=dpl*", target: "host=cluster-dpl" }
