menu: "[Infra] Alerts"
menu_type: admin
api_path: /alerts/
tags: ["infra"]
entities:
  solomon_quotas:
    template: solomon_quotas.j2
    exclude:
      env: &hw_labs [hw.*lab]
    context:
      notificationChannels: ["bootstrap-diff", "juggler"]

{# Add alert for common roles #}
{% for br in ['loadbalancer-node', 'cgw-dc', 'cgw-nat', 'cgw', 'cgw-ipv4', 'cgw-ipv6', 'oct-head'] %}
{%- set salt_role = br %}
{%- if br == 'oct-head' %}
{%-     set salt_role = 'oct_head' %}
{%- elif br in ['cgw', 'cgw-ipv4', 'cgw-ipv6'] %}
{%-     set salt_role = 'cloudgate' %}
{%- endif %}
{%- if salt_role not in ['loadbalancer-node', 'cloudgate'] %}
  deploy_{{ br }}_common:
    template: salt_versions.j2
    exclude:
      env: *hw_labs
    context:
      bootstrap_role: "{{ br }}"
      salt_role: "common"
      notificationChannels: ["bootstrap-diff", "juggler"]
{%- endif %}
  deploy_{{ br }}:
    template: salt_versions.j2
    exclude:
      env: *hw_labs
    context:
      bootstrap_role: "{{ br }}"
      salt_role: "{{ salt_role }}"
      notificationChannels: ["bootstrap-diff", "juggler"]
{% endfor %}

  sli_e2e_connectivity_sas:
    template: sli_e2e.j2
    exclude:
      env: *hw_labs
    context:
      dc: "sas"
      e2e_type: "permnet-connectivity"
      red_threshold: 5
      yellow_threshold: 1

  sli_e2e_connectivity_myt:
    template: sli_e2e.j2
    exclude:
      env: *hw_labs
    context:
      dc: "myt"
      e2e_type: "permnet-connectivity"
      red_threshold: 5
      yellow_threshold: 1

  sli_e2e_connectivity_vla:
    template: sli_e2e.j2
    exclude:
      env: *hw_labs
    context:
      dc: "vla"
      e2e_type: "permnet-connectivity"
      red_threshold: 5
      yellow_threshold: 1

  sli_e2e_dns_sas:
    template: sli_e2e.j2
    exclude:
      env: *hw_labs
    context:
      dc: "sas"
      e2e_type: "permnet-dns"
      red_threshold: 5
      yellow_threshold: 1

  sli_e2e_dns_myt:
    template: sli_e2e.j2
    exclude:
      env: *hw_labs
    context:
      dc: "myt"
      e2e_type: "permnet-dns"
      red_threshold: 5
      yellow_threshold: 1

  sli_e2e_dns_vla:
    template: sli_e2e.j2
    exclude:
      env: *hw_labs
    context:
      dc: "vla"
      e2e_type: "permnet-dns"
      red_threshold: 5
      yellow_threshold: 1

  sli_metadata_vla:
    template: sli_metadata_error_rate.j2
    exclude:
      env: *hw_labs
    context:
      dc: "vla"
      red_threshold: 5
      yellow_threshold: 1

  sli_metadata_sas:
    template: sli_metadata_error_rate.j2
    exclude:
      env: *hw_labs
    context:
      dc: "sas"
      red_threshold: 5
      yellow_threshold: 1

  sli_metadata_myt:
    template: sli_metadata_error_rate.j2
    exclude:
      env: *hw_labs
    context:
      dc: "myt"
      red_threshold: 5
      yellow_threshold: 1
