{% import "vars.yaml" as vars with context %}

api_path: /clusters/
entities:
  global:
    template: ../../base/cluster.j2
    project_id: "{{ vars.project_id }}"
    context:
      id_override: "{{ vars.project_id }}_{{ env }}_global"
      name_override: "{{ env }}_global"
      use_fqdn: false
      sensorsTtlDays: 7
      cloud_dns:
        israel:
        - "*.global.ydb-infra.yandexcloud.co.il"
      host_urls:
        israel:
        - url: "ydb-cp.private-api.yandexcloud.co.il:8768/instances?location_id={{ env }}_global"

  {% for az in vars.zones_by_env.get(env, zones_by_env[env]) %}
  {{ az.prefix }}:
    template: ../../base/cluster.j2
    project_id: "{{ vars.project_id }}"
    context:
      id_override: "{{ vars.project_id }}_{{ env }}_{{ az.prefix }}"
      name_override: "{{ env }}_{{ az.prefix }}"
      use_fqdn: false
      sensorsTtlDays: 7
      cloud_dns:
        israel:
        - "*.{{ az.prefix }}.ydb-infra.yandexcloud.co.il"
      host_urls:
        israel:
        - url: "ydb-cp.private-api.yandexcloud.co.il:8768/instances?location_id={{ env }}_{{ az.prefix }}"
  {% endfor %}

