[Алерт в Juggler](https://juggler.yandex-team.ru/aggregate_checks/?query=service%3Dgpu-gpud)

## gpu-gpud
Проверяет, что сервис `yc-gpu-gpud` работает и может принимать запросы.

## Подробности
Сервис `yc-gpu-gpud` используется на машинах с GPU.

Если сервис `yc-gpu-gpud` не работает, то на этом узле невозможны запуск
сервиса `yc-compute-node` на машинах с GPU. Сервис `yc-gpu-gpud` предоставляет
всю информацию о железе связанном с GPU и интерконнектами(список GPU, NVLink
если присутствует, ethernet/infiniband интерконнекты). Так же сервис
обеспечивает подготовку и мониторинг GPU-специфичного железа.

Если сервис `yc-gpu-gpud` сломан, то нужно выполнить экстренное расселение
узла.

## Диагностика
Если сервис остановлен (по статусу `systemd`), то безопасно попробовать его
запустить. Если сервис не запустился, то читай раздел "Если сломалось".

На текущий момент всегда отдает "Ok" на попытку обратиться к демону gpud.
Любые другие сообщения в Juggler говорят о том, что сервис недопуступен 
и можно переходить к разделу "Если сломалось".

Так же существует утилита yc-gpu-gpudctl:

1) `sudo yc-gpu-gpudctl gpu list` - выводит список видеокарт, которые нашел
демон.

2) `sudo yc-gpu-gpudctl nvswitch list` - выводит список NVidia свитчей.

3) `sudo yc-gpu-gpudctl interconnect list` - выводит список ethernet и
infiniband карт для интерконнекта.

4) `sudo yc-gpu-gpudctl mmio-filter list` - выводит список фильтров для
регионов памяти BAR0 карт. Используется для запрета доступа из гостя к
управляющим регистрам.

5) `sudo yc-gpu-gpudctl group list` - выводим список возможных группировок
для конфигураций GPU + интерконнект.

6) `sudo yc-gpu-gpudctl health-check` - проверка работоспобоности демона.

## Если сломалось

Если сервис `yc-gpu-gpud` не запускается, то

1) Выключить узел в планировщике

2) Посмотреть лог `sudo journalctl -u yc-gpu-gpud`

3) Пока пойти к команде `yc-gpu`, т.к. идут первые шаги по миграции и
пока ничего не ломалось. Позже раздел будет обновлен.
