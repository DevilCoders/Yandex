# ydb-resources-datashard
[Алерт в Juggler](https://juggler.yandex-team.ru/aggregate_checks/?project=&query=service%3Dydb-resources-datashard)

## Проверяет
- Уровень потребления CPU отдельными шардами таблиц. По умолчаниию, оповещение срабатывает в Warning, если существует шард, потребление CPU которым достигает 60% и в Critical при достижении порога 80%.

## Подробности
- Звонящий.
- В алерте host и database определяет где именно произошло превышение.
- При достижении порогов запросы к таблице с перегруженными шардами могут начать деградировать, возникать ошибки Timeout и Overloaded, может ухудшиться время отлика запросов.

## Что делать
При достижении порогов можно предпринять следующие действия:
- Повысить пороги срабатывания оповещения.
- Настроить политику шардирования таблицы, включить автоматическое шардирование. по нагрузке и размеру.
- Уменьшить нагрузку на базу данных, уменьшить поток запросов.
- С помощью доступных средств мониторинга, системных таблиц проанализировать запросы и оптимизировать иx. Например, можно получить план запроса и далее оптимизировать паттерны доступа, такие как FullScan.

## Ссылки
- [Jaeger](https://jaeger.private-api.ycp.cloud.yandex.net)
- [Справочник метрик](https://ydb.yandex-team.ru/docs/troubleshooting/monitoring)
