# ydb-tx-rw-latency-p99
[Алерт в Juggler](https://juggler.yandex-team.ru/aggregate_checks/?project=&query=service%3Dydb-tx-rw-latency-p99)

## Проверяет
- Уровень 99 перцентиля задержек транзакций в зависимости от типа транзакции (Read Only, Read-Write, Write Only). По умолчаниию, оповещения срабатывает в Warning, если задержки транзакций в 99 перцеентиле превышают 1000 миллисекунд для Read Only транзакций и 3000 миллисекунд для Write Only и Read-Write транзакций. В Critical оповещение срабатывает, если задержки транзакций в 99 перцентиле превышают 3000 миллисекунд для Read Only транзакций и 5000 миллисекунд для Write Only и Read-Write транзакций.

## Подробности
- Звонящий.
- В алерте host и database определяет где именно произошло превышение.
- При достижении порогов запросы к таблице с перегруженными шардами могут начать деградировать, возникать ошибки Timeout и Overloaded, может ухудшиться время отлика запросов.

## Что делать
При достижении порогов можно предпринять следующие действия:
- Настроить политику шардирования таблицы, включить автоматическое шардирование по нагрузке и размеру.
- Уменьшить нагрузку на базу данных, уменьшить поток запросов.
- С помощью доступных средств мониторинга, системных таблиц проанализировать запросы и оптимизировать иx. Например, можно получить план запроса и далее оптимизировать паттерны доступа, такие как FullScan.

## Ссылки
- [Jaeger](https://jaeger.private-api.ycp.cloud.yandex.net)
- [Справочник метрик](https://ydb.yandex-team.ru/docs/troubleshooting/monitoring)
