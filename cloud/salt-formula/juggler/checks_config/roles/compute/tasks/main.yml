---
- include: tasks/common.yml
  tags: ["infra"]
  host: "yc_infra_compute_{{ env }}"
  vars:
    telegram_chat_id: InfraDuty
    custom_notifications: "{{ telegram_notification }}"

- include: tasks/nbs.yml
  tags: ["infra"]
  host: "yc_infra_compute_{{ env }}"
  vars:
    telegram_chat_id: InfraDuty
    check_tags: ['{{ common_tag }}-nbs', '{{ common_tag }}-infra', '{{ common_tag }}-{{ env }}-nbs' ]

- include: tasks/common_hardware.yml
  tags: ["infra"]
  host: "yc_infra_compute_{{ env }}"
  vars:
    telegram_chat_id: InfraDuty
    check_tags: ['{{ common_tag }}-hw', '{{ common_tag }}-infra', '{{ common_tag }}-{{ env }}-hw']

- include: kikimr.yml
  tags: ["infra"]
  host: "yc_infra_compute_{{ env }}"
  vars:
    telegram_chat_id: InfraDuty
    check_tags: ['{{ common_tag }}-kikimr', '{{ common_tag }}-infra', '{{ common_tag }}-{{ env }}-kikimr']

- include: kikimr_storage.yml
  tags: ["infra"]
  host: "yc_infra_compute_{{ env }}"
  vars:
    telegram_chat_id: InfraDuty
    check_tags: ['{{ common_tag }}-kikimr', '{{ common_tag }}-infra', '{{ common_tag }}-{{ env }}-kikimr']

- include: push-client.yml
  tags: ["infra"]
  host: "yc_infra_compute_{{ env }}"
  vars:
    telegram_chat_id: InfraDuty
    check_tags: ['{{ common_tag }}-common']

- include: compute-node.yml
  tags: ["compute"]
  vars:
    telegram_chat_id: ComputeDuty
    check_tags: ['{{ common_tag }}-compute', '{{ common_tag }}-{{ env }}-compute']

- include: serialproxy.yml
  tags: ["compute"]
  vars:
    telegram_chat_id: ComputeDuty
    check_tags: ['{{ common_tag }}-{{ env }}-compute' ]

- include: compute-metadata.yml
  tags: ["compute"]
  vars:
    telegram_chat_id: ComputeDuty
    check_tags: ['{{ common_tag }}-{{ env }}-compute' ]

- include: network.yml
  tags: ["network"]
  vars:
    check_tags: ['{{ common_tag }}-network']
    host: "yc_network_compute_{{ env }}"

- include: staging-network.yml
  tags: ["network"]

