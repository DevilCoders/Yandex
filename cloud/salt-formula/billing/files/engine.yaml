{%- from "billing/map.jinja" import kikimr_endpoint, billing with context %}

main:
  billing_account_cardinality: {{ billing.billing_account_cardinality }}

{% if billing.get('engine', {}).get('queue', {}) %}
queue:
  name: {{ billing.engine.get('name', 'engine') }}
  backend: {{ billing.engine.queue.backend }}
  default_partitions: {{ billing.engine.queue.get('default_partitions', 15) }}
  queue_partitions: {{ billing.engine.queue.get('queue_partitions', {}) }}
  worker: {{ billing.engine.queue.get('worker', []) }}
{% endif %}

endpoints:
  kikimr:
    billing:
      host: {{ kikimr_endpoint.host }}
      root: {{ kikimr_endpoint.root }}
      enable_batching: False

logbroker:
  source_type:  {{ billing.engine.logbroker.source_type }}
  topics: {{ billing.engine.logbroker.topics }}
  client_id: {{ billing.logbroker.client_id }}
  host: {{ billing.logbroker.host }}:{{ billing.logbroker.port }}
