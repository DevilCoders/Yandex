{% set additional_delay_after_checks = pillar['oct']['restart']['additional_delay_after_checks_sec'] %}
{% set vhost_dev = pillar['network']['interfaces']['vhost_dev'] %}  {# E.g., "vhost0" #}

contrail-api:
  checks: [contrail-api, contrail-ifmap]
  wait_for_checks_timeout_sec: 120
  additional_delay_after_checks_sec: {{ additional_delay_after_checks['contrail-api'] }}
  restart_command: systemctl restart contrail-api
  need_restart_check: contrail-api

contrail-control:
  checks: [contrail-control]
  wait_for_checks_timeout_sec: 120
  additional_delay_after_checks_sec: {{ additional_delay_after_checks['contrail-control'] }}
  restart_command: systemctl restart contrail-control
  need_restart_check: contrail-control

contrail-discovery:
  checks: [contrail-discovery]
  wait_for_checks_timeout_sec: 120
  additional_delay_after_checks_sec: {{ additional_delay_after_checks['contrail-discovery'] }}
  restart_command: systemctl restart contrail-discovery
  need_restart_check: contrail-discovery

contrail-schema:
  checks: []
  wait_for_checks_timeout_sec: 0
  additional_delay_after_checks_sec: {{ additional_delay_after_checks['contrail-schema'] }}
  restart_command: systemctl restart contrail-schema
  need_restart_check: contrail-schema

contrail-dns:
  checks: [contrail-dns]
  wait_for_checks_timeout_sec: 300
  additional_delay_after_checks_sec: {{ additional_delay_after_checks['contrail-dns'] }}
  restart_command: /etc/yc/safe-restart/restart-dns-named.sh
  need_restart_check: contrail-dns

contrail-vrouter-agent:
  checks: [contrail-vrouter-agent, e2e-tests-permnet-connectivity, e2e-tests-permnet-dns]
  wait_for_checks_timeout_sec: 300
  additional_delay_after_checks_sec: {{ additional_delay_after_checks['contrail-vrouter-agent'] }}
  restart_command: /etc/yc/safe-restart/restart-vrouter-agent.sh
  need_restart_check: contrail-vrouter-agent

contrail-vrouter-agent-and-kernel-module:
  checks: [contrail-vrouter-agent, e2e-tests-permnet-connectivity, e2e-tests-permnet-dns]
  wait_for_checks_timeout_sec: 300
  additional_delay_after_checks_sec: {{ additional_delay_after_checks['contrail-vrouter-agent-and-kernel-module'] }}
  restart_command: /etc/yc/safe-restart/restart-vrouter-agent-and-kernel-module.sh {{ vhost_dev }}
  need_restart_check: contrail-vrouter-agent
