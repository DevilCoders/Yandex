{%- set default_log_settings = salt['pillar.get']('oct:log_settings:defaults') -%}
{%- set log_settings = salt['pillar.get']('oct:log_settings:contrail-collector', default=default_log_settings, merge=True) -%}
#
# Copyright (c) 2014 Juniper Networks, Inc. All rights reserved.
#
# Collector configuration options
#

[DEFAULT]
# Everything in this section is optional

# Time-to-live in hours of the various data stored by collector into
# cassandra
# analytics_configaudit_ttl, if not set (or set to -1), defaults to analytics_data_ttl
# analytics_statsdata_ttl, if not set (or set to -1), defaults to analytics_data_ttl
# analytics_flowdata_ttl, if not set (or set to -1), defaults to analytics_statsdata_ttl
#
#analytics_data_ttl=48
#analytics_config_audit_ttl=2160
#analytics_statistics_ttl=168
#analytics_flow_ttl=2

# IP address and port to be used to connect to cassandra.
# Multiple IP:port strings separated by space can be provided
cassandra_server_list={% for server in oct_collect_servers %}{{ grains['cluster_map']['hosts'][server]['ipv4']['addr'] }}:9042 {% endfor %}

# List of IP:port for ZooKeeper servers, comma-separated
zookeeper_server_list={% for server in oct_db_servers %}{{ grains['cluster_map']['hosts'][server]['ipv4']['addr'] }}:2181{% if not loop.last %},{% endif %}{% endfor %}

# List of IP:port for kafka brokers
kafka_broker_list={% for server in oct_collect_servers %}{{ grains['cluster_map']['hosts'][server]['ipv4']['addr'] }}:9092 {% endfor %}
partitions=30

hostip={{ ipv4 }}
hostname={{ grains['nodename'] }}

# Http server port for inspecting collector state (useful for debugging)
# http_server_port=8089

log_level={{ log_settings['sandesh_level'] }}
log_local=1
log_property_file=/etc/contrail/contrail-collector_log4cplus.properties
# log_category must be unset or set to empty string to log all messages
# log_category=


# TCP and UDP ports to listen on for receiving syslog messages. -1 to disable.
# syslog_port=514

# UDP port to listen on for receiving sFlow messages. -1 to disable.
# sflow_port=6343

# UDP port to listen on for receiving ipfix messages. -1 to disable.
# ipfix_port=4739

# Sandesh send rate limit can be used to throttle system logs transmitted per
# second. System logs are dropped if the sending rate is exceeded
sandesh_send_rate_limit={{ log_settings['sandesh_send_rate_limit'] }}

[COLLECTOR]
# Everything in this section is optional

# Port to listen on for receiving Sandesh messages
port=8086

# IP address to bind to for listening
# server=0.0.0.0

# UDP port to listen on for receiving Google Protocol Buffer messages
# protobuf_port=3333

[DISCOVERY]
server=127.0.0.1
port=5998

[REDIS]
port=6379
# Many pieces assume Redis and collector run on the same IP. Be explicit.
server={{ ipv4 }}
