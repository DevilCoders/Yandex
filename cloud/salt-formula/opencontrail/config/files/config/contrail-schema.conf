{%- set default_log_settings = salt['pillar.get']('oct:log_settings:defaults') -%}
{%- set log_settings = salt['pillar.get']('oct:log_settings:contrail-schema', default=default_log_settings, merge=True) -%}
[DEFAULTS]
ifmap_server_ip={{ ipv4 }}
ifmap_server_port=8443
ifmap_username={{ salt['grains.get']("host", "")[-22:] }}-schema
ifmap_password={{ salt['grains.get']("host", "")[-22:] }}-schema
zk_server_ip={% for server in oct_db_servers %}{{ grains['cluster_map']['hosts'][server]['ipv4']['addr'] }}:2181{% if not loop.last %},{% endif %}{% endfor %}
cassandra_server_list={% for server in oct_db_servers %}{{ grains['cluster_map']['hosts'][server]['ipv4']['addr'] }}:9160 {% endfor %}
disc_server_ip=127.0.0.1
disc_server_port=5998

log_level={{ log_settings['sandesh_level'] }}
# Set log_local to empty string to disable, setting to 0 or False doesn't work
log_local=1
# log_category must be unset or set to empty string to log all messages
#log_category=
# log_file is not used in the logger class below
#log_file=
logger_class=pysandesh.sandesh_logger.SandeshConfigLogger
logging_conf=/etc/contrail/contrail-schema.logging.conf
sandesh_send_rate_limit={{ log_settings['sandesh_send_rate_limit'] }}

rabbit_server={% for server in oct_db_servers %}{{ grains['cluster_map']['hosts'][server]['ipv4']['addr'] }}{% if not loop.last %},{% endif %}{% endfor %}
rabbit_ha_mode=True
rabbit_port=5672
rabbit_user=contrail
rabbit_password=contrail


#[SECURITY]
#use_certs=False
#keyfile=/etc/contrail/ssl/private_keys/schema_xfer_key.pem
#certfile=/etc/contrail/ssl/certs/schema_xfer.pem
#ca_certs=/etc/contrail/ssl/certs/ca.pem

