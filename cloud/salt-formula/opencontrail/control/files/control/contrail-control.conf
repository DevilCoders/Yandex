{%- set default_log_settings = salt['pillar.get']('oct:log_settings:defaults') -%}
{%- set log_settings = salt['pillar.get']('oct:log_settings:contrail-control', default=default_log_settings, merge=True) -%}
#
# Copyright (c) 2014 Juniper Networks, Inc. All rights reserved.
#
# Control-node configuration options
#

[DEFAULT]
# bgp_config_file=bgp_config.xml
# bgp_port=179
# collectors= # Provided by discovery server
# gr_helper_bgp_disable=0
# gr_helper_xmpp_disable=0
  hostip={{ ipv4 }}
# hostname= # Retrieved from gethostname() or `hostname -s` equivalent
  hostname={{ grains['nodename'] }}
# http_server_port=8083
# log_disable=0

log_level={{ log_settings['sandesh_level'] }}
log_local=1
log_property_file=/etc/contrail/contrail-control_log4cplus.properties
# log_category must be unset or set to empty string to log all messages
# log_category=
sandesh_send_rate_limit={{ log_settings['sandesh_send_rate_limit'] }}

# test_mode=0
# xmpp_server_port=5269

[DISCOVERY]
  port=5998
  server=127.0.0.1

[IFMAP]
  certs_store=
  password={{ salt['grains.get']("host", "")[-22:] }}-ctl
  user={{ salt['grains.get']("host", "")[-22:] }}-ctl
# server_url= # Provided by discovery server, e.g. https://127.0.0.1:8443

# stale_entries_cleanup_timeout should be bigger than time of pulling whole graph from ifmap
# See https://st.yandex-team.ru/CLOUD-20992#5ccff7fb00ee790020138e4a
  stale_entries_cleanup_timeout=300 # in seconds.

# end_of_rib_timeout=10 # in seconds
# peer_response_wait_time=60 # in seconds

[SANDESH]
# sandesh_ssl_enable=false
# introspect_ssl_enable=false
# sandesh_keyfile=/etc/contrail/ssl/private/server-privkey.pem
# sandesh_certfile=/etc/contrail/ssl/certs/server.pem
# sandesh_ca_cert=/etc/contrail/ssl/certs/ca-cert.pem
