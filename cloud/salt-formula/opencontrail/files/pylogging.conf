{%- set default_log_settings = salt['pillar.get']('oct:log_settings:defaults') -%}
{%- set log_settings = salt['pillar.get']('oct:log_settings:' + service_name, default=default_log_settings, merge=True) -%}
[loggers]
keys=root,contrail_logger

[handlers]
keys=root_handler,contrail_handler

[formatters]
keys=contrail_formatter

[logger_root]
level={{ log_settings['pylogger_level'] }}
handlers=root_handler

[logger_contrail_logger]
level={{ log_settings['pylogger_level'] }}
handlers=contrail_handler
qualname={{ service_name }}
propagate=1

[handler_root_handler]
class=StreamHandler
level={{ log_settings['pylogger_level'] }}
formatter=contrail_formatter
args=()

[handler_contrail_handler]
class=logging.handlers.RotatingFileHandler
args=('{{ log_file }}', 'a', {{ log_settings['file_size_mb'] * 1024**2 }}, {{ log_settings['files_count'] }})
formatter=contrail_formatter

[formatter_contrail_formatter]
format=timestamp:asctime,level:levelname,message:message
class=cfgm_common.logging_utils.JsonFormatter

