{%- set default_log_settings = salt['pillar.get']('oct:log_settings:defaults') -%}
{%- set log_settings = salt['pillar.get']('oct:log_settings:' + service_name, default=default_log_settings, merge=True) -%}

{%- set format='{"timestamp": "%D{%Y-%m-%d %H:%M:%S,%q}", "level": "%p", "message": "%m"}' -%}

log4cplus.rootLogger={{ log_settings['log4cplus_level'] }}, contrail_appender

log4cplus.appender.contrail_appender=log4cplus::RollingFileAppender
log4cplus.appender.contrail_appender.File={{ log_file }}
log4cplus.appender.contrail_appender.Append=true
log4cplus.appender.contrail_appender.ImmediateFlush=true
log4cplus.appender.contrail_appender.layout=log4cplus::EscapedPatternLayout
log4cplus.appender.contrail_appender.layout.ConversionPattern={{ format }}%n
log4cplus.appender.contrail_appender.MaxFileSize={{ log_settings['file_size_mb'] * 1024**2 }}
log4cplus.appender.contrail_appender.MaxBackupIndex={{ log_settings['files_count'] }}
