{%- set flow_log_dir = salt['pillar.get']('oct:flow_log:directory') -%}
{%- set collector_settings = salt['pillar.get']('network-billing-collector') -%}
expected_proc_count: {{ collector_settings.worker_count + 2 }}
unprocessed_flows_glob: '{{ flow_log_dir }}/flow.log*'
processing_flows_glob: '{{ flow_log_dir }}/.flow.log*'

# If we didn't process some file within two wake ups of collector,
# then we're probably overloaded and that's a problem
max_processing_delay: {{ collector_settings.wake_up_sec * 2 }} # seconds
max_processing_time: {{ collector_settings.wake_up_sec * 2 }} # seconds
accounting_log: {{ collector_settings.accounting.log_file }}
antifraud_log: {{ collector_settings.antifraud.log_file }}
max_push_client_lag_accounting: 1048576 # bytes = 1 MB
max_push_client_lag_antifraud: 524288000 # bytes = 500 MB

# max time between writing to accounting_log/antifraud_log and commit in LogBroker
max_send_delay: 900 # seconds = 15 minutes

# 2 hours without writing anything to accounting_log/antifraud_log...
# ...seems at least strange
max_time_without_output: 7200 # seconds = 2 hours
