{%- set lb_endpoints = grains['cluster_map']['load_balancer']['endpoints'] -%}
{%- set hostname = grains['nodename'] -%}
{%- set base_role = grains['cluster_map']['hosts'][hostname]['base_role'] -%}

public_server:
  address: "[::]:9600"
control_server:
  address: "localhost:9601"
control_gateway:
  address: "localhost:9602"
access_service_client:
  address: "{{ lb_endpoints.access_service_grpc.host }}:{{ lb_endpoints.access_service_grpc.port }}"
{% if base_role != 'cloudwm' %}
  tls: true
{% endif %}
qemu_registry:
  max_instances: 1000
  max_connections: 5
  state_dir: /var/lib/yc/serialproxy
