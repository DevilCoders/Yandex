$get_product_name_by_service_name = ($service_name) -> {
    RETURN CASE
    WHEN $service_name IN ('mdb', 'mdb.pg', 'mdb.mongo', 'mdb.mysql', 'mdb.ch', 'mdb.redis', 'mdb.dataproc', 'datalens') THEN 'Data Storage and Analytics'
    WHEN $service_name IN ('compute', 'cloud_network', 'nlb', 'mk8s', 'marketplace', 'cr') THEN 'Infrastructure'
    WHEN $service_name IN ('ymq', 'monitoring', 'ydb', 'storage', 'iot', 'serverless', 'kms') THEN 'Cloud Native'
    WHEN $service_name IN ('cloud_ai') THEN 'ML and AI'
    WHEN $service_name IN ('support') THEN 'Support'
    ELSE 'UNKNOWN' END;
};
-- please, keep alphabetical order by alias

$result = (SELECT
    id                                          AS id,
    name                                        AS name,
    description                                 AS description,
    $get_product_name_by_service_name(name)     AS product_name,


    FROM $service_table
);