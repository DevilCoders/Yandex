config-monitoring-pkgver (0.21) unstable; urgency=medium

  * setup ethernets before call salt

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Tue, 03 Nov 2020 11:59:36 +0300

config-monitoring-pkgver (0.20) unstable; urgency=medium

  * add bootstrap_start_time to state file

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Fri, 23 Oct 2020 14:24:06 +0300

config-monitoring-pkgver (0.19) unstable; urgency=medium

  * add more info

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Thu, 22 Oct 2020 15:23:24 +0300

config-monitoring-pkgver (0.18) unstable; urgency=medium

  * TRAFFIC-11161 add /var/run/state file

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Wed, 21 Oct 2020 20:02:57 +0300

config-monitoring-pkgver (0.17) unstable; urgency=medium

  * STRM-3107 NOCDEV-3309 stop cron only if autosetup_needed

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Tue, 20 Oct 2020 12:52:35 +0300

config-monitoring-pkgver (0.15) unstable; urgency=medium

  * run fixhosts only on first boot

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Tue, 29 Sep 2020 14:33:26 +0300

config-monitoring-pkgver (0.14) unstable; urgency=medium

  * run fixhosts service befor salt

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Tue, 29 Sep 2020 12:56:13 +0300

config-monitoring-pkgver (0.13) unstable; urgency=medium

  * run unbound.service forcibly

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Mon, 16 Mar 2020 11:43:48 +0300

config-monitoring-pkgver (0.12) unstable; urgency=medium

  * set TimeoutSec to infinity

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Wed, 11 Mar 2020 11:32:33 +0300

config-monitoring-pkgver (0.11) unstable; urgency=medium

  * stop cron before pkgver
  * restart statbox first time

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Tue, 28 Jan 2020 16:27:01 +0300

config-monitoring-pkgver (0.10) unstable; urgency=medium

  * install ubic before run pkgver.pl
  * do not log enabled services
  * fix success greeting

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Tue, 28 Jan 2020 12:39:24 +0300

config-monitoring-pkgver (0.9) unstable; urgency=medium

  * unmask unbound.service (from yandex-unbound package)

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Mon, 27 Jan 2020 17:58:54 +0300

config-monitoring-pkgver (0.8) unstable; urgency=medium

  * start strm-status only after first install
  * always start ubic

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Thu, 23 Jan 2020 11:13:28 +0300

config-monitoring-pkgver (0.7) unstable; urgency=medium

  * added conditions to use systemd

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Mon, 20 Jan 2020 10:49:52 +0300

config-monitoring-pkgver (0.6) unstable; urgency=medium

  * add conductor tag pkgver_autosetup_salt_update_https: salt_update use https for git clone 

 -- Ilya Anisimov <uhriab@yandex-team.ru>  Tue, 15 Jan 2019 15:21:23 +0000

config-monitoring-pkgver (0.5) unstable; urgency=low

  * added conductor tag pkgver_autosetup_salt_retcode: failed if smth going wrong during salt-call
  * added conductor tag pkgver_autosetup_retry: repeat update attempts (apt-get && salt-call) if previous attempt returned an error
  https://wiki.yandex-team.ru/conductor/tags/

 -- Evgeniy Zaitsev <eightn@yandex-team.ru>  Tue, 15 Jan 2019 11:30:18 +0300

config-monitoring-pkgver (0.4.59) unstable; urgency=low

  * godmode (--force-yes) via conductor tag pkgver_godmode

 -- Evgeniy Zaitsev <eightn@yandex-team.ru>  Tue, 09 Oct 2018 22:14:18 +0300

config-monitoring-pkgver (0.4.58) unstable; urgency=medium

  * pkgver --forceyes 

 -- Ilya Anisimov <uhriab@yandex-team.ru>  Tue, 09 Oct 2018 18:50:28 +0000

config-monitoring-pkgver (0.4.57) unstable; urgency=medium

  * Return success for just-created pkgver differences so that fresh installs
    do not trigger warnings

 -- Pavel Pushkarev <paulus@yandex-team.ru>  Mon, 02 Apr 2018 17:07:30 +0300

config-monitoring-pkgver (0.4.56) unstable; urgency=low

  * s/ubic_hostname/pkgver_hostname/ --> /etc/pkgver_hostname (thinx broom@ for review)

 -- Evgeniy Zaitsev <eightn@yandex-team.ru>  Tue, 06 Feb 2018 13:59:37 +0300

config-monitoring-pkgver (0.4.55) unstable; urgency=low

  * try to get hostname from config file /etc/ubic_hostname (if available) --- needs for regional strm caches like %strm-stream-ext

 -- Evgeniy Zaitsev <eightn@yandex-team.ru>  Tue, 06 Feb 2018 13:48:39 +0300

config-monitoring-pkgver (0.4.54) unstable; urgency=medium

  * also check for running monrun salt-state script

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Tue, 30 Jan 2018 17:32:17 +0300

config-monitoring-pkgver (0.4.53) unstable; urgency=medium

  * check for running salt-call before run salt_update
  * send mail only if /usr/sbin/sendmail exist

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Tue, 30 Jan 2018 17:20:10 +0300

config-monitoring-pkgver (0.4.52) unstable; urgency=medium

  * avoid salt-call conflict with monrun checks

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Mon, 29 Jan 2018 00:04:39 +0300

config-monitoring-pkgver (0.4.51) unstable; urgency=medium

  * run autosetup checks after checking lost groups

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Tue, 12 Dec 2017 13:25:20 +0300

config-monitoring-pkgver (0.4.50) unstable; urgency=medium

  * non stop retries (eightn@ wants)

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Mon, 04 Dec 2017 17:06:51 +0300

config-monitoring-pkgver (0.4.49) unstable; urgency=medium

  * Added retries for is_lost detection

 -- Arkady L. Shane <ashejn@yandex-team.ru>  Mon, 04 Dec 2017 15:13:16 +0300

config-monitoring-pkgver (0.4.48) precise; urgency=low

  * fix bug: runlevel has been changed to 2 even if pkgver failed
  * add subject to emails

 -- Anna Martynova <broom@yandex-team.ru>  Tue, 12 Sep 2017 13:26:27 +0300

config-monitoring-pkgver (0.4.47) precise; urgency=low

  * run salt in pkgver_autosetup mode after installing packages

 -- Anna Martynova <broom@yandex-team.ru>  Tue, 04 Apr 2017 12:32:04 +0300

config-monitoring-pkgver (0.4.46) unstable; urgency=medium

  * do check if file is readable before read

 -- Sergey Vidishev <sergeyv@yandex-team.ru>  Fri, 24 Mar 2017 15:39:09 +0300

config-monitoring-pkgver (0.4.45) unstable; urgency=medium

  * add support for ignore directory as well as ignore file

 -- Sergey Vidishev <sergeyv@yandex-team.ru>  Fri, 24 Mar 2017 14:41:55 +0300

config-monitoring-pkgver (0.4.44) unstable; urgency=medium

  * removed trash from rules added by me in prev version

 -- Arsenev Alexey <aarseniev@yandex-team.ru>  Mon, 20 Mar 2017 18:26:23 +0300

config-monitoring-pkgver (0.4.43) unstable; urgency=medium

  * runlevel: crit only if not ( OK_RUNLEVEL <= cur_runlevel < 6 )

 -- Arsenev Alexey <aarseniev@yandex-team.ru>  Mon, 20 Mar 2017 18:01:57 +0300

config-monitoring-pkgver (0.4.42) testing; urgency=medium

  * Builded package with data.tar.gz instead of data.tar.xz

 -- Evgeny Avramenko <kanst9@yandex-team.ru>  Tue, 02 Aug 2016 16:59:53 +0300

config-monitoring-pkgver (0.4.41) testing; urgency=medium

  * pkgver.pl: added /etc/yandex-pkgver-ignore-file

 -- Evgeny Avramenko <kanst9@yandex-team.ru>  Tue, 02 Aug 2016 15:41:32 +0300

config-monitoring-pkgver (0.4.40) testing; urgency=low

  * when -a or -i get hosts tag from non-cached api

 -- Sergey Vidishev <sergeyv@yandex-team.ru>  Tue, 19 Apr 2016 18:32:47 +0300

config-monitoring-pkgver (0.4.39) testing; urgency=low

  * add -a (--actual) option to force use non-cached api

 -- Sergey Vidishev <sergeyv@yandex-team.ru>  Tue, 19 Apr 2016 18:26:14 +0300

config-monitoring-pkgver (0.4.38) testing; urgency=low

  * added /etc/yandex-pkgver-ignore support for ignore (file with names of packages to ignore, line by line)

 -- Nikita Tatarinov <ntatarinov@yandex-team.ru>  Thu, 11 Feb 2016 17:03:29 +0300

config-monitoring-pkgver (0.4.37) testing; urgency=low
  
  * pkgver.pl: param '-s|skip' added - list packages separted by comma.
    Skip package installation (which useful for debug, migration etc)

 -- Alexey Simakov <asimakov@yandex-team.ru>  Wed, 26 Apr 2015 19:20:20 +0300

config-monitoring-pkgver (0.4.36) testing; urgency=low

  * add rhel version

 -- Evgeny Avramenko <kanst9@yandex-team.ru>  Wed, 08 Apr 2015 19:17:26 +0300

config-monitoring-pkgver (0.4.35) testing; urgency=low

  * pkgver.pl: param -c added (for check only) 
  * pkgver.pl: param -godmode added (for automatically downgrade) 

 -- Nikita Tatarinov <ntatarinov@yandex-team.ru>  Wed, 30 Jul 2014 21:28:06 +0400

config-monitoring-pkgver (0.4.34) testing; urgency=low

  * Avoid curl bug

 -- Sergey Vidishev <sergeyv@yandex-team.ru>  Wed, 23 Jul 2014 15:50:24 +0400

config-monitoring-pkgver (0.4.33) testing; urgency=low

  * pkgver.init.d: add retry connecting to conductor

 -- Sergey Vidishev <sergeyv@yandex-team.ru>  Wed, 09 Jul 2014 16:03:23 +0400

config-monitoring-pkgver (0.4.32) testing; urgency=low

  * pkgver.pl: fix coding style

 -- Sergey Vidishev <sergeyv@yandex-team.ru>  Fri, 27 Jun 2014 18:38:57 +0400

config-monitoring-pkgver (0.4.31) testing; urgency=low

  * monrun_pkgver.sh: sleep only under snaked job run

 -- Sergey Vidishev <sergeyv@yandex-team.ru>  Fri, 06 Jun 2014 13:58:54 +0400

config-monitoring-pkgver (0.4.30) testing; urgency=low

  * monrun_pkgver.sh: add random sleep to monrun_pkgver.sh in range (0..60) seconds
  * monrun_pkgver.conf: increase execution_timeout to 90 seconds

 -- Sergey Vidishev <sergeyv@yandex-team.ru>  Wed, 28 May 2014 12:44:15 +0400

config-monitoring-pkgver (0.4.29) testing; urgency=low

  * Use hostname_long instead of hostname

 -- Sergey Vidishev <sergeyv@yandex-team.ru>  Mon, 19 May 2014 21:19:01 +0400

config-monitoring-pkgver (0.4.28) unstable; urgency=low

  * Builded package with data.tar.gz instead of data.tar.xz (Ubuntu 14.xx default compression, wich not work in lucid for example)

 -- Aleksei Arsenev <aarseniev@yandex-team.ru>  Wed, 07 May 2014 20:24:16 +0400

config-monitoring-pkgver (0.4.27) testing; urgency=low

  * LWP::Simple fix for ipv6-only hosts

 -- Sergey Vidishev <sergeyv@yandex-team.ru>  Wed, 07 May 2014 18:22:40 +0400

config-monitoring-pkgver (0.4.26) precise; urgency=low

  * use "api" in install mode (in other cases use "api-cached")

 -- Anna Martynova <broom@yandex-team.ru>  Fri, 22 Nov 2013 16:53:50 +0400

config-monitoring-pkgver (0.4.25) unstable; urgency=low

  * Use Conductor "api-cached" call instead of "api". 

 -- Denis Zaitsev <dzaitsev@yandex-team.ru>  Tue, 12 Nov 2013 21:42:14 +0400

config-monitoring-pkgver (0.4.24) unstable; urgency=low

  * minor fix 

 -- Mikhail Petrov <azalio@yandex-team.ru>  Fri, 30 Aug 2013 20:04:30 +0400

config-monitoring-pkgver (0.4.23) unstable; urgency=low

  * Если указать опцию -n или -noy, apt-get install будет вызываться без опции -y 

 -- Mikhail Petrov <azalio@yandex-team.ru>  Fri, 30 Aug 2013 19:52:28 +0400

config-monitoring-pkgver (0.4.22) unstable; urgency=low

  * Не умирать, если http://c.yandex-team.ru/api-cached/get_host_tags/$hostname вернул пустой лист тегов. 

 -- Mikhail Petrov <azalio@yandex-team.ru>  Fri, 30 Aug 2013 15:12:33 +0400

config-monitoring-pkgver (0.4.21) unstable; urgency=low

  * Non-maintainer upload.
  * Если в кондукторе выставлен тэг pkgver_new_is_ok, то pkgver.pl будет считать, что все ок, если версия пакета в системе
  больше, чем версия в кондукторе.

 -- Mikhail Petrov <azalio@yandex-team.ru>  Fri, 30 Aug 2013 14:56:26 +0400

config-monitoring-pkgver (0.4.20) unstable; urgency=low

  * repo packages are determined by conductor tag 'repo'

 -- Anna Martynova <broom@yandex-team.ru>  Fri, 07 Jun 2013 12:36:59 +0400

config-monitoring-pkgver (0.4.19) unstable; urgency=low

  * added check for group "*lost" and reworked script a little

 -- Anna Martynova <broom@yandex-team.ru>  Wed, 15 May 2013 14:39:08 +0400

config-monitoring-pkgver (0.4.18) unstable; urgency=low

  * Fixed monitoring check: if snaked was started when runlevel was 1, it will
  always show runlevel 1 (because runlevel is saved in environment variable).

 -- Anna Martynova <broom@yandex-team.ru>  Mon, 29 Apr 2013 14:19:37 +0400

config-monitoring-pkgver (0.4.17) unstable; urgency=low

  * Write to motd about installation errors, too

 -- Anna Martynova <broom@yandex-team.ru>  Fri, 19 Apr 2013 17:51:20 +0400

config-monitoring-pkgver (0.4.16) unstable; urgency=low

  * If conductor is not available and the script doesn't know what to do (there is no local state), write about it to /etc/motd

 -- Anna Martynova <broom@yandex-team.ru>  Wed, 13 Mar 2013 16:07:10 +0400

config-monitoring-pkgver (0.4.15) unstable; urgency=low

  * ability to autosetup only with conductor flag pkgver_autosetup

 -- Evgeniy Zaitsev <eightn@yandex-team.ru>  Wed, 20 Feb 2013 23:46:49 +0400

config-monitoring-pkgver (0.4.14) unstable; urgency=low

  * add ability to install packages like yandex-conf-repo-XXX in first step

 -- Evgeniy Zaitsev <eightn@yandex-team.ru>  Fri, 08 Feb 2013 20:54:07 +0400

config-monitoring-pkgver (0.4.12) unstable; urgency=low

  * prepare to autosetup machines on startup (via dedicated lxc template only, on first step)
  * add runlevel monitoring
  * add init.d/pkgver script for autosetup system (on runlevel 1)
  
  * fix logrotate for pkgver

 -- Evgeniy Zaitsev <eightn@yandex-team.ru>  Thu, 07 Feb 2013 21:53:53 +0400

config-monitoring-pkgver (0.4.10) unstable; urgency=low

  * set error level when local package list/version not equal conductor list (thnx broom@ for patch)

 -- Evgeniy Zaitsev <eightn@yandex-team.ru>  Mon, 28 Jan 2013 14:33:34 +0400

config-monitoring-pkgver (0.4.9) unstable; urgency=low

  * Remove stderr output dpkg-query

 -- Andrey Trubachev <d3rp@yandex-team.ru>  Mon, 24 Sep 2012 15:03:02 +0400

config-monitoring-pkgver (0.4.8) unstable; urgency=low

  * +apt-get update before install

 -- Denis Zaitsev <dzaitsev@yandex-team.ru>  Wed, 18 Apr 2012 17:14:22 +0400

config-monitoring-pkgver (0.4.7) unstable; urgency=low

  * s/apt-get install/apt-get -y install

 -- Denis Zaitsev <dzaitsev@yandex-team.ru>  Wed, 18 Apr 2012 17:09:16 +0400

config-monitoring-pkgver (0.4.6) unstable; urgency=low

  * +curl to deps
  * CRIT only after 1.5 hours of uncostistency (before - WARN) 

 -- Denis Zaitsev <dzaitsev@yandex-team.ru>  Thu, 02 Feb 2012 22:46:26 +0400

config-monitoring-pkgver (0.4.5) unstable; urgency=low

  * changed LWP call to curl (LWP does not have IPv6 support)

 -- Denis Zaitsev <dzaitsev@yandex-team.ru>  Thu, 02 Feb 2012 21:56:57 +0400

config-monitoring-pkgver (0.4.4) unstable; urgency=low

  * optional -h|--host command line argument added

 -- Stanislav Pak <pakso@yandex-team.ru>  Wed, 14 Dec 2011 23:29:54 +0400

config-monitoring-pkgver (0.4.3) unstable; urgency=low

  * Increased execution timeout from 5 sec to 30.
  * Renamed package to config-monitoring-pkgver.

 -- Denis Zaitsev <dzaitsev@yandex-team.ru>  Wed, 12 Oct 2011 13:57:38 +0400

config-zabbix-pkgver (0.4.2) stable; urgency=low

  * spell fix
  * -y|--yes key added to install packages without question from pkgver

 -- Igor Shishkin <teran@yandex-team.ru>  Sat, 08 Oct 2011 17:56:19 +0400

config-zabbix-pkgver (0.4.1) stable; urgency=low

  * deleted zabbix config - monitoring moved to monrun now
  
 -- Denis Zaitsev <dzaitsev@yandex-team.ru>  Fri, 07 Oct 2011 19:04:11 +0400

config-zabbix-pkgver (0.4.0) stable; urgency=low

  * call dpkg-query once - much faster

 -- Vyacheslav Matjukhin (No comments) <mmcleric@yandex-team.ru>  Fri, 07 Oct 2011 18:46:55 +0400

config-zabbix-pkgver (0.3.9) stable; urgency=low

  * now ignore rc-status-packages (this packages already removed from system,
    but not purged)

 -- Evgeniy Zaitsev <eightn@yandex-team.ru>  Thu, 06 Oct 2011 18:34:34 +0400

config-zabbix-pkgver (0.3.8) stable; urgency=low

  * use new conductor api - https://jira.yandex-team.ru/browse/ADMINTOOLS-258
  * strict check packages version
  * also check upgrade-only packages
  * add juggler config

 -- Evgeniy Zaitsev <eightn@yandex-team.ru>  Fri, 16 Sep 2011 12:40:44 +0400

config-zabbix-pkgver (0.3.7) stable; urgency=low

  * now installed package must be _equal_ of maximum (of all repos) version

 -- Dmitry Yuzhin <navigator@yandex-team.ru>  Mon, 16 May 2011 18:07:27 +0400

config-zabbix-pkgver (0.3.6) stable; urgency=low

  * fix compare: now use Sort::Versions

 -- Dmitry Yuzhin <navigator@yandex-team.ru>  Thu, 03 Mar 2011 12:50:28 +0300

config-zabbix-pkgver (0.3.5) stable; urgency=low

  * fix output info about not installed packages

 -- Dmitry Yuzhin <navigator@yandex-team.ru>  Mon, 07 Feb 2011 12:13:03 +0300

config-zabbix-pkgver (0.3.4) stable; urgency=low

  * bugfix in awk

 -- Dmitry Yuzhin <navigator@yandex-team.ru>  Tue, 25 Jan 2011 16:55:10 +0300

config-zabbix-pkgver (0.3.3) stable; urgency=low

  * change apt-cache policy to dpkg-qwery to resolve locale problem

 -- Dmitry Yuzhin <navigator@yandex-team.ru>  Tue, 25 Jan 2011 16:04:10 +0300

config-zabbix-pkgver (0.3.2) stable; urgency=low

  * print "Couldn't get $url" to STDOUT

 -- Dmitry Yuzhin <navigator@yandex-team.ru>  Fri, 24 Dec 2010 19:18:59 +0300

config-zabbix-pkgver (0.3-1) stable; urgency=low

  * flush STDOUT

 -- Dmitry Yuzhin <navigator@yandex-team.ru>  Fri, 03 Dec 2010 15:14:59 +0300

config-zabbix-pkgver (0.3) stable; urgency=low

  * add option --install to pkgver.pl

 -- Dmitry Yuzhin <navigator@yandex-team.ru>  Thu, 02 Dec 2010 19:49:20 +0300

config-zabbix-pkgver (0.2) stable; urgency=low

  * add forgotten zabbix config

 -- Dmitry Yuzhin <navigator@yandex-team.ru>  Mon, 25 Oct 2010 19:38:54 +0400

config-zabbix-pkgver (0.1) stable; urgency=low

  * Initial release.

 -- Dmitry Yuzhin <navigator@yandex-team.ru>  Mon, 25 Oct 2010 18:22:55 +0400
