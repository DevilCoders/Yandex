#!/bin/sh

case $1 in
    configure)


	chmod 500 /etc/rsyncd_secrets
	chmod 600 /etc/rsyncd_secrets/rsyncd.secrets
	
	chmod 600 /etc/rsyncd_secrets/qafaq.pass
	
	#
	# add faqupdate_data rsync user
	#
	useradd -g users -s /bin/false -d /usr/lib/yandex/qafaq/data qafaq
	chown qafaq:users /usr/lib/yandex/qafaq/data

	#
	# add htarc rsync user
	#
	useradd -g users -s /bin/sh -d /opt/junk_from_htarcs htarc
	chmod 775 /opt/junk_from_htarcs
	chown htarc:users /opt/junk_from_htarcs

	#enable rsync
	sed -r "s/RSYNC_ENABLE=false/RSYNC_ENABLE=true/" -i /etc/default/rsync
	/etc/init.d/rsync restart
		    
    ;;
    
	abort-upgrade|abort-remove|abort-deconfigure)
    ;;

   	*)
       	echo "postinst called with unknown argument \`$1'" >&2
    ;;

esac
exit 0

