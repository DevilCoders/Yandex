upstream collection_upstream {
	 server localhost:8081;
}

server {
    listen 80;
    listen [::]:80;
    server_name collection.yandex.ru;
    server_name ~^(www\.)?collection\.[a-z0-9\-]+\.yandex\.ru$;
	server_name collection.yandex.ua collection.yandex.com www.collection.yandex.ua www.collection.yandex.com 
			www.collection.yandex.ru collection.ya.ru www.collection.ya.ru
				collections.yandex.ru www.collections.yandex.ru
				collection.yandex.by www.collection.yandex.by;

    access_log /var/log/nginx/access.log main;


# remove comments to use redirect to https
#
    location ~/ {
        rewrite ^(.*)$ https://$http_host$1 permanent;
    }

#        location / {
#                proxy_pass http://collection_upstream;
#                proxy_read_timeout                      180s;
#                proxy_set_header Host                   $host;
#                proxy_set_header X-Real-IP              $remote_addr;
#                proxy_set_header X-Service              collection;
#                proxy_set_header X-Forwarded-For              $remote_addr;

#        }
    }


server {
    server_name collection.yandex.ru;
    server_name ~^(www\.)?collection\.[a-z0-9\-]+\.yandex\.ru$;
    server_name collection.yandex.ua collection.yandex.com www.collection.yandex.ua www.collection.yandex.com 
			www.collection.yandex.ru collection.ya.ru www.collection.ya.ru
				collections.yandex.ru www.collections.yandex.ru
				collection.yandex.by www.collection.yandex.by;

    include listen_ssl;


    access_log /var/log/nginx/access.log main;

        location / {
                proxy_pass http://collection_upstream;
                proxy_read_timeout                      180s;
                proxy_set_header Host                   $host;
                proxy_set_header X-Real-IP              $remote_addr;
                proxy_set_header X-Service              collection;
                proxy_set_header X-Forwarded-For              $remote_addr;

        }



    }

