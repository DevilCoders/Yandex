upstream yaca_upstream {
	 server localhost:8081;
}

server {
        listen 80;
    listen [::]:80;
        server_name ~^(www\.)?(yaca|catalog|catalogue|katalog|cat)(\.\w*)?\.yandex\.(ru|ua|by)$;
        access_log /var/log/nginx/access.log main;

# remove comments to use redirect to https
#
#    location ~/ {
#        rewrite ^(.*)$ https://$http_host$1 permanent;
#    }

        location / {
                proxy_pass http://yaca_upstream;
                proxy_read_timeout                      180s;
                proxy_set_header Host                   $host;
                proxy_set_header X-Real-IP              $remote_addr;
                proxy_set_header X-Service              yaca.yandex.ru;
                proxy_set_header X-Forwarded-For              $remote_addr;

        }

}

server {
        server_name ~^(www\.)?(yaca|catalog|catalogue|katalog|cat)(\.\w*)?\.yandex\.(ru|ua|by)$;
        access_log /var/log/nginx/access.log main;
        include listen_ssl;


        location / {
                proxy_pass http://yaca_upstream;
                proxy_read_timeout                      180s;
                proxy_set_header Host                   $host;
                proxy_set_header X-Real-IP              $remote_addr;
                proxy_set_header X-Service              yaca.yandex.ru;
                proxy_set_header X-Forwarded-For              $remote_addr;

        }

}

