upstream shell_upstream {
	 server localhost:8081;
}

server {
    listen 80;
    listen [::]:80;
    server_name shell.yandex.ru;
    server_name shell.yandex.com.tr;
    server_name ~^shell(?<server>\.[\w-]+)\.yandex\.(ru|com\.tr)$;
    server_name shell.yandex.com;
    server_name ~^shell(?<server>\.[\w-]+)\.yandex\.com$;
    server_name www.shell.yandex.ru;
    server_name www.shell.yandex.com;
    server_name www.shell.yandex.com.tr;


    access_log /var/log/nginx/access.log main;


# remove comments to use redirect to https
#
    location ~/ {
        rewrite ^(.*)$ https://$http_host$1 permanent;
    }

#        location / {
#                proxy_pass http://shell_upstream;
#                proxy_read_timeout                      180s;
#                proxy_set_header Host                   $host;
#                proxy_set_header X-Real-IP              $remote_addr;
#                proxy_set_header X-Service                   shell;
#                proxy_set_header X-Forwarded-For              $remote_addr;
#        }





    }


server {
    server_name shell.yandex.ru;
    server_name shell.yandex.com.tr;
    server_name ~^shell(?<server>\.[\w-]+)\.yandex\.(ru|com\.tr)$;
    server_name shell.yandex.com;
    server_name ~^shell(?<server>\.[\w-]+)\.yandex\.com$;
    server_name www.shell.yandex.ru;
    server_name www.shell.yandex.com;
    server_name www.shell.yandex.com.tr;

    include listen_ssl;



    access_log /var/log/nginx/access.log main;

        location / {
                proxy_pass http://shell_upstream;
                proxy_read_timeout                      180s;
                proxy_set_header Host                   $host;
                proxy_set_header X-Real-IP              $remote_addr;
                proxy_set_header X-Service                   shell;
                proxy_set_header X-Forwarded-For              $remote_addr;

        }



    }
