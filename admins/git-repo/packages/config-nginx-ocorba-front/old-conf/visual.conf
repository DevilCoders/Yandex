upstream visual_upstream {
	 server localhost:8081;
}

server {
    listen 80;
    listen [::]:80;
    server_name visual.yandex.ru;
    server_name visual.yandex.ua;
    server_name visual.yandex.by;
    server_name visual.yandex.kz;
    server_name visual.yandex.com.tr;
#    server_name visual.ya-test.ru;
    server_name ~^visual(?<server>\.[\w-]+)\.yandex\.(ru|ua|by|kz|com\.tr)$;
    server_name www.visual.yandex.ru;
    server_name www.visual.yandex.ua;
    server_name www.visual.yandex.by;
    server_name www.visual.yandex.kz;
    server_name www.visual.yandex.com.tr;


    access_log /var/log/nginx/access.log main;

        location / {
                proxy_pass http://visual_upstream;
                proxy_read_timeout                      180s;
                proxy_set_header Host                   $host;
                proxy_set_header X-Real-IP              $remote_addr;
                proxy_set_header X-Service                   visual;
                proxy_set_header X-Forwarded-For              $remote_addr;

        }



    }

