upstream shad_upstream {
	 server localhost:8081;
}

server {
    listen 80;
    listen [::]:80;
	server_name yandex-school.ru shad.yandex.ru;
	server_name yandex-school.ua shad.yandex.ua;
#yandex-school.ua
	server_name shad.yandex.com.ua;
#yandex-school.com.ua
	server_name shad.yandex.by;
#yandex-school.by
	server_name ~^(shad|yandex-school)\.[a-z0-9\-]+\.yandex\.(ru|(com\.)?ua|by)$;


    access_log /var/log/nginx/access.log main;


# remove comments to use redirect to https
#
#    location ~/ {
#        rewrite ^(.*)$ https://$http_host$1 permanent;
#    }

        location / {
                proxy_pass http://shad_upstream;
                proxy_read_timeout                      180s;
                proxy_set_header Host                   $host;
                proxy_set_header X-Real-IP              $remote_addr;
                proxy_set_header X-Service                   shad;
                proxy_set_header X-Forwarded-For              $remote_addr;

        }





    }


server {
        server_name yandex-school.ru shad.yandex.ru;
        server_name yandex-school.ua shad.yandex.ua;
#yandex-school.ua
        server_name shad.yandex.com.ua;
#yandex-school.com.ua
        server_name shad.yandex.by;
#yandex-school.by
        server_name ~^(shad|yandex-school)\.[a-z0-9\-]+\.yandex\.(ru|(com\.)?ua|by)$;

    include listen_ssl;

# remove comments to use redirect to https

    location ~/ {
        rewrite ^(.*)$ http://$http_host$1 permanent;
    }


    access_log /var/log/nginx/access.log main;

#        location / {
#                proxy_pass http://shad_upstream;
#                proxy_read_timeout                      180s;
#                proxy_set_header Host                   $host;
#                proxy_set_header X-Real-IP              $remote_addr;
#                proxy_set_header X-Service                   shad;
#                proxy_set_header X-Forwarded-For              $remote_addr;

#        }



    }

