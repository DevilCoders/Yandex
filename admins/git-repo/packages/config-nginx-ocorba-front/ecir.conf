upstream ecir_upstream {
	 server localhost:8081;
}

server {
    listen 80;
    listen [::]:80;
        server_name ecir2013.org www.ecir2013.org;
        server_name ~^(www\.)?ecir2013\.[a-z0-9\-]+\.yandex\.ru$;


    access_log /var/log/nginx/access.log main;


# remove comments to use redirect to https
#
#    location ~/ {
#        rewrite ^(.*)$ https://$http_host$1 permanent;
#    }

        location / {
                proxy_pass http://ecir_upstream;
                proxy_read_timeout                      180s;
                proxy_set_header Host                   $host;
                proxy_set_header X-Real-IP              $remote_addr;
                proxy_set_header X-Service                   ecir;
                proxy_set_header X-Forwarded-For              $remote_addr;

        }





    }


server {
    listen 443;
    listen [::]:443;
        server_name ecir2013.org www.ecir2013.org;
        server_name ~^(www\.)?ecir2013\.[a-z0-9\-]+\.yandex\.ru$;

    ssl on;
    ssl_certificate      /etc/nginx/ssl/corba_export.crt;
    ssl_certificate_key  /etc/nginx/ssl/corba_export.key;



    access_log /var/log/nginx/access.log main;

        location / {
                proxy_pass http://ecir_upstream;
                proxy_read_timeout                      180s;
                proxy_set_header Host                   $host;
                proxy_set_header X-Real-IP              $remote_addr;
                proxy_set_header X-Service                   ecir;
                proxy_set_header X-Forwarded-For              $remote_addr;

        }



    }
