#!/bin/bash

undivert () {
    CONFIG="${1}"
    CONFIG_RENAMED="${2}"
    if [ -f ${CONFIG} -a -f ${CONFIG_RENAMED} ]; then
	rm ${CONFIG}
	dpkg-divert --remove ${CONFIG}
	if [ -f ${CONFIG_RENAMED} ]; then
	    cp ${CONFIG_RENAMED} ${CONFIG}
	    fi
	else
	dpkg-divert --remove ${CONFIG}
	fi
}

case "$1" in
    purge|remove|abort-install)
        undivert "/etc/security/limits.conf" "/etc/security/limits.conf_orig"
	undivert "/etc/omniORB.cfg" "/etc/omniORB.cfg_orig"
    ;;
    upgrade|failed-upgrade|abort-upgrade|disappear)
        exit 0
    ;;

    *)
        echo "postrm called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac
