upstream fotki_upstream {
        server front1f.photo.yandex-team.ru max_fails=1 fail_timeout=20s;
}

upstream img_fotki_upstream {
        server imagick1f.photo.yandex-team.ru max_fails=1 fail_timeout=20s;
}

upstream up_fotki_upstream {
        server upload1f.photo.yandex-team.ru max_fails=1 fail_timeout=20s;
}



server {
  listen 80;

  server_name fotki.yandex-team.ru;

  access_log /var/log/nginx/fotki.access.log main;

  location / {
    proxy_pass http://fotki_upstream;
    proxy_set_header Host                   $host;
    proxy_set_header X-Real-IP              $remote_addr;
  }
}

server {
  listen 80;

  server_name img-fotki.yandex-team.ru img.fotki.yandex-team.ru;

  access_log /var/log/nginx/img-fotki.access.log main;

  location / {
    proxy_pass http://img_fotki_upstream;
    proxy_set_header Host                   $host;
    proxy_set_header X-Real-IP              $remote_addr;
  }
}

server {
  listen 80;

  server_name up-fotki.yandex-team.ru;

  access_log /var/log/nginx/up-fotki.access.log main;

  location / {
    proxy_pass http://up_fotki_upstream;
    proxy_set_header Host                   $host;
    proxy_set_header X-Real-IP              $remote_addr;
  }
}
