upstream newhire_upstream {
        server newhire01g.tools.yandex.net max_fails=1 fail_timeout=10s;
	server newhire01d.tools.yandex.net max_fails=1 fail_timeout=10s;
}

server {
        listen 80;
        listen 443;

        server_name newhire;

         if ($scheme = "http") {
              rewrite ^/(.*)$ http://newhire.yandex-team.ru/$1 redirect;
        }

}

server {
        listen 80;
        listen 443;

        server_name  newhire.*;

        access_log /var/log/nginx/newhire.access.log main;

        location / {
                proxy_pass http://newhire_upstream;
                proxy_set_header Host                   newhire.yandex-team.ru;
                proxy_set_header X-Real-IP              $remote_addr;
        }
}

