server {
	include listen;
	server_name yaca.yandex.ru catalog.yandex.ru catalogue.yandex.ru katalog.yandex.ru cat.yandex.ru 
	yaca.yandex.ua catalog.yandex.ua catalogue.yandex.ua katalog.yandex.ua cat.yandex.ua 
	yaca.yandex.by catalog.yandex.by catalogue.yandex.by katalog.yandex.by cat.yandex.by 
	www.yaca.yandex.ru www.catalog.yandex.ru www.catalogue.yandex.ru www.katalog.yandex.ru www.cat.yandex.ru 
	www.yaca.yandex.ua www.catalog.yandex.ua www.catalogue.yandex.ua www.katalog.yandex.ua www.cat.yandex.ua 
	www.yaca.yandex.by www.catalog.yandex.by www.catalogue.yandex.by www.katalog.yandex.by www.cat.yandex.by;
	server_name ~^(www\.)?(yaca|catalog|cat|catalogue|katalog)\.[a-z0-9\-]+\.yandex\.ru$;
	server_name ~^(www\.)?(yaca|catalog|cat|catalogue|katalog)\.[a-z0-9\-]+\.yandex\.by$;
	server_name ~^(www\.)?(yaca|catalog|cat|catalogue|katalog)\.[a-z0-9\-]+\.yandex\.ua$;
	root /usr/local/www5/yaca;
	include fastcgi_params_yandex;
	include xscripts/yaca;
	rewrite /add_payed.xml /add_free.xml permanent;
	rewrite ^/school(/[^?$]*)/?(\?(.*))? /school?path=$1&$3 last;
	rewrite ^/narod(/[^?$]*)/?(\?(.*))? /narod?path=$1&$3 last;
	location = /about.xml {
		if ($host ~* \.ru$ ) { rewrite ^/about.xml http://help.yandex.ru/catalogue/ permanent;}
		if ($host ~* \.by$ ) { rewrite ^/about.xml http://help.yandex.by/catalogue/ permanent;}
		if ($host ~* \.ua$ ) { rewrite ^/about.xml http://help.yandex.ua/catalogue/ permanent;}
		}
	location ~* \.txt$ {
		fastcgi_pass unix:/tmp/xscript-multiple/xscript-yaca.sock;
		include fastcgi_params_yandex;
		}
        location ~* \.xhtml$ {
                fastcgi_pass unix:/tmp/xscript-multiple/xscript-yaca.sock;
                include fastcgi_params_yandex;
                }
	location ~* ^/(yca|yaca|yandpage|yandsearch|family|school|narod)/ {
                fastcgi_pass unix:/tmp/xscript-multiple/xscript-yaca.sock;
                include fastcgi_params_yandex;
                }
}

