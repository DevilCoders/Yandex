log_format yaca_log '[$time_local] $http_host $remote_addr "$request" $status "$http_referer" "$http_user_agent" "$http_cookie" $request_time $upstream_cache_status $bytes_sent';
server {
 server_name ~^(www\.)?(yaca|catalog|catalogue|katalog|cat)(\.\w*)?\.yandex\.(ru|ua|by)$;
 set $dom $4 ; 
 include listen;
 include xscripts/default;
 root /usr/local/www5/yaca;
 access_log /var/log/nginx/access.log yaca_log;
           rewrite ^/yca?(.*)$  /yca?$1.xml;
           rewrite ^/yaca?(.*)$  /yaca?$1.xml;
           rewrite ^/yandpage?(.*)$  /yandpage?$1.xml;

           rewrite ^/yandsearch?(.*)$  /yandsearch?$1.xml;

           rewrite ^/family?(.*)$  /family?$1.xml;





location ~* ^/school {
        rewrite ^/school(/[^?$]*)/?(\?(.*))? /school?path=$1&$3.xml last;
        fastcgi_intercept_errors on;
        fastcgi_pass    unix:/tmp/xscript-multiple/xscript-default.sock;
        include fastcgi_params_yandex;
}


location ~* ^/narod {
        rewrite ^/narod(/[^?$]*)/?(\?(.*))? /narod?path=$1&$3.xml last;
        fastcgi_intercept_errors on;
        fastcgi_pass    unix:/tmp/xscript-multiple/xscript-default.sock;
        include fastcgi_params_yandex;
}




 rewrite ^/add_payed.xml /add_free.xml ;


 rewrite ^/about.xml http://help.yandex.$dom/catalogue/;

}

