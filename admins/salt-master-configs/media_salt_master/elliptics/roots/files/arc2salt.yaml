{% set conf = salt['pillar.get']('arc2salt') %}
arc-token: {{ conf['api-token'] }}
arc-path: /mnt/arc
file_roots:
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/topsls/roots'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/elliptics/roots'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/avatars/roots'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/resizer/roots'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/common/roots'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/ape_prod/roots'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/ape/roots'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/common/roots'
pillar_roots:
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/topsls/pillar'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/elliptics/pillar'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/avatars/pillar'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/resizer/pillar'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/common/pillar'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/ape_prod/pillar'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/storage/ape/pillar'
- '{_ENV_CHECKOUT_PATH_}/admins/salt-media/common/pillar'

pillar_roots_config_path: /srv/salt/configs/dynamic_pillar_config.yaml
file_roots_config_path: /srv/salt/configs/dynamic_roots_config.yaml

env_sources:
  - type: arc_static_branches
    options:
      base_checkouts_path: /srv/salt/checkouts/
      branches:
        - trunk
      paths: 
        - admins/salt-media/storage
        - admins/salt-media/common

  - type: arc_branches_from_users
    options:
      always_use_head: True
      group: 'mds-admin'
      branch_glob: 'users/*/**salt**'
      base_checkouts_path: /srv/salt/checkouts/
      paths:
        - admins/salt-media/storage
        - admins/salt-media/common

  - type: arc_reviews
    options:
      base_checkouts_path: /srv/salt/checkouts/
      paths:
        - admins/salt-media/storage
        - admins/salt-media/common
