#!/usr/bin/make -f
# -*- makefile -*-
# Sample debian/rules that uses debhelper.
#
# This file was originally written by Joey Hess and Craig Small.
# As a special exception, when this file is copied by dh-make into a
# dh-make output file, you may use that output file without restriction.
# This special exception was added by Craig Small in version 0.37 of dh-make.
#
# Modified to make a template file for a multi-binary package with separated
# build-arch and build-indep targets  by Bill Allombert 2001

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

# This has to be exported to make some magic below work.
export DH_OPTIONS


%:
	dh $@ 

build:
	mkdir -p debian/mirror-scripts-build/usr/bin
	mkdir -p debian/mirror-scripts-build/etc/cron.d
	mkdir -p debian/mirror-scripts-build/etc/profile.d
	mkdir -p debian/mirror-scripts-build/etc/monrun/conf.d/
	mkdir -p debian/mirror-scripts-build/usr/share/sync-wiki

	install -m755 usr/bin/*.sh debian/mirror-scripts-build/usr/bin
	install -m755 full-mirror-sync.sh debian/mirror-scripts-build/usr/bin
	install -m755 report_mirror freport.sh signfile debian/mirror-scripts-build/usr/bin
	install -m755 monrun/*.sh debian/mirror-scripts-build/usr/bin
	install -m755 clean-log.sh debian/mirror-scripts-build/usr/bin
	install -m755 table.sh debian/mirror-scripts-build/usr/bin

	install -m644 report_mirror-rpmfusion.conf report_mirror.conf mirror-scripts mirror-sync.conf debian/mirror-scripts-build/etc
	install -m644 cron/mirror-scripts.cron.d debian/mirror-scripts-build/etc/cron.d/mirror-scripts-sync
	install -m644 mirror-scripts.profile debian/mirror-scripts-build/etc/profile.d/mirror-scripts.sh
	install -m644 monrun/mirrors-check.conf debian/mirror-scripts-build/etc/monrun/conf.d/mirrors-check.conf

	install -m600 rsyncd.* debian/mirror-scripts-build/etc

clean:
	echo clean
	dh_clean
	rm -rf debian/mirror-scripts-build

binary:
	dh_installdirs
	dh_install --sourcedir=debian/mirror-scripts-build
	dh_installcron
	dh_link
	dh_strip
#       dh_compress
	dh_fixperms
	dh_installdeb
	dh_gencontrol
	dh_md5sums
	dh_builddeb
