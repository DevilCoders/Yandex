# COM domain redirects per-host: 
server {
	include listen;
	server_name ~(www\.)?(pogoda|weather|meteo|hava|havadurumu)\.(?<testhost>[a-z0-9]+)\.yandex\.com$;
	rewrite ^/ http://pogoda.${testhost}.yandex.ru/index-com.xml permanent;
}

## RU secondary domains per-host:
server {
	include listen;
	server_name ~(www\.)?weather\.(?<testhost>[a-z0-9]+)?\.yandex\.ru$;
	location =/static/cities.xml {
		# no redirects for (www\.)?weather.../static/cities.xml
		root /usr/local/www5/weather;
		}
	location / {
		rewrite ^/(.*)$ http://pogoda.${testhost}.yandex.ru/$1 permanent;
		}
}

server {
	include listen;
	server_name ~^www.pogoda\.(?<testhost>[a-z0-9]+)\.yandex\.ru$;
	server_name ~^(www\.)?meteo\.(?<testhost>[a-z0-9]+)\.yandex\.ru$;
	server_name ~^(www\.)?(pogoda|weather)\.(?<testhost>[a-z0-9]+)\.ya\.ru$;
	rewrite ^/(.*)$ http://pogoda.${testhost}.yandex.ru/$1 permanent;
}

## KUB
server {
	include listen;
	server_name ~^www\.pogoda\.(?<testhost>[a-z0-9]+)\.yandex\.(?<tld>ua|by|kz)$;
	server_name ~^(www\.)?weather\.(?<testhost>[a-z0-9]+)\.yandex\.(?<tld>ua|by|kz)$;
	rewrite ^/(.*)$ http://pogoda.${testhost}.yandex.${tld}/$1 permanent;
}

# COM.TR
server {
	include listen;
	server_name ~^www\.hava\.(?<testhost>[a-z0-9]+)\.yandex\.com\.tr$;
	server_name ~^(www\.)?(havadurumu|weather)\.(?<testhost>[a-z0-9]+)\.yandex\.com\.tr$;
	rewrite ^/(.*)$ http://hava.${testhost}.yandex.com.tr/$1 permanent;
}
