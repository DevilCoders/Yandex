# vim: sts=2 sw=2 ts=2 et
---
name: mediaTestCombainer
parsing:
  groups: [media_test_combainer] # nanny service name without geo
  metahost: media-test-combainer
  DataFetcher:
    type: http
    port: 3132
    uri: "/exec/combainerlog"
  HostFetcher:
    type: "rtc"
    geo: ["sas", "man", "vla"] # geo appended at the end of groups names, like: <group>+_+<geo>
    BasicUrl: "http://nanny.yandex-team.ru/v2/services/%s/current_state/instances/"
aggregate:
  data:
    combainer:
      type: custom
      class: Multimetrics
      rps: "no"
  senders:
    solomon:
      type: solomon
      cluster: combaine
      project: media
      service: combaine.combainer.log
---
name: mediaTestCombainerCocaine
parsing:
  groups: [media_test_combainer]
  metahost: media-test-combainer
  DataFetcher:
    type: http
    port: 3132
    uri: "/exec/cocainelog"
  HostFetcher:
    type: "rtc"
    geo: ["sas", "man", "vla"] # geo appended at the end of groups names, like: <group>+_+<geo>
    BasicUrl: "http://nanny.yandex-team.ru/v2/services/%s/current_state/instances/"
aggregate:
  data:
    cocaine:
      type: custom
      class: Multimetrics
      perHost: YES
  senders:
    solomon:
      type: solomon
      cluster: combaine
      project: media
      service: combaine.cocaine.log
---
name: mediaTestCombainerWorker
parsing:
  groups: [media_test_combainer]
  metahost: media-test-combainer
  DataFetcher:
    type: http
    port: 3132
    uri: "/exec/workerlog"
  HostFetcher:
    type: "rtc"
    geo: ["sas", "man", "vla"] # geo appended at the end of groups names, like: <group>+_+<geo>
    BasicUrl: "http://nanny.yandex-team.ru/v2/services/%s/current_state/instances/"
aggregate:
  data:
    worker:
      type: custom
      class: Multimetrics
      factor: 1000
      perHost: YES
      values: [30, 50, 60, 70, 80, 90, 95, 98, 99, 100]
  senders:
    solomon:
      type: solomon
      cluster: combaine
      project: media
      Fields: ["30_prc","50_prc","60_prc","70_prc","80_prc","90_prc","95_prc","98_prc","99_prc","100_prc"]
      service: combaine.worker
---
name: mediaTestCombainerGraphite
parsing:
  groups: [media_test_combainer]
  metahost: media-test-combainer
  DataFetcher:
    type: http
    port: 3132
    uri: "/exec/graphiteClient"
  HostFetcher:
    type: "rtc"
    geo: ["sas", "man", "vla"] # geo appended at the end of groups names, like: <group>+_+<geo>
    BasicUrl: "http://nanny.yandex-team.ru/v2/services/%s/current_state/instances/"
aggregate:
  data:
    graphite:
      type: custom
      class: Multimetrics
      rps: "no"
      perHost: YES
  senders:
    solomon:
      type: solomon
      cluster: combaine
      project: media
      service: combaine.graphite
---
name: mediaTestCombainerSystemResourcesByApp
parsing:
  groups: [media_test_combainer]
  metahost: media-test-combainer
  DataFetcher:
    type: http
    port: 3132
    uri: "/exec/app_resources"
  HostFetcher:
    type: "rtc"
    geo: ["sas", "man", "vla"] # geo appended at the end of groups names, like: <group>+_+<geo>
    BasicUrl: "http://nanny.yandex-team.ru/v2/services/%s/current_state/instances/"
aggregate:
  data:
    apps:
      type: custom
      class: Multimetrics
      rps: "no"
      perHost: YES
  senders:
    solomon:
      type: solomon
      cluster: combaine
      project: media
      service: combaine.resources
---
name: mediaTestCombainerDashboard
parsing:
  groups: [media_test_combainer]
  metahost: media-test-combainer
  DataFetcher:
    type: http
    port: 3132
    uri: "/exec/dashboard"
  HostFetcher:
    type: "rtc"
    geo: ["sas", "man", "vla"] # geo appended at the end of groups names, like: <group>+_+<geo>
    BasicUrl: "http://nanny.yandex-team.ru/v2/services/%s/current_state/instances/"
aggregate:
  data:
    dashboard:
      type: custom
      class: Multimetrics
      rps: "no"
      perHost: YES
  senders:
    solomon:
      type: solomon
      cluster: combaine
      project: media
      service: combaine.dashboard
---
name: mediaTestCombainerTraffic
parsing:
  groups: [media_test_combainer]
  metahost: media-test-combainer
  HostFetcher:
    type: "rtc"
    geo: ["sas", "man", "vla"] # geo appended at the end of groups names, like: <group>+_+<geo>
    BasicUrl: "http://nanny.yandex-team.ru/v2/services/%s/current_state/instances/"
  DataFetcher:
      type: http
      port: 3132
      uri: "/exec/traffic"
aggregate:
  data:
    traffic:
      type: custom
      class: Traffic
  senders:
    solomon:
      type: solomon
      cluster: combaine
      project: media
      service: combaine.traffic
