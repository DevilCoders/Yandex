---
name: disk_uploader-mulcagate_access
parsing:
  groups: [disk_uploader]
  DataFetcher:
    logname: "mulcagate/access.log"
    timetail_url: "/timetail?pattern=mulcagate_access&type=common&log_ts="
aggregate:
  data:
    mulcagate_access:
      type: custom
      class: Multimetrics
      factor: 1000
  senders:
    graphite:
      type: graphite
      cluster: media.disk

    juggler_uploader_mulcagate_access_4xx: &juggler-conf
      type: juggler
      namespace: disk
      host: "uploader.disk.yandex.net"
      notifications:
        - template_name: phone_escalation
          template_kwargs:
            on_success_next_call_delay: 120
            repeat: 100
            delay: 900
            logins:
                - robot-disk-duty-adm
                - robot-disk-duty-jun
                - robot-disk-java-mntr
                - ivanov-d-s
                - kolyann
                - ignition
                - akinfold
                - kis8ya
                - sanya2013
                - yak-dmitriy
                - shirankov
                - friendlyevil
                - c4et4uk
                - derovi
      Aggregator: logic_or
      checkname: uploader_mulcagate_access_4xx
      description: uploader_mulcagate_access_4xx
      flaps: { stable_time: 60, critical_time: 180 }
      aggregator_kwargs:
        nodata_mode: force_ok
      config:
          type: metahost
      CRIT: [" ${mulcagate_access}['mulcagate_total_4xx'] > 2 "]
      tags:
        - production

    juggler_uploader_mulcagate_access_5xx:
      << : *juggler-conf
      checkname: uploader_mulcagate_access_5xx
      description: uploader_mulcagate_access_5xx
      config:
          type: metahost
      CRIT: [" ${mulcagate_access}['mulcagate_total_5xx'] > 2 "]

---
name: disk_uploader-mediastorage_mulcagate_access
parsing:
  groups: [disk_uploader]
  DataFetcher:
    logname: "mds/access.log"
    timetail_url: "/timetail?pattern=mediastorage_mulcagate_access&type=tskv&log_ts="
aggregate:
  data:
    mediastorage_mulcagate_access:
      type: custom
      class: Multimetrics
      factor: 1000
  senders:
    graphite:
      type: graphite
      cluster: media.disk

    juggler_uploader_mediastorage_mulcagate_access_4xx: &mediastorage-juggler-conf
      type: juggler
      namespace: disk
      host: "uploader.disk.yandex.net"
      notifications:
        - template_name: phone_escalation
          template_kwargs:
            on_success_next_call_delay: 120
            repeat: 100
            delay: 900
            logins:
                - robot-disk-duty-adm
                - robot-disk-duty-jun
                - robot-disk-java-mntr
                - ivanov-d-s
                - kolyann
                - ignition
                - akinfold
                - kis8ya
                - sanya2013
                - yak-dmitriy
                - shirankov
                - friendlyevil
                - c4et4uk
                - derovi
      Aggregator: logic_or
      checkname: uploader_mediastorage_mulcagate_access_4xx
      description: uploader_mediastorage_mulcagate_access_4xx
      flaps: { stable_time: 60, critical_time: 180 }
      aggregator_kwargs:
        nodata_mode: force_ok
      config:
          type: metahost
      CRIT: [" ${mediastorage_mulcagate_access}['mulcagate_total_4xx'] > 2 "]
      tags:
        - production

    juggler_uploader_mediastorage_mulcagate_access_5xx:
      << : *mediastorage-juggler-conf
      checkname: uploader_mediastorage_mulcagate_access_5xx
      description: uploader_mediastorage_mulcagate_access_5xx
      config:
          type: metahost
      CRIT: [" ${mediastorage_mulcagate_access}['mulcagate_total_5xx'] > 2 "]
