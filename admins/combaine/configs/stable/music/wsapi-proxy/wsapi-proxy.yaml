# vim: sts=2 sw=2 ts=2 et
---
name: ws_api_proxy
parsing:
  groups: [music_stable_wsapi_proxy]
  metahost: music_stable_wsapi_proxy
  DataFetcher:
    type: http
    uri: "/;csv"
    port: 9002
  HostFetcher:
    type: "rtc"
    geo: ["man", "sas", "vla"]
    BasicUrl: "http://nanny.yandex-team.ru/v2/services/%s/current_state/instances/"
aggregate:
  data:
    haproxy-slb:
      type: custom
      class: HaproxySlb
      perHost: YES
  senders:
    graphite:
      type: graphite
      cluster: media.music
    solomon:
      type: solomon
      cluster: prod
      project: music
      service: wsapi_proxy
---
name: ws_api_proxy_status
parsing:
  groups: [music_stable_wsapi_proxy]
  metahost: ws-api.music.yandex.net
  DataFetcher:
    uri: "/timetail?pattern=ws-api"
    type: http
    port: 3131
  HostFetcher:
    type: "rtc"
    geo: ["man", "sas", "vla"]
    BasicUrl: "http://nanny.yandex-team.ru/v2/services/%s/current_state/instances/"
aggregate:
  data:
    status:
      type: custom
      class: Multimetrics
      perHost: YES
  senders:
    graphite:
      type: graphite
      cluster: media.music
    solomon:
      type: solomon
      cluster: prod
      project: music
      service: wsapi_proxy
