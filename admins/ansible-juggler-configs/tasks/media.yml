- juggler_check:
  args: "{{ default_check | hash_merge( unreach_check, unreach_ok, production_default_media, item if item is mapping else {'service': item} ) }}"
  with_items: "{{ common_checks }}"
  when: type == 'production' and project in ['music', 'alet', 'afisha', 'kassa', 'audiorobot', 'jkp', 'kino', 'kinopoisk', 'ott', 'tv', 'cult', 'media']

- juggler_check:
  args: "{{ default_check | hash_merge( unreach_check, unreach_ok, testing_default_media, item if item is mapping else {'service': item} ) }}"
  with_items: "{{ common_checks }}"
  when: type == 'testing' and project in ['music', 'alet', 'afisha', 'kassa', 'audiorobot', 'jkp', 'kino', 'kinopoisk', 'ott', 'tv', 'cult', 'media']

- juggler_check:
  args: "{{ default_check | hash_merge( unreach_check, unreach_ok, production_default_nonmedia, item if item is mapping else {'service': item} ) }}"
  with_items: "{{ common_checks }}"
  when: type == 'production' and project not in ['music', 'alet', 'afisha', 'kassa', 'audiorobot', 'jkp', 'kino', 'kinopoisk', 'ott', 'tv', 'cult', 'media']

- juggler_check:
  args: "{{ default_check | hash_merge( unreach_check, unreach_ok, testing_default_nonmedia, item if item is mapping else {'service': item} ) }}"
  with_items: "{{ common_checks }}"
  when: type == 'testing' and project not in ['music', 'alet', 'afisha', 'kassa', 'audiorobot', 'jkp', 'kino', 'kinopoisk', 'ott', 'tv', 'cult', 'media']

# iptruler и pkgver обрабатываются отдельно, чтобы не светиться ночью
- juggler_check:
  args: "{{ default_check | hash_merge( unreach_ok, testing_default_media, {'service': 'iptruler'} ) }}"
  when: iptruler == True and project in ['music', 'alet', 'afisha', 'kassa', 'audiorobot', 'jkp', 'kino', 'kinopoisk', 'ott', 'tv', 'cult', 'media']

- juggler_check:
  args: "{{ default_check | hash_merge( unreach_ok, testing_default_media, {'service': 'pkgver'} ) }}"
  when: pkgver == True and project in ['music', 'alet', 'afisha', 'kassa', 'audiorobot', 'jkp', 'kino', 'kinopoisk', 'ott', 'tv', 'cult', 'media']

- juggler_check:
  args: "{{ default_check | hash_merge( unreach_ok, testing_default_nonmedia, {'service': 'iptruler'} ) }}"
  when: iptruler == True and project not in ['music', 'alet', 'afisha', 'kassa', 'audiorobot', 'jkp', 'kino', 'kinopoisk', 'ott', 'tv', 'cult', 'media']

- juggler_check:
  args: "{{ default_check | hash_merge( unreach_ok, testing_default_nonmedia, {'service': 'pkgver'} ) }}"
  when: pkgver == True and project not in ['music', 'alet', 'afisha', 'kassa', 'audiorobot', 'jkp', 'kino', 'kinopoisk', 'ott', 'tv', 'cult', 'media']
