port = {{ mongodb.mongod.port }}
pidfilepath = /var/run/mongodb/mongodb.pid
dbpath = {{ mongodb.mongod.dbpath }}
journal = true
logpath = /var/log/mongodb/mongodb.log
logappend = true
logRotate = reopen
{%- if mongodb.mongod.syncdelay %}
syncdelay = {{ mongodb.mongod.syncdelay }}
{%- endif %}
ipv6 = true
slowms = {{ mongodb.mongod.slowms }}
cpu = true
directoryperdb = true

{%- if mongodb.version|default(False) %}
{% set version = mongodb.version | string %}
{%- if ''.join(version.split('.')[0:2]) | int >= 36 %}
bind_ip_all = 1
{%- else %}
rest = {{ mongodb.mongod.rest }}
{%- endif %}
{%- else %}
rest = {{ mongodb.mongod.rest }}
{%- endif %}

profile = {{ mongodb.mongod.profile }}
{{"replSet = {0}".format(mongodb.mongod.replSet) if mongodb.mongod.get("replSet") else ""}}
{{"storageEngine = {0}".format(mongodb.mongod.storageEngine) if mongodb.mongod.get("storageEngine") else ""}}
{{"keyFile={0}".format(mongodb.keyFile) if mongodb.get("keyFile") else ""}}
{{"maxConns={0}".format(mongodb.mongod.maxConns) if mongodb.mongod.get("maxConns") else ""}}

{% if mongodb.mongod.get("enableMajorityReadConcern") -%}
enableMajorityReadConcern = true
{% endif -%}

{%- if mongodb.mongod.get("oplogSize") %}
oplogSize = {{ mongodb.mongod.oplogSize }}
{%- endif %}
