{% if logrotate.get('error_log_rotate') %}
/var/log/nginx/error*.log {
   {{ logrotate.frequency|default("daily", True) }}
   {%- if logrotate.get("maxsize") %}
   maxsize {{ logrotate.maxsize }}
   {%- endif %}
   missingok
   rotate {{ logrotate.error_log_rotate }}
   {%- if logrotate.get("compress") %}
   compress
   {%- endif %}
   {%- if logrotate.get("delaycompress") %}
   delaycompress
   {%- endif %}
   {%- if logrotate.get("dateext") %}
   dateext
   dateformat {{ logrotate.dateext }}
   {%- endif %}
   notifempty
   create 644 root root
   sharedscripts
   postrotate
      [ ! -f /var/run/nginx.pid ] || kill -USR1 `cat /var/run/nginx.pid`
   endscript
}

/var/log/nginx/access*.log {
   {{ logrotate.frequency|default("daily", True) }}
   {%- if logrotate.get("maxsize") %}
   maxsize {{ logrotate.maxsize }}
   {%- endif %}
   missingok
   rotate {{ logrotate.rotate|default(7, True) }}
   {%- if logrotate.get("compress") %}
   compress
   {%- endif %}
   {%- if logrotate.get("delaycompress") %}
   delaycompress
   {%- endif %}
   {%- if logrotate.get("dateext") %}
   dateext
   dateformat {{ logrotate.dateext }}
   {%- endif %}
   notifempty
   create 644 root root
   sharedscripts
   postrotate
      [ ! -f /var/run/nginx.pid ] || kill -USR1 `cat /var/run/nginx.pid`
   endscript
}

{% else %}

/var/log/nginx/*.log {
   {{ logrotate.frequency|default("daily", True) }}
   {%- if logrotate.get("maxsize") %}
   maxsize {{ logrotate.maxsize }}
   {%- endif %}
   missingok
   rotate {{ logrotate.rotate|default(7, True) }}
   {%- if logrotate.get("compress") %}
   compress
   {%- endif %}
   {%- if logrotate.get("delaycompress") %}
   delaycompress
   {%- endif %}
   {%- if logrotate.get("dateext") %}
   dateext
   dateformat {{ logrotate.dateext }}
   {%- endif %}
   notifempty
   create 644 root root
   sharedscripts
   postrotate
      [ ! -f /var/run/nginx.pid ] || kill -USR1 `cat /var/run/nginx.pid`
   endscript
}
{% endif %}
