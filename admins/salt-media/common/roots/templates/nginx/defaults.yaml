enabled: False
service: nginx
only_reload: False
packages:
  - config-nginx-404-portal
  - yandex-common-nginx-50x-page
  - config-monrun-cert-check
monrun:
  errorlog:
    enabled: False
    config: |
      FILTER=''
confd_params:
  default_type: 'application/octet-stream'
  server_names_hash_bucket_size: '128'
  variables_hash_bucket_size: '128'
  variables_hash_max_size: '1024'
  keepalive_timeout: 120
  gzip: 'on'
  gzip_proxied: 'any'
  gzip_min_length: 1100
  gzip_http_version: '1.0'
  gzip_buffers: '4 8k'
  gzip_comp_level: 9
  gzip_types: 'text/js text/plain text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript application/json application/javascript'
  sendfile: 'on'
  tcp_nodelay: 'on'
  access_log: '/var/log/nginx/access.log default'
  server_tokens: 'off'
events_params:
  use: epoll
  worker_connections: 2048
main_params:
  worker_processes: 24
  pid: /var/run/nginx.pid
  user: www-data
  worker_rlimit_nofile: 4096
logrotate:
  frequency: daily
  maxsize: False
  rotate: 7
  delaycompress: True
  dateext: False
  compress: True
listens:
  listen:
    ports: ['80', '[::]:80']
  listen_ssl:
    ssl:
      ssl_dhparam: '/etc/nginx/ssl/dhparam.pem'
      ssl_ciphers: 'kEECDH+AESGCM+AES128:kEECDH+AES128:kRSA+AESGCM+AES128:kRSA+AES128:DES-CBC3-SHA:!RC4:!aNULL:!eNULL:!MD5:!EXPORT:!LOW:!SEED:!CAMELLIA:!IDEA:!PSK:!SRP:!SSLv2'
      ssl_protocols: 'TLSv1 TLSv1.1 TLSv1.2'
      ssl_session_timeout: '28h'
      ssl_session_cache: 'shared:SOME_UNIQ_PER_CERTIFICATE_CACHE_NAME:128m'
      ssl_prefer_server_ciphers: 'on'
    ports: ['443', '[::]:443']
vhost_default: True
vhost_default_cert: {}
accesslog_config: salt://templates/nginx/files/etc/nginx/conf.d/accesslog.conf
vhost_default_config: salt://templates/nginx/files/etc/nginx/sites-available/00-default.tmpl
nginx_config:  salt://templates/nginx/files/etc/nginx/nginx.conf
confd_config:  salt://templates/nginx/files/conf.tmpl
events_config: salt://templates/nginx/files/conf.tmpl
main_config:   salt://templates/nginx/files/conf.tmpl
logrotate_config: salt://templates/nginx/files/etc/logrotate.d/logrotate-nginx
limit_req_zones_config: salt://templates/nginx/files/etc/nginx/conf.d/limit_req_zones.conf
