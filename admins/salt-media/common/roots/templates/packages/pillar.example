# Темплейт для установки пакетов салтом из pkgver.pl -i, из common списка и из пилларов
# 1. Берет пакеты, которые возвращает кондуктор на машинку и делает из них список LIST. Если указан packages:conductor:enable:False - список LIST остается пустым
# 2. Мержит пакеты из common_list+packages_common(map.jinja) и packages:common(пиллар). А затем мержит результат с LIST. Если указан packages:common:False - пропускает этот шаг. Если указан packages:common_rewrite - игнорирует пакеты из map.jinja, мержит packages:common(пиллар) и LIST(1 шаг)
# 3. Если указан packages:project или packages:cluster - мержит их с LIST
# 4. Мержит пакеты из packages_filtered(map.jinja) и packages:filtered(пиллар). Затем исключает результат из LIST. Если указан packages:filtered:False - пропускает этот шаг. Если указан packages:filtered_rewrite - игнорирует packages_filtered(map.jinja) и исключает из LIST только пакеты из packages:filtered(пиллар)
#
# Мержинг используется из самописного модуля ldmerge.
# Логика: 
# на вход подаются a = ['config-media-common', {'conf-repo-prestable': '1.2.3'}, {'yandex-common': '3.2.1'] и b = ['conf-repo-prestable', {'yandex-common': '3.0.0'}]
# Результатом будет: ['config-media-common', {'conf-repo-prestable': '1.2.3'}, {'yandex-common': '3.0.0'}]
#   Если пакет без версии присутствует хотя бы в одном из списков - он будет в результате
#   Если в одном из списков есть пакет без версии, а в другом он же с версией - в результате будет пакет с версией
#   Если в обоих списках присутствует один и тот же пакет с версией - приоритет отдается списку a (первому на входе) - в результате будет пакет с версией из списка a --- фича для возможности переопределить версию пакета на любом из уровней (кондуктор, проект, кластер)
#
# ПЕРЕД ИСПОЛЬЗОВАНИЕМ УДАЛИТЬ КОММЕНТАРИИ. ЗДЕСЬ УКАЗАНЫ ЗНАЧЕНИЯ ПО УМОЛЧАНИЮ

packages:
  conductor: True
  common: ['rsync', 'netcat', 'curl', 'dstat', 'file', 'links', 'lynx', 'strace', 'lsof', 'telnet', 'wget', 'vim-tiny', 'bash-completion', 'screen', 'tcpdump', 'traceroute', 'config-apt-allowunauth', 'yandex-conf-hostname-long', 'logrotate-hourly', 'config-ssh-strictno', 'config-disable-checkarray', 'yandex-environment', 'updatedb-exclude-srv', 'yandex-watchdog', 'yandex-dash2bash', 'config-iosched', 'yandex-coredump-config', 'yandex-coredump-monitoring', 'yandex-ubic-watchdog-counter', 'yandex-media-config-sysctl', 'yandex-conf-root-password', 'yandex-autodetect-root-email', 'config-monitoring-common', 'config-juggler-client-media', 'juggler-client', 'yandex-archive-keyring', 'config-monitoring-media', 'config-yandex-friendly-bash', 'config-media-admins-public-keys', 'syslog-ng-include', 'yandex-timetail', 'yandex-locales', 'config-yabs-ntp', 'corba-postfix-fixer', 'config-autodetect-active-eth', 'config-postfix-media', 'config-caching-dns', 'shelf-utils', 'config-init-disable-ra', 'conductor-agent', 'cauth-client-caching', 'cauth-client-scripts', 'config-interfaces', 'config-media-graphite', 'iptruler', 'syslog-ng-watchdog', 'tzdata', 'openssl', 'bash', 'libc6']
  common_rewrite: False
  project: []
  cluster: []
  filtered: ['salt-common', 'salt-master', 'salt-minion', 'salt-yandex-components', 'yandex-media-common-salt-auto']
  filtered_rewrite: False
