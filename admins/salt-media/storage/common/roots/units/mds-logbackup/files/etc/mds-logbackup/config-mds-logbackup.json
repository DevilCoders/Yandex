{%- set key = pillar['yav']['aws_storage-admin_key'] -%}
{
  "service": {
    "log_level": "info",
    "log_file": "/var/log/mds-logbackup/mds-logbackup-arc.log"
  },
  "compressed": true,
  "s3": {
    "endpoint": "s3.mds.yandex.net",
    "access_key": "l5ir5hR0Pkdckj3PRbXA",
    "secret_key": "{{ key }}",
    "bucket": "storage-admin",
    "extra_args": {
      "StorageClass": "STANDARD_IA"
    },
    "max_concurrent_requests": 10,
    "multipart_chunksize": 128,
    "addressing_style": "virtual"
  },
  "logs_settings": {
    "default": "logs/",
    "/var/log/s3/goose-maintenance": "persistent/",
    "/var/log/nginx/int-tskv.log": "persistent/"
  },
  "whitelist_files": [
    "/var/log/mastermind/jobs/[^/]*zst",
    "/var/log/mastermind/minion.*gz"
  ],
  "exclude_files": [
    "/var/log/[^/]*gz",
    "/var/log/elliptics/avatars.*",
    "/var/log/elliptics/ubic.*",
    "/var/log/mastermind/jobs.*",
    "/var/log/nginx/access.log.*.gz",
    "/var/log/nginx/ocraas.log.*.gz",
    "/var/log/nginx/tikaite.log.*.gz",
    "/var/log/ubic*"
  ],
  "exclude_path": [
    "/var/log/account",
    "/var/log/apt",
    "/var/log/cauth",
    "/var/log/cokemulator-imageparser",
    "/var/log/conductor-agent",
    "/var/log/corba/fotki",
    "/var/log/dstat",
    "/var/log/gatlinggun",
    "/var/log/installer",
    "/var/log/ipmi_monitoring",
    "/var/log/juggler-client",
    "/var/log/loggiver",
    "/var/log/logrotate",
    "/var/log/mds_cleanup",
    "/var/log/ntp-watchdog",
    "/var/log/ocraas",
    "/var/log/salt",
    "/var/log/snaked",
    "/var/log/sssd",
    "/var/log/statbox",
    "/var/log/tikaite",
    "/var/log/upstart",
    "/var/log/yandex",
    "/var/log/yasmagent"
  ],
  "remove_files": [
    "/var/log/mastermind/jobs/.*.zst",
    "/var/log/karl/jobs/.*.zst"
  ]
}
