{
    "version": 4,
    "logging": {
        "loggers" : {
            "core": [
                {
                    "formatter": {
                        "type": "tskv",
                        "create": {
                            "tskv_format": "cocaine-log",
                            "type": "cocaine-backend"
                        },
                        "mutate": {
                            "unixtime_microsec_utc": {"strftime": "%s.%f", "gmtime": false},
                            "timestamp": {"strftime": "%Y-%m-%dT%H:%M:%S"},
                            "timezone": {"strftime": "%z"}
                        }
                    },
                    "sinks": [
                        {
                            "type": "file",
                            "path": "/dev/stdout"
                        }
                    ]
                }
            ]
        },
        "severity": "info"
    },

    "network": {
        "pinned": {
            "locator": 10071,
            "node": 10072,
            "storage": 10073,
            "tvm": 10074,
            "logging": 10075,
            "unicorn": 10076,
            "unistorage": 10077
        },
        "shared":[32223,32723]
    },

    "authorizations": {
        "event": {
            "type": "disabled",
            "args": {
                "unicorn": "core"
            }
        },

        "storage": {
            "type": "disabled",
            "args": {
                "backend": "core"
            }
        },

        "unicorn": {
            "type": "disabled",
            "args": {
                "backend": "core"
            }
        }
    },

    "paths": {
        "plugins": [
            "/usr/lib/cocaine"
        ],
        "runtime": "/var/run/cocaine"
    },

    "services": {
        "logging": {
            "type": "logging::v2",
            "args": {
                "default_metafilter" : [[ "severity", 1 ], ["traced"]]
            }
        },

        "metrics": {
            "type": "metrics"
        },

        "tvm": {
            "type": "tvm",
            "args": {
                "base_url": "https://tvm-api.yandex.net",
                "client_id": "92",
                "client_secret": "___tvm_92_client_secret___"
            }
        },

        "unistorage": {
            "type": "unistorage",
            "args": {
                "backends" : ["disk-singular-zero", "libmds", "mulcagate"],
                "keyring_path": "/etc/cocaine/auth.keys"
            }
        },
    
        "storage": {
            "type": "storage"
        },

        "locator": {
            "type": "locator",
            "args": {
                "cluster": {
                    "type": "unicorn",
                    "args": {
                        "backend": "discovery"
                    }
                },
                "extra_param":{
                    "x-cocaine-cluster": "testing_srw_man"
                }
            },
            "restrict": ["logging"],
            "restrict": ["unicorn"]
        },

         "unicorn": {
           "type": "unicorn",
           "args": {
             "backend": "core"
           }
        }
    },

    "authentications": {
        "core": {
            "type": "tvm",
            "args": {
                "allow_anonymous": true,
                "client_id": 92,
                "client_secret": "___tvm_92_client_secret___",
                "secure_storage": "core",
                "base_url": "https://tvm-api.yandex.net",
                "keyring_path": "/etc/cocaine/auth.keys"
                }
        }
    },

    "storages": {
        "core": {
                "type" : "postgres",
                "args" : {
                    "pg_backend" : "core",
                    "pg_table_name" : "mdst_index",
                    "pg_underlying_storage" : "elliptics_core",
                    "pg_key_column" : "key",
                    "pg_collection_column" : "collection",
                    "pg_tags_column" : "tags"
                }
        },
        "elliptics_core": {
            "type": "elliptics",
            "args": {
                "nodes" : [
                    "cloud01myt.mdst.yandex.net:1025:10",
                    "cloud01sas.mdst.yandex.net:1025:10"
                ],
                "io-thread-num" : 8,
                "wait-timeout" : 30,
                "check-timeout" : 60,
                "net-thread-num" : 8,
                "groups" : [999999998, 999999999],
                "timeouts" : {
                    "read" : 60,
                    "write" : 60,
                    "remove" : 60,
                    "find" : 60
                },
                "success-copies-num" : "any",
                "flags" : 4,
                "read_latest": true,
                "verbosity" : 4
            }
        }
    },

    "postgres": {
        "core": {
            "args" : {
                "pool_size" : 3,
                "connection_string" : "dbname=ape_test user=ape_test port=6432 host=c-dce9af9b-999a-4c0a-87f7-3a66aeacfb59.rw.db.yandex.net sslmode=verify-full sslrootcert=/usr/share/yandex-internal-root-ca/YandexInternalRootCA.crt"
            }
        }
    },

    "unicorns": {
        "core": {
            "type": "zookeeper",
            "args": {
                "endpoints": [
                    {"host":"zk01h.tst.ape.yandex.net", "port": 2181},
                    {"host":"zk01i.tst.ape.yandex.net", "port": 2181},
                    {"host":"zk01f.tst.ape.yandex.net", "port": 2181}
                ],
                "prefix": "/srw-test",
                "recv_timeout_ms": 5000
            }
        },
       "discovery": {
            "type": "zookeeper",
            "args": {
                "endpoints": [
                    {"host":"zk01h.tst.ape.yandex.net", "port": 2181},
                    {"host":"zk01i.tst.ape.yandex.net", "port": 2181},
                    {"host":"zk01f.tst.ape.yandex.net", "port": 2181}
                 ],
                "prefix": "/ape-test-discovery",
                "recv_timeout_ms": 5000
            }
        }
    },

    "unistorage_backends": {
        "disk-singular-zero": {
            "type": "disk-singular-zero"
        },
        "libmds": {
            "type": "libmds",
            "args": {
                "adapter_verbosity": 0,
                "data_flow_rate": 10,
                "default_chunk_size": 16777216,
                "debug_mode": false,
                "elliptics_remote_port": 1025,
                "check_timeout": 3,
                "lookup_timeout": 4,
                "read_timeout": 10,
                "wait_timeout": 5,
                "recovery_timeout": 20,
                "mastermind_remotes" : [["collector01myt.mdst.yandex.net", 8383], ["collector01man.mdst.yandex.net", 8383]],
                "mastermind_app_name" : "mastermind-drooz-http",
                "mastermind_cache_path": "/var/tmp/unistorage.cache",
                "mastermind_warning_time": 3000,
                "mastermind_expire_time": 86400000,
                "mastermind_enqueue_timeout_ms": 50000,
                "mastermind_reconnect_timeout_ms": 5000,
                "maximum_chunk_size": 67108864,
                "minimal_chunk_size": 1048576,
                "use_elliptics_proxy": true
            }
        },
        "mulcagate": {
             "type":"mulcagate", 
             "args":{
            "base_uri" : "http://storage.stm.yandex.net:10010",
            "read_uri" : "/gate/get/",
            "read_timeout_ms" : 5000000,
            "size_header" : "X-Data-Size" 
            }
        } 
    }
}

