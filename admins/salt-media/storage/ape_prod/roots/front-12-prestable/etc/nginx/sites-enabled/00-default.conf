proxy_cache_path  /var/cache/nginx/cache_ping  levels=1   keys_zone=cocaine-ping:1m inactive=1d  max_size=1M;

server {
	server_name default.ya.ru;
	listen 80 default reuseport;
	listen [::]:80 default reuseport;
	listen 443 ssl reuseport;
	listen [::]:443 ssl reuseport;
	ssl_certificate /etc/nginx/ssl/front.intape.yandex.net.pem;
	ssl_certificate_key /etc/nginx/ssl/front.intape.yandex.net.pem;
	location / {
		return 404;
	}
	location /ping {
		#return 200;
		proxy_pass http://cocaine-native;
		proxy_cache     cocaine-ping;
                proxy_cache_key $request_uri;
                proxy_cache_valid 200 2s;
		proxy_read_timeout 2s;
	}
	location /check {
		return 200 Ok;
	}
}
server {
	server_name default-int.ya.ru;
	listen 5.255.240.178:80 default reuseport;
	listen [2a02:6b8:0:3400::1:178]:80 default reuseport;
	listen 5.255.240.178:443 ssl reuseport;
	listen [2a02:6b8:0:3400::1:178]:443 ssl reuseport;
	ssl_certificate /etc/nginx/ssl/front.intape.yandex.net.pem;
	ssl_certificate_key /etc/nginx/ssl/front.intape.yandex.net.pem;
	location / {
		return 404;
	}
	location /ping {
		#return 200;
		proxy_pass http://cocaine-native;
		proxy_cache     cocaine-ping;
                proxy_cache_key $request_uri;
                proxy_cache_valid 200 2s;
		proxy_read_timeout 2s;
	}
	location /check {
		return 200 Ok;
	}
}

