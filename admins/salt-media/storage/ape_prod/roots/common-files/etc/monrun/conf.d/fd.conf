[ubic_fd]
execution_interval=60
execution_timeout=30
command=ubic status | grep -v ubic | grep pid | sed 's/)//g' | awk '{print $1" "$NF}' | while read name pid; do echo `grep "Max open files" /proc/$pid/limits | awk '{print int($4*0.9)}'` `ls -1 /proc/$pid/fd/ | wc -l` $name; done | awk '{if($2>$1) res="2; "$3" use more then 90%"}END{if(res) print res; else print "0; Ok"}'
type=common
