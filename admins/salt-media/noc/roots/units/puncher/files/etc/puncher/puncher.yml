daemon:
  listen: :8080
  self_api_url: https://puncher.yandex-team.ru/api/dynfw
  macrosd_url: http://localhost:8083
  usersd_url: http://localhost:8085
  requestsd_url: http://localhost:8087
  rulesd_url: http://localhost:8088

importd:
  listen: :8081
  period: 900
  usersd_url: http://localhost:8085
  rulesd_url: http://localhost:8088
  requestsd_url: http://localhost:8087
  macrosd_url: http://localhost:8083

exportd:
  listen: :8082
  period: 600
  time_zone: Europe/Moscow
  cparser: /usr/bin/fw-fhop
  usersd_url: http://localhost:8085
  rulesd_url: http://localhost:8088
  macrosd_url: http://localhost:8083
  cvs_checkout_dir: /tmp/cvs
  cvs_commit_dir: /tmp/cvs-write
  alert_period: 3600

macrosd:
  listen: :8083
  period: 300
  priority_dns_pool_limit: 4
  ignore:
    - _ROSKOMTZENZURASRV_
    - _C_VS_OPENSTACK_PERSONAL_
    - _C_VS_OPENSTACK_PERSONAL_REWLE_
    - _C_MEDIA_DEV_RECOMMENDERS_
  cvs_checkout_dir: /tmp/cvs-macrosd
  cache_file: /tmp/macrosd_cache
  alert_period: 1200

startrek_watcher:
  listen: :8084
  usersd_url: http://localhost:8085
  requestsd_url: http://localhost:8087

usersd:
  listen: :8085
  period: 900
  macrosd_url: http://localhost:8083
  rulesd_url: http://localhost:8088
  staff_root_departments:
    - "@dpt_yandex@"
    - "@dpt_outstaff@"
    - "@dpt_ext@"
    - "@dpt_yandex_money@"
    - "@dpt_ex_yandex_money@"
    - "@dpt_former@"
    - "@dpt_virtual@"

rules_cauth:
  listen: :8086
  period: 300
  dns_max_attempts: 3
  usersd_url: http://localhost:8085
  rulesd_url: http://localhost:8088
  macrosd_url: http://localhost:8083
  min_rules: 2000
  dns_max_attempts: 3
  reject_nets:
    - _IPMINETS_
    - _FASTBONE_
  cvs_checkout_dir: /tmp/cvs-cauth
  hbf_rules_url: http://hbf.yandex.net/dump-dummy-rules
  alert_period: 7200
  racktables_alert_period: 900

requestsd:
  listen: :8087
  rpc_timeout: 3s
  public_puncher_url: https://puncher.yandex-team.ru
  time_zone: Europe/Moscow
  templates_dir: /usr/share/puncher/templates
  rulesd_url: http://localhost:8088

rulesd:
  listen: :8088

agranat:
  url: https://idm.yandex-team.ru/fw/agranat.m4

bot:
  url: http://bot.yandex-team.ru/api/
  token: {{ pillar['puncher_secrets']['bot'] }}

calendar:
  base_url: https://calendar-api.tools.yandex.net/internal
  timeout: 10s
  client_id: 2011072

cauth:
  puncher_rules_url: https://cauth-api.yandex-team.ru/puncher/rules/
  dial_timeout: 2s
  tls_handshake_timeout: 2s
  timeout: 1800s
  certificate_file: /etc/puncher/private/cauth.cer
  key_file: /etc/puncher/private/cauth.key
  rules_path: cauth_rules.m4

conductor:
  api_groups_url: https://c.yandex-team.ru/api/groups
  api_groups_export_url: https://c.yandex-team.ru/api/groups_export
  api_v1_url: https://c.yandex-team.ru/api/v1
  group_url: https://c.yandex-team.ru/groups/
  token: {{ pillar['puncher_secrets']['conductor'] }}

cms:
  groups_url: https://proxy.sandbox.yandex-team.ru/last/GENCFG_CAUTH_EXPORT_HOSTS

cvs:
  cvsroot: "robot-dynfw-imports@tree.yandex.ru:/opt/CVSROOT"
  identity_file: /etc/puncher/robots-secret-keys/robot-dynfw-imports
  data_dir: /tmp/cvs
  data_write_dir: /tmp/cvs-write
  sections_dir: /noc/routers/fw/puncher_sections
  balancers_dir: /noc/balancers/iptables/sections
  balancers_ipfw_dir: /noc/balancers/iptables/ipfw-sections
  router_fw_dir: /noc/routers/fw
  dns_cache_file: /noc/routers/fw/router.dnscache.full
  rules_inc_path: /noc/balancers/iptables/rules.inc
  rt_sections_dir: /noc/routers/fw/sections/

data_targets:
  "department":
    path: dpt.inc
  "wiki":
    path: wiki.inc
  "service":
    path: srv2.inc
  "servicerole":
    path: srv2.inc
  "mobile":
    path: mobile.inc
  "project":
    path: projects.inc
  "role":
    path: staffGroups.inc
  "idm":
    path: idm.inc
  "staffrole":
    path: role.inc

golem:
  get_all_resp_url: http://ro.admin.yandex-team.ru/api/get_all_resp.sbml?get=do
  get_all_resp_filename: /etc/puncher/golem-resp
  get_host_resp_url: https://golem.yandex-team.ru/api/get_host_resp.sbml?hostname=
  object_search_url: http://ro.admin.yandex-team.ru/api/json/object_search.sbml
  hostinfo_url: https://golem.yandex-team.ru/hostinfo.sbml

idm:
  system_url: https://idm.yandex-team.ru/system/
  api_url: https://idm-api.yandex-team.ru/api/v1/firewall/rules/
  dial_timeout: 5s
  tls_handshake_timeout: 5s
  timeout: 600s
  certificate_file: /etc/puncher/private/idm.cer
  key_file: /etc/puncher/private/idm.key
  token: {{ pillar['puncher_secrets']['idm'] }}
  enable_groups: true

ldap:
  url: addc.yandex-team.ru:636
  username: "CN=Robot-dynfw-imports Robot-dynfw-imports,OU=TechUsers,DC=ld,DC=yandex,DC=ru"
  password: {{ pillar['puncher_secrets']['robot-dynfw-imports-password'] }}
  ignore:
    - "CN=Windows Administrators,OU=Special,OU=Base,OU=Groups,DC=ld,DC=yandex,DC=ru"
    - "CN=Endocs.SQL.Readers,OU=ENDOCs,OU=Projects,OU=Groups,DC=ld,DC=yandex,DC=ru"
  ignore_ous:
    - IDM

mdm:
  username: robot-dynfw-imports
  password: {{ pillar['puncher_secrets']['robot-dynfw-imports-password'] }}
  url: https://admin.serenity.yandex.net:8443/JSSResource/usergroups/id/1
  timeout: 30s

rules_target:
  path: rules.m4

securityfw:
  url: svn+ssh://robot-dynfw-export@arcadia.yandex.ru/robots/security/security-fw
  identity_file: /etc/puncher/robots-secret-keys/robot-dynfw-export
  data_dir: /var/spool/puncher/securityfw

staff:
  api_v3_url: https://staff-api.yandex-team.ru/v3
  newhire_api_url: https://staff.yandex-team.ru
  token: {{ pillar['puncher_secrets']['staff-api'] }}
  retry: 3

startrek:
  api_v2_url: https://st-api.yandex-team.ru/v2
  timeout: 30s
  queue: DOSTUPREQ
  token: {{ pillar['puncher_secrets']['startrack'] }}

tvm:
  client_id: 2027324
  secret: {{ pillar['puncher_secrets']['tvm-secret'] }}
  dsts:
    - 223  # intranet blackbox
    - 2011072 # calendar
  cache_dir: /var/spool/puncher/tvm-cache

users:
  admin_users:
    - "@dpt_yandex_mnt@"
    - "@dpt_yandex_mnt_advtech_banner@"
    - "@dpt_yandex_mnt_advtech_show@"
    - "@dpt_yandex_personal_vertserv_auto_autoru_mnt@"
    - "@dpt_yandex_monetize_network_adfox_mnt@"
    - "@dpt_yandex_monetize_search_direct_interface_exp@"
    - "@dpt_yandex_monetize_metrica_exmet@"
    - "@role_administration@"
    - "@role_development@"
    - "@wiki_puncher_stable_admins@"
    - "@srv_svc_helpdesk_support@"
    - "@dpt_yandex_mnt_noc_monitor@"
  super_users:
    - "@wiki_gruppaupravlenijadinamicheskimfajjervollom@"
  noc_users:
    - "@srv_svc_puncher_dutywork@"

include:
  - dns.yml
  - mongodb.yml
  - racktables.yml
