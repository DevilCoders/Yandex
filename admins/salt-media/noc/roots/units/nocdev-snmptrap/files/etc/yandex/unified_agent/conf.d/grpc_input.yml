storages:
  - name: grpc_storage
    plugin: fs
    config:
      directory: /var/lib/yandex/unified_agent/grpc_storage
      max_partition_size: 1gb
      data_retention:
        by_size: max
routes:
  - input:
      plugin: grpc
      config:
        uri: localhost:22345
        grpc_memory_quota: 200mb
        max_receive_message_size: 4mb
    channel:
      pipe:
        - storage_ref:
            name: grpc_storage
      output:
        plugin: logbroker
        config:
          endpoint: logbroker.yandex.net
          port: 2135
          topic:  /noc/nocdev/snmptrap
          codec: zstd
          compression_quality: 3
          tvm:
            client_id: 2034827        # snmptrapper
            destination_id: 2001059   # logbroker
            secret:
              file: /etc/yandex/unified_agent/secrets/tvm
