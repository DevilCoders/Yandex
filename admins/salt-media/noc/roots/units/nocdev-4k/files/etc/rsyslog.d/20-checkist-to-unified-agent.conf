## convert to json template
template(name="fwd-json" type="list" option.jsonf="on") {
    property(outname="ts" name="timegenerated" dateFormat="rfc3339" format="jsonf")
    property(outname="host" name="hostname" format="jsonf")
    property(outname="program" name="programname" format="jsonf")
    property(outname="msg" name="msg" format="jsonf")
}

module(load="mmrm1stspace")
ruleset(name="to_ua") {
    action(type="mmrm1stspace")  # remove first space in msg
    action(type="omfwd" target="localhost" port="10514" protocol="udp" template="fwd-json")
}
if ($programname contains 'checkist') then {
    if not ($msg contains 'DEBUG') then {
        call to_ua
   }
}
