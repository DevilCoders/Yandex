my %win2html = (
    0x80 => "&#x0402;",
    0x81 => "&#x0403;",
    0x82 => "&#x201A;",
    0x83 => "&#x0453;",
    0x84 => "&#x201E;",
    0x85 => "&#x2026;",
    0x86 => "&#x2020;",
    0x87 => "&#x2021;",
    0x88 => "&#x20AC;",
    0x89 => "&#x2030;",
    0x8A => "&#x0409;",
    0x8B => "&#x2039;",
    0x8C => "&#x040A;",
    0x8D => "&#x040C;",
    0x8E => "&#x040B;",
    0x8F => "&#x040F;",
    0x90 => "&#x0452;",
    0x91 => "&#x2018;",
    0x92 => "&#x2019;",
    0x93 => "&#x201C;",
    0x94 => "&#x201D;",
    0x95 => "&#x2022;",
    0x96 => "&#x2013;",
    0x97 => "&#x2014;",
    0x98 => "&#x98;",
    0x99 => "&#x2122;",
    0x9A => "&#x0459;",
    0x9B => "&#x203A;",
    0x9C => "&#x045A;",
    0x9D => "&#x045C;",
    0x9E => "&#x045B;",
    0x9F => "&#x045F;",
    0xA0 => "&#x00A0;",
    0xA1 => "&#x040E;",
    0xA2 => "&#x045E;",
    0xA3 => "&#x0408;",
    0xA4 => "&#x00A4;",
    0xA5 => "&#x0490;",
    0xA6 => "&#x00A6;",
    0xA7 => "&#x00A7;",
    0xA8 => "&#x0401;",
    0xA9 => "&#x00A9;",
    0xAA => "&#x0404;",
    0xAB => "&#x00AB;",
    0xAC => "&#x00AC;",
    0xAD => "&#x00AD;",
    0xAE => "&#x00AE;",
    0xAF => "&#x0407;",
    0xB0 => "&#x00B0;",
    0xB1 => "&#x00B1;",
    0xB2 => "&#x0406;",
    0xB3 => "&#x0456;",
    0xB4 => "&#x0491;",
    0xB5 => "&#x00B5;",
    0xB6 => "&#x00B6;",
    0xB7 => "&#x00B7;",
    0xB8 => "&#x0451;",
    0xB9 => "&#x2116;",
    0xBA => "&#x0454;",
    0xBB => "&#x00BB;",
    0xBC => "&#x0458;",
    0xBD => "&#x0405;",
    0xBE => "&#x0455;",
    0xBF => "&#x0457;",
    0xC0 => "&#x0410;",
    0xC1 => "&#x0411;",
    0xC2 => "&#x0412;",
    0xC3 => "&#x0413;",
    0xC4 => "&#x0414;",
    0xC5 => "&#x0415;",
    0xC6 => "&#x0416;",
    0xC7 => "&#x0417;",
    0xC8 => "&#x0418;",
    0xC9 => "&#x0419;",
    0xCA => "&#x041A;",
    0xCB => "&#x041B;",
    0xCC => "&#x041C;",
    0xCD => "&#x041D;",
    0xCE => "&#x041E;",
    0xCF => "&#x041F;",
    0xD0 => "&#x0420;",
    0xD1 => "&#x0421;",
    0xD2 => "&#x0422;",
    0xD3 => "&#x0423;",
    0xD4 => "&#x0424;",
    0xD5 => "&#x0425;",
    0xD6 => "&#x0426;",
    0xD7 => "&#x0427;",
    0xD8 => "&#x0428;",
    0xD9 => "&#x0429;",
    0xDA => "&#x042A;",
    0xDB => "&#x042B;",
    0xDC => "&#x042C;",
    0xDD => "&#x042D;",
    0xDE => "&#x042E;",
    0xDF => "&#x042F;",
    0xE0 => "&#x0430;",
    0xE1 => "&#x0431;",
    0xE2 => "&#x0432;",
    0xE3 => "&#x0433;",
    0xE4 => "&#x0434;",
    0xE5 => "&#x0435;",
    0xE6 => "&#x0436;",
    0xE7 => "&#x0437;",
    0xE8 => "&#x0438;",
    0xE9 => "&#x0439;",
    0xEA => "&#x043A;",
    0xEB => "&#x043B;",
    0xEC => "&#x043C;",
    0xED => "&#x043D;",
    0xEE => "&#x043E;",
    0xEF => "&#x043F;",
    0xF0 => "&#x0440;",
    0xF1 => "&#x0441;",
    0xF2 => "&#x0442;",
    0xF3 => "&#x0443;",
    0xF4 => "&#x0444;",
    0xF5 => "&#x0445;",
    0xF6 => "&#x0446;",
    0xF7 => "&#x0447;",
    0xF8 => "&#x0448;",
    0xF9 => "&#x0449;",
    0xFA => "&#x044A;",
    0xFB => "&#x044B;",
    0xFC => "&#x044C;",
    0xFD => "&#x044D;",
    0xFE => "&#x044E;",
    0xFF => "&#x044F;",
);

sub win2html($) {
    my $in = shift;
    my $out = $in;
    #dukeartem, 27.08.14 21 век и всё такое, преобразование в 1251 уже не требуется, а функцией win2html провязан весь cvsweb.cgi
    #my $out = "";
    #while ($in =~ m,^(.)(.*)$,s) {
    #    $in = $2;
    #    my $c = unpack "C", $1;
    #    if (defined $win2html{$c}) {
    #        $out .= $win2html{$c};
    #    } else {
    #        $out .= pack "C", $c;
    #    }
    #}
    return $out;
}
