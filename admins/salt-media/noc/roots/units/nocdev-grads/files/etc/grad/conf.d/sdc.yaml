# NOCREQUESTS-28502
series:
  snmp_poller.sdc_network:
    min_interval: 30

pollers:
  SNMP sdc mikrotik:
    poller: snmp
    poller version: 2
    poller params:
      timeout: 7
      counters:
        - ifmib.ifName
        - ifmib.ifAlias
        - { oid: ifmib.ifHighSpeed, options: [ use_snmpget ] }
        - { oid: ifmib.ifHCInOctets, options: [ use_snmpget ] }
        - { oid: ifmib.ifHCOutOctets, options: [ use_snmpget ] }
        - { oid: ifmib.ifHCInUcastPkts, options: [ use_snmpget ] }
        - { oid: ifmib.ifHCOutUcastPkts, options: [ use_snmpget ] }
        - { oid: ifmib.ifInNUcastPkts, options: [ use_snmpget ] }
        - { oid: ifmib.ifOutNUcastPkts, options: [ use_snmpget ] }
        - { oid: ifmib.ifInDiscards, options: [ use_snmpget ] }
        - { oid: ifmib.ifOutDiscards, options: [ use_snmpget ] }
        - { oid: ifmib.ifInErrors, options: [ use_snmpget ] }
        - { oid: ifmib.ifOutErrors, options: [ use_snmpget ] }
        - { oid: ifmib.ifOperStatus, options: [ use_snmpget ] }
        - { oid: ifmib.ifAdminStatus, options: [ use_snmpget ] }
        - { oid: ifmib.ifLastChange, options: [ use_snmpget ] }
        - { oid: ifmib.ifInMulticastPkts, options: [ use_snmpget ] }
        - { oid: ifmib.ifOutMulticastPkts, options: [ use_snmpget ] }
        - { oid: ifmib.ifInBroadcastPkts, options: [ use_snmpget ] }
        - { oid: ifmib.ifOutBroadcastPkts, options: [ use_snmpget ] }
      post_fn: [ rearrange_partial_data, sum_ifmib_counters_new ]
    filter:
      - "aminevka.sdc.yandex.net/10.15.0.10"
      - "garage.telaviv.sdc.yandex.net/10.15.0.18"
      - "a2.sdc.yandex.net/10.15.0.12"
      - "forest.sdc.yandex.net/10.15.0.24"
      - "innopolis.sdc.yandex.net/10.15.0.20"
      - "israel.sdc.yandex.net/10.15.0.18"
      - "kr.sdc.yandex.net/10.15.0.26"
      - "mihnevo.sdc.yandex.net/10.15.0.22"
      - "murino.sdc.yandex.net/10.15.0.16"
      - "nnovgorod.sdc.yandex.net/10.15.0.5"
      - "skolkovo.sdc.yandex.net/10.15.0.14"
      - "korea.sdc.yandex.net/10.15.0.41"
    series: snmp_poller.sdc_network
    interval: 30

# https://openwrt.org/docs/guide-user/services/snmp/mini_snmpd
# нельзя опрашивать более одного oid'а в bulk
# нельзя опрашивать более 16 оидов за раз в get
  SNMP mini_snmpd:
    poller: snmp
    poller version: 2
    poller params:
      timeout: 7
      counters:
        - {oid: ifmib.ifDescr, options: ["use_snmpbulkget"]}
        - {oid: ifmib.ifSpeed, options: ["use_snmpget"]}
        - {oid: ifmib.ifInOctets, options: ["use_snmpget"]}
        - {oid: ifmib.ifOutOctets, options: ["use_snmpget"]}
        - {oid: ifmib.ifInDiscards, options: ["use_snmpget"]}
        - {oid: ifmib.ifOutDiscards, options: ["use_snmpget"]}
        - {oid: ifmib.ifInErrors, options: ["use_snmpget"]}
        - {oid: ifmib.ifOutErrors, options: ["use_snmpget"]}
        - {oid: ifmib.ifInUcastPkts, options: ["use_snmpget"]}
        - {oid: ifmib.ifOutUcastPkts, options: ["use_snmpget"]}
        - {oid: ifmib.ifOperStatus, options: ["use_snmpget"]}
        - {oid: ifmib.ifAdminStatus, options: ["use_snmpget"]}
        - {oid: ifmib.ifLastChange, options: ["use_snmpget"]}
      post_fn: [check_net_data_stage1, sum_counters, check_net_data_sanity]
      oid_limit: 16
    filter: ["redrose-parking.sdc.yandex.net"]
    series: snmp_poller.sdc_network
    interval: 120
