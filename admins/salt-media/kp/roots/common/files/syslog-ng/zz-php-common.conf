template t_php_common {
    template("[$YEAR-$MONTH-$DAY $HOUR:$MIN:$SEC] $LEVEL: $MSGONLY\n");
    template_escape(no);
};

destination d_php_common {
    file("/var/log/php/php.log"
        create_dirs(yes)
        dir_owner(www-data)
        dir_group(www-data)
        dir_perm(0755)
        owner(www-data)
        group(www-data)
        perm(0644)
        template(t_php_common)
    );
};

filter f_php_common {
    (
        match(
            "php"
            flags(ignore-case)
            value("MSGONLY")
        );
    ) 
    and 
    (
        not program("syslog-ng") and 
        not program("CRON") and 
        not program("sudo")
    );
};

log {
    source(s_all);
    filter(f_php_common);
    destination(d_php_common);
    flags(final);
};

